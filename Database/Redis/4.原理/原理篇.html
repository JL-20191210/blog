<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.17" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.58" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <title>RedisåŸç†ç¯‡ | å°æ»¡</title><meta name="description" content="å°æ»¡çš„çŸ¥è¯†åº“">
    <link rel="stylesheet" href="/blog/assets/css/styles.50e9a4d3.css">
    <link rel="preload" href="/blog/assets/js/runtime~app.69685e2a.js" as="script"><link rel="preload" href="/blog/assets/css/styles.50e9a4d3.css" as="style"><link rel="preload" href="/blog/assets/js/9703.e09ff620.js" as="script"><link rel="preload" href="/blog/assets/js/app.66fc43a4.js" as="script">
    <link rel="prefetch" href="/blog/assets/js/Database_Redis_2.å®æˆ˜_Rediså®æˆ˜ç¯‡.html.ef4d662e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_4.Netty04-ä¼˜åŒ–ä¸æºç .html.e7d40ecf.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_2.NIO åŸºç¡€.html.4b35293b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_3.Netty03-è¿›é˜¶.html.af54bd22.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_3.Netty02-å…¥é—¨.html.9e803486.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_35.åå°„_åŠ¨æ€ä»£ç†.html.66d0420a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-å¤šçº§ç¼“å­˜_å¤šçº§ç¼“å­˜.html.ff471cbf.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_02-å¤šçº§ç¼“å­˜_å¤šçº§ç¼“å­˜.html.ecb62863.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_è®²ä¹‰-åˆ†å¸ƒå¼æœç´¢å¼•æ“02.html.670b1109.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_1.å…¥é—¨_RedisåŸºç¡€ç¯‡.html.cbfb5db8.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_è®²ä¹‰-åˆ†å¸ƒå¼æœç´¢å¼•æ“01.html.e242bc87.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_Intelæ¡Œé¢å¤„ç†å™¨è§„æ ¼.html.8fe5fdbb.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_4.åŸç†_åŸç†ç¯‡.html.758beea0.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_MQ_RabbitMQ.html.40bde5f3.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-æœ€ä½³å®è·µ_Redisé«˜çº§ç¯‡ä¹‹æœ€ä½³å®è·µ.html.2122d85a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_03-Redisæœ€ä½³å®è·µ_Redisé«˜çº§ç¯‡ä¹‹æœ€ä½³å®è·µ.html.9b30173f.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Sentinel_å¾®æœåŠ¡ä¿æŠ¤.html.db597981.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_åŸºç¡€_æ ¸å¿ƒæ•°æ®ç±»å‹.html.d7927650.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_AMDæ¡Œé¢å¤„ç†å™¨è§„æ ¼.html.22ad0ed3.js" as="script"><link rel="prefetch" href="/blog/assets/js/Vue_è¡¨å•éªŒè¯.html.c7b276b8.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_4.å®‰è£…elasticsearch.html.8d8e6057.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_Java Stream API.html.4efc941a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_å‡½æ•°å¼æ¥å£.html.fe5525e1.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_çˆ¬è™«_æ ·ä¾‹.html.955ab32a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_1.è¡¥å……- FSTæ¡†æ¶ä½¿ç”¨.html.8eefff4c.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@ControllerAdvice.html.88139954.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_æ·±å…¥ç†è§£ Stream API.html.247546e7.js" as="script"><link rel="prefetch" href="/blog/assets/js/849.830c18d2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-åˆ†å¸ƒå¼ç¼“å­˜_Redisé«˜çº§-åˆ†å¸ƒå¼ç¼“å­˜.html.1d2afb10.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_01-åˆ†å¸ƒå¼ç¼“å­˜_Redisé«˜çº§-åˆ†å¸ƒå¼ç¼“å­˜.html.c579ebea.js" as="script"><link rel="prefetch" href="/blog/assets/js/8300.ff153695.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_Channel.html.7d9b251b.js" as="script"><link rel="prefetch" href="/blog/assets/js/4214.394da83e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_åŸºç¡€_2-å‡½æ•°.html.b780334a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring MVC_æ ¡éªŒ_Hibernate Validator.html.dc878077.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_æ·±å…¥ç†è§£ Java Collector.html.fb721c96.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æ¿ä¹¦_æ•°æ®æ ¡éªŒ.html.a342e2e6.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_ç§æœ‰äº‘_ç©å®¢äº‘.html.54bffb95.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ³¨è§£_@TableField.html.4ff8f1fe.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring MVC_æ ¡éªŒ_è‡ªå®šä¹‰æ ¡éªŒ.html.25b66c54.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_3.æ‰©å±•-å¼‚å¸¸å¤„ç†æ³¨æ„ç‚¹.html.e09cf2e0.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ¥å£_MetaObjectHandleræ¥å£æ–‡æ¡£.html.58046c57.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_8.å¸¸è§æŸ¥è¯¢ç±»å‹.html.ff1723d9.js" as="script"><link rel="prefetch" href="/blog/assets/js/emoji.html.656320bc.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@InitBinder.html.54afd16f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_17.JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«.html.a4fb73e9.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_æ·±å…¥ç†è§£ Java ä¸­çš„é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•.html.54b57a4e.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_æµ‹è¯•æ–¹æ³•å¯åŠ¨ç©ºæŒ‡é’ˆ.html.5ab61648.js" as="script"><link rel="prefetch" href="/blog/assets/js/è®¾è®¡æ¨¡å¼_ä»£ç†æ¨¡å¼.html.639d603d.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_å…ƒæ³¨è§£.html.a0d90a67.js" as="script"><link rel="prefetch" href="/blog/assets/js/611.5fb33018.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_jstackç”¨æ³•.html.0ddc2402.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Alibaba-OSS_é˜¿é‡Œäº‘ossä½¿ç”¨è®°å½•.html.eaef8d41.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ¥å£_MetaObjectHandlerç¤ºä¾‹.html.560152b8.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring MVC_æ ¡éªŒ_JSR303æ•°å­—æ ¡éªŒ.html.2f47c9fd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@EnableTransactionManagement.html.f5529fd0.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.5æ–¹æ³•åŒº.html.44e8826c.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_æ·±å…¥ç†è§£ Java Optional ç±».html.9102eae7.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_this.page().html.a9c61512.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_æ·±å…¥ç†è§£ Java 8 æ–°ç‰¹æ€§ï¼šä»æ ¸å¿ƒåˆ°å®è·µ.html.459ddbe5.js" as="script"><link rel="prefetch" href="/blog/assets/js/Vue_vueæ¨¡æ¿.html.7e5d8ddf.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_åå°„.html.a4909ce0.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_16.ä»€ä¹ˆæ˜¯Javaä¸­çš„åŠ¨æ€ä»£ç†.html.5d16e894.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_5.ä»€ä¹ˆæ˜¯Javaçš„å¤šæ€.html.a617b902.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_åŸºç¡€_1-æ•°æ®åº“æ§åˆ¶è¯­è¨€DCL.html.61820032.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.6ç›´æ¥å†…å­˜.html.8fab97ed.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_7.Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿.html.ea5c7452.js" as="script"><link rel="prefetch" href="/blog/assets/js/7583.2af54276.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Jmeter_3.sentinelè§„åˆ™æŒä¹…åŒ–.html.96a3b01d.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_6.Javaä¸­çš„å‚æ•°ä¼ é€’æ˜¯æŒ‰å€¼è¿˜æ˜¯æŒ‰å¼•ç”¨.html.9a101d1e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_wrapper.and().html.8316c195.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_2.é…ç½®ä¸­å¿ƒ.html.aff6406f.js" as="script"><link rel="prefetch" href="/blog/assets/js/7096.76bb9882.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å¼‚å¸¸_try-with-resourcesè‡ªåŠ¨å…³é—­èµ„æº.html.c0f5e20e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_8.Javaé¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„åŒºåˆ«.html.4a574a8b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_9.Javaæ–¹æ³•é‡è½½å’Œé‡å†™ä¹‹é—´çš„åŒºåˆ«.html.3b51d378.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_11.Java8æ–°ç‰¹æ€§.html.2a755e18.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_10.åˆ†é¡µ.html.f3208d7c.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_initå‘½ä»¤è¯¦è§£.html.6eddb804.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_æŸ¥çœ‹ç³»ç»Ÿé…ç½®.html.20946ee0.js" as="script"><link rel="prefetch" href="/blog/assets/js/Bug_mavenåˆ·æ–°æ—¶è¯­è¨€åŸºæœ¬é‡ç½®é—®é¢˜.html.2a12ea41.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_MQ_å®‰è£…_RabbitMQéƒ¨ç½²æŒ‡å—.html.bc8c0873.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_æŸ¥è¯¢å®‰è£…ä½ç½®.html.b8eefb00.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_æŸ¥çœ‹é•œåƒæ¶æ„.html.10357f4f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_15.Javaä¸­çš„hashCodeå’Œequalsæ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³».html.2e932c71.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_ç”µè„‘è£…æœºè¿›é˜¶.html.5e9be82c.js" as="script"><link rel="prefetch" href="/blog/assets/js/7124.11cc5132.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_Dockeræ„å»ºSpringBooté•œåƒ.html.1153102f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_Junit_ç”Ÿå‘½å‘¨æœŸæ³¨è§£.html.1bdb2e35.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_æ•°æ®åº“å®‰å…¨é…ç½®.html.e376f41b.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_äººäººåå°æ³¨å†Œè‡³Nacosç‰ˆæœ¬é—®é¢˜.html.af926e49.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_é•œåƒå¯¼å…¥å¯¼å‡º.html.5f253910.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_9.copy_toçš„ç”¨æ³•.html.7ebddff9.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_API_API.html.b6083a6f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_ç§æœ‰äº‘_ç§æœ‰äº‘éƒ¨ç½²è½¯ä»¶.html.3c90a77e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_MySQL8.0å®‰è£….html.4525ff6e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_getMethods()å’ŒgetDeclaredMethods()çš„åŒºåˆ«.html.dd711d53.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ–°ç‰ˆåˆ†é¡µæ’ä»¶.html.02583fc7.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@FeignClient.html.8131e0f8.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_getDeclaredField()å’ŒgetField()åŒºåˆ«.html.a09b9582.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_Dockerå®¹å™¨ä¸å®¿ä¸»æœºæ—¶é—´åŒæ­¥.html.1fc5ee0a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_Navicatè¿æ¥mysqlæŠ¥é”™.html.512c7bbd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_æ•°æ®åº“éš”ç¦»çº§åˆ«.html.7eee0d67.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_ç¡¬ç›˜æŒ‚è½½.html.62094ba5.js" as="script"><link rel="prefetch" href="/blog/assets/js/VCS_Git_æœ¬åœ°é¡¹ç›®æ¨é€è‡³è¿œç¨‹åº“.html.ef44a533.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_cpu loadè¿‡é«˜é—®é¢˜.html.45b4ecb3.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_é‡Šæ”¾ByteBuf.html.44e0a802.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_æ³¨è§£@RequestMappingã€@PostMappingã€@GetMapping.html.f404d701.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Jmeter_1.MACå®‰è£…JMeter.html.3ad79ae1.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_7.åˆ›å»ºç´¢å¼•åº“.html.33a666de.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_ç§æœ‰äº‘_å‰åç«¯åˆ†ç¦»åšå®¢é¡¹ç›®.html.0a2379dd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Kafka_å‘é€æ¥æ”¶demo.html.9d3492c6.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_14.Java ä¸­ hashCode_equals æ–¹æ³•å’Œ__ æ“ä½œç¬¦.html.d108af7c.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_systemctl.html.943b2d37.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_GCç±»å‹.html.aa160a2c.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_1.ä»€ä¹ˆæ˜¯ES.html.58a2950c.js" as="script"><link rel="prefetch" href="/blog/assets/js/1434.900263ce.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_OOM.html.f16ec43b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_MySQL æ•°æ®åº“æˆæƒç®¡ç†.html.4e618597.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_4.Javaçš„ä¼˜åŠ¿.html.485203fd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_å…³é—­äº‹ä»¶å¾ªç¯ç»„.html.b6361960.js" as="script"><link rel="prefetch" href="/blog/assets/js/1316.26df1e75.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_æ ¸å¿ƒæ¦‚å¿µç†è§£.html.54df7095.js" as="script"><link rel="prefetch" href="/blog/assets/js/2275.dcc4168e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_è½¯ç¡¬é“¾æ¥.html.9a9c74bb.js" as="script"><link rel="prefetch" href="/blog/assets/js/1317.10732497.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_10.Javaå†…éƒ¨ç±»åŠä½œç”¨.html.e3805bef.js" as="script"><link rel="prefetch" href="/blog/assets/js/6873.b44a0bdd.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_3.ç½‘å…³é…ç½®.html.eb8419ea.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_12.JDKå’ŒJREåŒºåˆ«.html.2fbbf32e.js" as="script"><link rel="prefetch" href="/blog/assets/js/ç½‘ç»œ_L2TPå’ŒIPsecåè®®å¸¸è§è½¯ä»¶å’Œå·¥å…·.html.c2b212ad.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_pull.html.13c45d2c.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_unionå’Œunion all.html.337c3a6d.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_SpringBootæ— æ•°æ®æºå¯åŠ¨.html.acf02851.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Jmeter_2.Jmeterå¿«é€Ÿå…¥é—¨.html.c67db61b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_Ubuntuå‘½ä»¤è¡Œå›¾å½¢åŒ–ç•Œé¢åˆ‡æ¢.html.2bb8174e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis_é€»è¾‘åˆ é™¤.html.5fbb6102.js" as="script"><link rel="prefetch" href="/blog/assets/js/5663.892fda56.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_API_ExecutorService.html.48a71b7f.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_å…³é—­eslintæ£€æŸ¥.html.18380527.js" as="script"><link rel="prefetch" href="/blog/assets/js/VCS_Git_åˆ é™¤æœ€è¿‘ä¸€æ¬¡æ¨é€.html.e39ee11b.js" as="script"><link rel="prefetch" href="/blog/assets/js/ç½‘ç»œ_L2TPIPsec.html.6d3280c8.js" as="script"><link rel="prefetch" href="/blog/assets/js/VCS_Git_å¿½ç•¥ideaæ–‡ä»¶å¤¹.html.b5b841aa.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@ResponseBody.html.45cbaf09.js" as="script"><link rel="prefetch" href="/blog/assets/js/1901.74b1b7c6.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_äººäººå‰ç«¯å¯åŠ¨å¤±è´¥.html.7897e455.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_dos2unixæ¢è¡Œç¬¦æ¸…ç†.html.bb57a70f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_ç‰¹æƒæ¨¡å¼.html.b54d6ec1.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_å•ç”¨æˆ·æ¨¡å¼é‡ç½®å¯†ç .html.0a1cbbe6.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_7.Javaä¸æ”¯æŒå¤šé‡ç»§æ‰¿.html.c4aab9e9.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.1.å¹´è½»ä»£è€å¹´ä»£.html.1042ed71.js" as="script"><link rel="prefetch" href="/blog/assets/js/Nginx_413 (Request Entity Too Large).html.912e4bfe.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@JsonFormat.html.19e18701.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_1.åºåˆ—åŒ–ä¸ååºåˆ—åŒ–.html.ac0204f4.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_ç”µè„‘é…ç½®.html.2d433981.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.2è™šæ‹Ÿæœºæ ˆ.html.5fd3fbaa.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_mysql -uroot -pæŠ¥é”™.html.1969cf2a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_å­—èŠ‚ç å¯¹è±¡.html.fd7eca29.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_å®‰è£…NocoDB.html.da927285.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_ä¸»è¦æ¶æ„.html.fba20772.js" as="script"><link rel="prefetch" href="/blog/assets/js/5292.04bf372b.js" as="script"><link rel="prefetch" href="/blog/assets/js/ç½‘ç»œ_åˆ·æ–°dnsç¼“å­˜.html.58ebd8d2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_caching_sha2_passwordæ— æ³•åŠ è½½.html.44c79a37.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_åŠ¨æ€æ„å»ºæŸ¥è¯¢æ¡ä»¶.html.6af3a6bd.js" as="script"><link rel="prefetch" href="/blog/assets/js/å‰ç«¯_node_nvmæ›´æ¢é•œåƒæº.html.b2acda58.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_2.ä¸å¯å˜ç±».html.9648a76a.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_13.ä½ ä½¿ç”¨è¿‡å“ªäº›JDKå·¥å…·.html.5487d6d4.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_QueryWrapper vs LambdaQueryWrapper.html.1bbe33c9.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_3.åŸºæœ¬æ¦‚å¿µ.html.660d0325.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_0.å®‰è£…ä¸å¯åŠ¨.html.127ff4b2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_queryWrapperè‡ªå®šä¹‰SQL.html.d29425b9.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_å®‰è£…Nginx.html.5bc94679.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_3.Exceptionå’ŒErrorçš„åŒºåˆ«.html.642943ab.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_Spring5.xæ¦‚è¿°.html.146e06b2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_where 1_1.html.e7ba1354.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_åŸºç¡€_0.å‰è¨€.html.acc52c21.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.3æœ¬åœ°æ–¹æ³•æ ˆ.html.b1c87b2f.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_1.æ³¨å†Œä¸­å¿ƒ.html.01db50f3.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.1ç¨‹åºè®¡æ•°å™¨.html.58e42edd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_daemon-reload.html.52c2b3c8.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_index.html.defc85d2.js" as="script"><link rel="prefetch" href="/blog/assets/js/å‰ç«¯_node_npmæ›´æ¢é•œåƒæº.html.03210df9.js" as="script"><link rel="prefetch" href="/blog/assets/js/4903.a7f55910.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å”¯æ‰‹ç†Ÿå°”_equalsä¸ç­‰å·.html.ea8205fc.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_è·¨åŸŸ.html.3ca09a15.js" as="script"><link rel="prefetch" href="/blog/assets/js/2916.54fd14b9.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_rc.local.html.dce6a976.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_5.åˆ†è¯å™¨.html.906079c0.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_2.4å †.html.3d47aef7.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_ç©ºå€¼å’Œnullå€¼.html.28428b3b.js" as="script"><link rel="prefetch" href="/blog/assets/js/2240.bce1f31c.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„.html.777fb4bd.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_4.NacosæŒ‡å®šæœåŠ¡ç«¯IP.html.ddbe5bb4.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_reset-failed.html.8cb1a230.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_1.å­¦ä¹ JVMæœ‰ä»€ä¹ˆç”¨.html.3fd418be.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_6.mappingå¸¸è§å±æ€§.html.16cc740c.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤±è´¥.html.c9ede50f.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_2.å€’æ’ç´¢å¼•.html.34dc3c09.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Sentinel_bug_windowsç‰ˆsentinelè¿è¡ŒæŠ¥é”™é—®é¢˜å¤„ç†Unable to make protected final java.lang.Class java.lang.ClassLoader.define.html.25d50431.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_String_isNotEmptyå’ŒisNotBlank.html.369d75b1.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_SpringBootè¯»å–ValidationMessages.propertiesï¼Œä¸­æ–‡ä¹±ç .html.80534b5d.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_é£ç‰›OSå¼€å…³å±å¹•.html.df8a90f8.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_æ‰¾ä¸åˆ°ç¬¦å·.html.513b96a5.js" as="script"><link rel="prefetch" href="/blog/assets/js/Vue_index.html.ef46c87d.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_æœåŠ¡åˆ—è¡¨ä¸ºç©º.html.886f08cd.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_è§†é¢‘æ•™ç¨‹.html.2907938f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_index.html.66480ff7.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_index.html.321cad3e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_è§†é¢‘æ•™ç¨‹.html.c9df6dec.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_è§†é¢‘æ•™ç¨‹.html.3ab2596f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_1.é»‘é©¬è§†é¢‘æ•™ç¨‹.html.7e82ef4b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é›·ä¸°é˜³Javaè§†é¢‘.html.624075ac.js" as="script"><link rel="prefetch" href="/blog/assets/js/index.html.adacdc5f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_@JsonInclude.html.653d1397.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_é»‘é©¬JVM.html.b85683b8.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_æ€»ç»“-åå°„.html.971bb632.js" as="script"><link rel="prefetch" href="/blog/assets/js/676.f6b4bdac.js" as="script"><link rel="prefetch" href="/blog/assets/js/3021.ce68dc19.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_åŸºç¡€_video.html.9b030552.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_æŸ¥çœ‹æ•°æ®å·ç›®å½•.html.b5028198.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_index.html.fceca5fa.js" as="script"><link rel="prefetch" href="/blog/assets/js/3160.07cf795c.js" as="script"><link rel="prefetch" href="/blog/assets/js/intro.html.eb10c17a.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Nacos_index.html.aa010d8d.js" as="script"><link rel="prefetch" href="/blog/assets/js/8984.f327bcec.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-åˆ†å¸ƒå¼ç¼“å­˜_index.html.9f779adb.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-å¤šçº§ç¼“å­˜_index.html.0db87aa4.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_Redisé«˜çº§ç¯‡-æœ€ä½³å®è·µ_index.html.35046b76.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_35.åå°„_åŠ¨æ€ä»£ç†_index.html.7900a388.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä½¿ç”¨æŒ‡å—_index.html.15682873.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åŸºç¡€çŸ¥è¯†_index.html.d9dca968.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ¥å£æ–‡æ¡£_index.html.2bf0a2c9.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ç½‘ç»œç¼–ç¨‹_index.html.8b878662.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ¥å£ç¤ºä¾‹_index.html.78dafb18.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æŠ¥é”™è®°å½•_index.html.0c1a0ad9.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä¸­é—´ä»¶_index.html.f2830b49.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_æ•°æ®åº“_index.html.83e606c4.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_mybatis-plus_index.html.553ee89d.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_java8ç‰¹æ€§_index.html.778a77f2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_01-åˆ†å¸ƒå¼ç¼“å­˜_index.html.5ca25fee.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_03-Redisæœ€ä½³å®è·µ_index.html.cec32d66.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ç§æœ‰äº‘_index.html.d8414901.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_å®æˆ˜_index.html.c09924e0.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_è£…æœº_index.html.93f0c6fb.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_é¡¹ç›®_index.html.bf862a53.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ç½‘ç»œ_index.html.d970dca5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_seåŸºç¡€_index.html.6d85fb36.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_index.html.4489feaa.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_markdown_index.html.162868dd.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_02-å¤šçº§ç¼“å­˜_index.html.908be1fb.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_è°·ç²’å•†åŸ_æ¿ä¹¦_index.html.9c5f3e8b.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_mybatis_index.html.73643351.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_äº‹åŠ¡_index.html.c225d2f9.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ä½¿ç”¨_index.html.38cceecc.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å…¥é—¨_index.html.6147ae8a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åå°„_index.html.e35de83b.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å‘½ä»¤_index.html.41af61e5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å‘ç‹_index.html.739d7035.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åŸºç¡€_index.html.db72b8f5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å®‰å…¨_index.html.5dac244d.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å®‰è£…_index.html.12b854af.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å®¹å™¨_index.html.d31799bc.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å¿…èƒŒ_index.html.6f933a9f.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ€»ç»“_index.html.4680839b.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ•™ç¨‹_index.html.8d1430cd.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æŸ¥è¯¢_index.html.8bf196b3.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_çˆ¬è™«_index.html.21da8848.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ç»éªŒ_index.html.974ff28a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ç½‘ç»œ_index.html.8b8ee87a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_è£…æœº_index.html.ba26b8cb.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_è¸©å‘_index.html.c63ad2d7.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_é‡ç‚¹_index.html.59ce28cd.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_é•œåƒ_index.html.0e33acf4.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_äº†è§£_index.html.d4aa36ec.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ’ä»¶_index.html.16f4eb57.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ³¨è§£_index.html.5aade75e.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_è®²ä¹‰_index.html.9e7218df.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_docker_index.html.2e14cb66.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_python_index.html.b951ceee.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_spring_index.html.2fdc451d.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_linux_index.html.8a4f9501.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_mysql_index.html.f44858d2.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_nacos_index.html.c1176a12.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_netty_index.html.596d6814.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_nginx_index.html.f79a37ec.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_index.html.02d091d6.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_index.html.b458862f.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_redis_index.html.a0c14348.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_java_index.html.26ea9dad.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_git_index.html.18e44b64.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_vue_index.html.10b01273.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_error_index.html.1a92c661.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_jvm_index.html.1e172f72.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_es_index.html.51e56dde.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å…¥é—¨åˆ°èµ·é£_index.html.374fb090.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_index.html.7d26b6ae.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_bug_index.html.832a7460.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_git_index.html.1b7b423e.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_api_index.html.9a33c798.js" as="script"><link rel="prefetch" href="/blog/assets/js/Linux_index.html.8a714ffc.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_index.html.7712d32e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Nginx_index.html.7ec5b5ac.js" as="script"><link rel="prefetch" href="/blog/assets/js/5152.9b4917b0.js" as="script"><link rel="prefetch" href="/blog/assets/js/JVM_2.å†…å­˜ç»“æ„_index.html.5a87fb04.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å”¯æ‰‹ç†Ÿå°”_index.html.55c9f4f4.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_index.html.6d98fdff.js" as="script"><link rel="prefetch" href="/blog/assets/js/é¡¹ç›®å®æˆ˜_index.html.43097ba4.js" as="script"><link rel="prefetch" href="/blog/assets/js/timeline_index.html.e240e64f.js" as="script"><link rel="prefetch" href="/blog/assets/js/è®¾è®¡æ¨¡å¼_index.html.01c227ed.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Sentinel_index.html.3ce284cb.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_index.html.1c24ae43.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ¥å£_index.html.930c6bbc.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_æ³¨è§£_index.html.c3dc67cf.js" as="script"><link rel="prefetch" href="/blog/assets/js/Docker_ç§æœ‰äº‘_index.html.63a173fa.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_2.å®æˆ˜_index.html.90f3d437.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_3.é«˜çº§_index.html.29b8dd98.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_4.åŸç†_index.html.aaea0fa5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_index.html.2856d096.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_Redis_1.å…¥é—¨_index.html.dd0f0619.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_Java8ç‰¹æ€§_index.html.d72cbe6b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_é¢è¯•é¢˜_index.html.acf47f33.js" as="script"><link rel="prefetch" href="/blog/assets/js/article_index.html.751f09ca.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Jmeter_index.html.fd0065c0.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_é«˜çº§_Sentinel_bug_index.html.c21a58e4.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis Plus_index.html.8a0b7e52.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_Alibaba-OSS_index.html.80eb9229.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_MQ_å®‰è£…_index.html.ab80e7bf.js" as="script"><link rel="prefetch" href="/blog/assets/js/star_index.html.5be1e703.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_MySQL_åŸºç¡€_index.html.88420d5f.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring MVC_æ ¡éªŒ_index.html.75ad0031.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_åŸºç¡€_index.html.8e89b3e3.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_æ³¨è§£_index.html.f1c61be8.js" as="script"><link rel="prefetch" href="/blog/assets/js/Python_çˆ¬è™«_index.html.9ec4840d.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_å¼‚å¸¸_index.html.1a9a195d.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_index.html.07481e8e.js" as="script"><link rel="prefetch" href="/blog/assets/js/å‰ç«¯_node_index.html.2d0eb6ef.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring MVC_index.html.e14ffd3a.js" as="script"><link rel="prefetch" href="/blog/assets/js/å‰ç«¯_index.html.2ae3735e.js" as="script"><link rel="prefetch" href="/blog/assets/js/ç½‘ç»œ_index.html.d6e74500.js" as="script"><link rel="prefetch" href="/blog/assets/js/è£…æœº_index.html.33575e43.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_Mybatis_index.html.9590d4b2.js" as="script"><link rel="prefetch" href="/blog/assets/js/Database_index.html.eba4d359.js" as="script"><link rel="prefetch" href="/blog/assets/js/Java_String_index.html.23f21b58.js" as="script"><link rel="prefetch" href="/blog/assets/js/Mybatis_index.html.9686664e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Spring_Junit_index.html.9f6c55e3.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_ES_index.html.42ab127b.js" as="script"><link rel="prefetch" href="/blog/assets/js/SpringCloud_MQ_index.html.cd93d751.js" as="script"><link rel="prefetch" href="/blog/assets/js/Netty_API_index.html.f35cb00b.js" as="script"><link rel="prefetch" href="/blog/assets/js/Kafka_index.html.45d3f2ae.js" as="script"><link rel="prefetch" href="/blog/assets/js/VCS_Git_index.html.333fcf10.js" as="script"><link rel="prefetch" href="/blog/assets/js/VCS_index.html.41c61607.js" as="script"><link rel="prefetch" href="/blog/assets/js/404.html.bc037f5e.js" as="script"><link rel="prefetch" href="/blog/assets/js/Bug_index.html.60f880e4.js" as="script"><link rel="prefetch" href="/blog/assets/js/2666.71fedeaa.js" as="script"><link rel="prefetch" href="/blog/assets/js/8070.f013b580.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/blog/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/blog/assets/images/avatar.png" alt><!----><span class="vp-site-name hide-in-pad">å°æ»¡</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="åç«¯"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span>åç«¯<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Java/" aria-label="Java"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-java" style=""></span><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Python/" aria-label="Python"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-python" style=""></span><!--]-->Python<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/JVM/" aria-label="JVM"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-microchip" style=""></span><!--]-->JVM<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/Vue/" aria-label="Vue"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-vuejs" style=""></span><!--]-->Vue<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Spring"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-leaf" style=""></span>Spring<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Spring/" aria-label="Spring"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-leaf" style=""></span><!--]-->Spring<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="SpringCloud"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-cloud" style=""></span>SpringCloud<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/SpringCloud/Nacos/" aria-label="Nacos"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-cloud" style=""></span><!--]-->Nacos<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/SpringCloud/ES/" aria-label="ES"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-searchengin" style=""></span><!--]-->ES<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/SpringCloud/%E9%AB%98%E7%BA%A7/" aria-label="é«˜çº§ç¯‡"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-web-awesome" style=""></span><!--]-->é«˜çº§ç¯‡<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ•°æ®åº“"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-database" style=""></span>æ•°æ®åº“<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Database/MySQL/" aria-label="MySQL"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-database" style=""></span><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Database/Redis/" aria-label="Redis"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-server" style=""></span><!--]-->Redis<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/Docker/" aria-label="Docker"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-docker" style=""></span><!--]-->Docker<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Linux"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-linux" style=""></span>Linux<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/Linux/" aria-label="Linux"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-linux" style=""></span><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/Netty/" aria-label="Netty"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-n" style=""></span><!--]-->Netty<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é¡¹ç›®å®æˆ˜"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-product-hunt" style=""></span>é¡¹ç›®å®æˆ˜<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E/" aria-label="è°·ç²’å•†åŸ"><!--[--><span class="font-icon icon fa-fw fa-sm fa-brands fa-codepen" style=""></span><!--]-->è°·ç²’å•†åŸ<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="http://blog.xiaoxiongmaococo.com:92/#/" aria-label="blog" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-blog" style=""></span><!--]-->blog<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/JL-20191210/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Database/Redis/" aria-label="Redis"><!---->Redis<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">1.å…¥é—¨</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2.å®æˆ˜</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">3.é«˜çº§</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">4.åŸç†</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/blog/Database/Redis/4.%E5%8E%9F%E7%90%86/%E5%8E%9F%E7%90%86%E7%AF%87.html" aria-label="RedisåŸç†ç¯‡"><!---->RedisåŸç†ç¯‡<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Database/Redis/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B.html" aria-label="è§†é¢‘æ•™ç¨‹"><!--[--><span class="font-icon icon fa-fw fa-sm fa-solid fa-play" style=""></span><!--]-->è§†é¢‘æ•™ç¨‹<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->RedisåŸç†ç¯‡</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">æ¥æ¯å†°æŸ æª¬</span></span><span property="author" content="æ¥æ¯å†°æŸ æª¬"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 46 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT46M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1ã€åŸç†ç¯‡-redisæ•°æ®ç»“æ„">1ã€åŸç†ç¯‡-Redisæ•°æ®ç»“æ„</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-redisæ•°æ®ç»“æ„-åŠ¨æ€å­—ç¬¦ä¸²">1.1 Redisæ•°æ®ç»“æ„-åŠ¨æ€å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-redisæ•°æ®ç»“æ„-intset">1.2 Redisæ•°æ®ç»“æ„-intset</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-3-redisæ•°æ®ç»“æ„-dict">1.3 Redisæ•°æ®ç»“æ„-Dict</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-4-redisæ•°æ®ç»“æ„-ziplist">1.4 Redisæ•°æ®ç»“æ„-ZipList</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-5-redisæ•°æ®ç»“æ„-ziplistçš„è¿é”æ›´æ–°é—®é¢˜">1.5 Redisæ•°æ®ç»“æ„-ZipListçš„è¿é”æ›´æ–°é—®é¢˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-6-redisæ•°æ®ç»“æ„-quicklist">1.6 Redisæ•°æ®ç»“æ„-QuickList</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-7-redisæ•°æ®ç»“æ„-redisobject">1.7 Redisæ•°æ®ç»“æ„-RedisObject</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-8-redisæ•°æ®ç»“æ„-string">1.8 Redisæ•°æ®ç»“æ„-String</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-9-redisæ•°æ®ç»“æ„-list">1.9 Redisæ•°æ®ç»“æ„-List</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-0-redisæ•°æ®ç»“æ„-setç»“æ„">2.0 Redisæ•°æ®ç»“æ„-Setç»“æ„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1ã€redisæ•°æ®ç»“æ„-zset">2.1ã€Redisæ•°æ®ç»“æ„-ZSET</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-ã€redisæ•°æ®ç»“æ„-hash">2.2 ã€Redisæ•°æ®ç»“æ„-Hash</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2ã€åŸç†ç¯‡-redisç½‘ç»œæ¨¡å‹">2ã€åŸç†ç¯‡-Redisç½‘ç»œæ¨¡å‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸æ€ç©ºé—´">2.1 ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸æ€ç©ºé—´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-ç½‘ç»œæ¨¡å‹-é˜»å¡io">2.2.ç½‘ç»œæ¨¡å‹-é˜»å¡IO</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-ç½‘ç»œæ¨¡å‹-éé˜»å¡io">2.3 ç½‘ç»œæ¨¡å‹-éé˜»å¡IO</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨">2.4 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨-selectæ–¹å¼">2.5 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨-selectæ–¹å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-6-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-pollæ¨¡å¼">2.6 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨æ¨¡å‹-pollæ¨¡å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-7-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-epollå‡½æ•°">2.7 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨æ¨¡å‹-epollå‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-8ã€ç½‘ç»œæ¨¡å‹-epollä¸­çš„etå’Œlt">2.8ã€ç½‘ç»œæ¨¡å‹-epollä¸­çš„ETå’ŒLT</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-ç½‘ç»œæ¨¡å‹-åŸºäºepollçš„æœåŠ¡å™¨ç«¯æµç¨‹">2.9 ç½‘ç»œæ¨¡å‹-åŸºäºepollçš„æœåŠ¡å™¨ç«¯æµç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-0-ã€ç½‘ç»œæ¨¡å‹-ä¿¡å·é©±åŠ¨">3.0 ã€ç½‘ç»œæ¨¡å‹-ä¿¡å·é©±åŠ¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-ã€ç½‘ç»œæ¨¡å‹-redisæ˜¯å•çº¿ç¨‹çš„å—-ä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹">3.1 ã€ç½‘ç»œæ¨¡å‹-Redisæ˜¯å•çº¿ç¨‹çš„å—ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-ã€redisçš„å•çº¿ç¨‹æ¨¡å‹-rediså•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç½‘ç»œæ¨¡å‹å˜æ›´">3.2 ã€Redisçš„å•çº¿ç¨‹æ¨¡å‹-Rediså•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç½‘ç»œæ¨¡å‹å˜æ›´</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3ã€redisé€šä¿¡åè®®-respåè®®">3ã€Redisé€šä¿¡åè®®-RESPåè®®</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1ã€redisé€šä¿¡åè®®-åŸºäºsocketè‡ªå®šä¹‰redisçš„å®¢æˆ·ç«¯">3.1ã€Redisé€šä¿¡åè®®-åŸºäºSocketè‡ªå®šä¹‰Redisçš„å®¢æˆ·ç«¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2ã€rediså†…å­˜å›æ”¶-è¿‡æœŸkeyå¤„ç†">3.2ã€Rediså†…å­˜å›æ”¶-è¿‡æœŸkeyå¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-rediså†…å­˜å›æ”¶-å†…å­˜æ·˜æ±°ç­–ç•¥">3.3 Rediså†…å­˜å›æ”¶-å†…å­˜æ·˜æ±°ç­–ç•¥</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4ã€ç»“æŸè¯­">4ã€ç»“æŸè¯­</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="redisåŸç†ç¯‡" tabindex="-1"><a class="header-anchor" href="#redisåŸç†ç¯‡"><span>RedisåŸç†ç¯‡</span></a></h1><h2 id="_1ã€åŸç†ç¯‡-redisæ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1ã€åŸç†ç¯‡-redisæ•°æ®ç»“æ„"><span>1ã€åŸç†ç¯‡-Redisæ•°æ®ç»“æ„</span></a></h2><h3 id="_1-1-redisæ•°æ®ç»“æ„-åŠ¨æ€å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#_1-1-redisæ•°æ®ç»“æ„-åŠ¨æ€å­—ç¬¦ä¸²"><span>1.1 Redisæ•°æ®ç»“æ„-åŠ¨æ€å­—ç¬¦ä¸²</span></a></h3><p>æˆ‘ä»¬éƒ½çŸ¥é“Redisä¸­ä¿å­˜çš„Keyæ˜¯å­—ç¬¦ä¸²ï¼Œvalueå¾€å¾€æ˜¯å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„é›†åˆã€‚å¯è§å­—ç¬¦ä¸²æ˜¯Redisä¸­æœ€å¸¸ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚</p><p>ä¸è¿‡Redisæ²¡æœ‰ç›´æ¥ä½¿ç”¨Cè¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºCè¯­è¨€å­—ç¬¦ä¸²å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼š è·å–å­—ç¬¦ä¸²é•¿åº¦çš„éœ€è¦é€šè¿‡è¿ç®— éäºŒè¿›åˆ¶å®‰å…¨ ä¸å¯ä¿®æ”¹ Redisæ„å»ºäº†ä¸€ç§æ–°çš„å­—ç¬¦ä¸²ç»“æ„ï¼Œç§°ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼ˆSimple Dynamic Stringï¼‰ï¼Œç®€ç§°SDSã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼š</p><figure><img src="data:image/png;base64,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" alt="1653984583289" tabindex="0" loading="lazy"><figcaption>1653984583289</figcaption></figure><p>é‚£ä¹ˆRediså°†åœ¨åº•å±‚åˆ›å»ºä¸¤ä¸ªSDSï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯åŒ…å«â€œnameâ€çš„SDSï¼Œå¦ä¸€ä¸ªæ˜¯åŒ…å«â€œè™å“¥â€çš„SDSã€‚</p><p>Redisæ˜¯Cè¯­è¨€å®ç°çš„ï¼Œå…¶ä¸­SDSæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/1653984624671.eb5e6fef.png" alt="1653984624671" tabindex="0" loading="lazy"><figcaption>1653984624671</figcaption></figure><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²â€œnameâ€çš„sdsç»“æ„å¦‚ä¸‹ï¼š</p><figure><img src="data:image/png;base64,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" alt="1653984648404" tabindex="0" loading="lazy"><figcaption>1653984648404</figcaption></figure><p>SDSä¹‹æ‰€ä»¥å«åšåŠ¨æ€å­—ç¬¦ä¸²ï¼Œæ˜¯å› ä¸ºå®ƒå…·å¤‡åŠ¨æ€æ‰©å®¹çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ä¸€ä¸ªå†…å®¹ä¸ºâ€œhiâ€çš„SDSï¼š</p><figure><img src="/blog/assets/img/1653984787383.2374fa06.png" alt="1653984787383" tabindex="0" loading="lazy"><figcaption>1653984787383</figcaption></figure><p>å‡å¦‚æˆ‘ä»¬è¦ç»™SDSè¿½åŠ ä¸€æ®µå­—ç¬¦ä¸²â€œ,Amyâ€ï¼Œè¿™é‡Œé¦–å…ˆä¼šç”³è¯·æ–°å†…å­˜ç©ºé—´ï¼š</p><p>å¦‚æœæ–°å­—ç¬¦ä¸²å°äº1Mï¼Œåˆ™æ–°ç©ºé—´ä¸ºæ‰©å±•åå­—ç¬¦ä¸²é•¿åº¦çš„ä¸¤å€+1ï¼›</p><p>å¦‚æœæ–°å­—ç¬¦ä¸²å¤§äº1Mï¼Œåˆ™æ–°ç©ºé—´ä¸ºæ‰©å±•åå­—ç¬¦ä¸²é•¿åº¦+1M+1ã€‚ç§°ä¸ºå†…å­˜é¢„åˆ†é…ã€‚</p><figure><img src="/blog/assets/img/1653984822363.6fde9150.png" alt="1653984822363" tabindex="0" loading="lazy"><figcaption>1653984822363</figcaption></figure><figure><img src="/blog/assets/img/1653984838306.a4837f6b.png" alt="1653984838306" tabindex="0" loading="lazy"><figcaption>1653984838306</figcaption></figure><h3 id="_1-2-redisæ•°æ®ç»“æ„-intset" tabindex="-1"><a class="header-anchor" href="#_1-2-redisæ•°æ®ç»“æ„-intset"><span>1.2 Redisæ•°æ®ç»“æ„-intset</span></a></h3><p>IntSetæ˜¯Redisä¸­seté›†åˆçš„ä¸€ç§å®ç°æ–¹å¼ï¼ŒåŸºäºæ•´æ•°æ•°ç»„æ¥å®ç°ï¼Œå¹¶ä¸”å…·å¤‡é•¿åº¦å¯å˜ã€æœ‰åºç­‰ç‰¹å¾ã€‚ ç»“æ„å¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/1653984923322.d758ce1c.png" alt="1653984923322" tabindex="0" loading="lazy"><figcaption>1653984923322</figcaption></figure><p>å…¶ä¸­çš„encodingåŒ…å«ä¸‰ç§æ¨¡å¼ï¼Œè¡¨ç¤ºå­˜å‚¨çš„æ•´æ•°å¤§å°ä¸åŒï¼š</p><figure><img src="/blog/assets/img/1653984942385.e56bbe8b.png" alt="1653984942385" tabindex="0" loading="lazy"><figcaption>1653984942385</figcaption></figure><p>ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾ï¼ŒRedisä¼šå°†intsetä¸­æ‰€æœ‰çš„æ•´æ•°æŒ‰ç…§å‡åºä¾æ¬¡ä¿å­˜åœ¨contentsæ•°ç»„ä¸­ï¼Œç»“æ„å¦‚å›¾ï¼š</p><figure><img src="/blog/assets/img/1653985149557.7d190f50.png" alt="1653985149557" tabindex="0" loading="lazy"><figcaption>1653985149557</figcaption></figure><p>ç°åœ¨ï¼Œæ•°ç»„ä¸­æ¯ä¸ªæ•°å­—éƒ½åœ¨int16_tçš„èŒƒå›´å†…ï¼Œå› æ­¤é‡‡ç”¨çš„ç¼–ç æ–¹å¼æ˜¯INTSET_ENC_INT16ï¼Œæ¯éƒ¨åˆ†å ç”¨çš„å­—èŠ‚å¤§å°ä¸ºï¼š encodingï¼š4å­—èŠ‚ lengthï¼š4å­—èŠ‚ contentsï¼š2å­—èŠ‚ * 3 = 6å­—èŠ‚</p><figure><img src="/blog/assets/img/1653985197214.e7939be1.png" alt="1653985197214" tabindex="0" loading="lazy"><figcaption>1653985197214</figcaption></figure><p>æˆ‘ä»¬å‘è¯¥å…¶ä¸­æ·»åŠ ä¸€ä¸ªæ•°å­—ï¼š50000ï¼Œè¿™ä¸ªæ•°å­—è¶…å‡ºäº†int16_tçš„èŒƒå›´ï¼Œintsetä¼šè‡ªåŠ¨å‡çº§ç¼–ç æ–¹å¼åˆ°åˆé€‚çš„å¤§å°ã€‚ ä»¥å½“å‰æ¡ˆä¾‹æ¥è¯´æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å‡çº§ç¼–ç ä¸ºINTSET_ENC_INT32, æ¯ä¸ªæ•´æ•°å 4å­—èŠ‚ï¼Œå¹¶æŒ‰ç…§æ–°çš„ç¼–ç æ–¹å¼åŠå…ƒç´ ä¸ªæ•°æ‰©å®¹æ•°ç»„</li><li>å€’åºä¾æ¬¡å°†æ•°ç»„ä¸­çš„å…ƒç´ æ‹·è´åˆ°æ‰©å®¹åçš„æ­£ç¡®ä½ç½®</li><li>å°†å¾…æ·»åŠ çš„å…ƒç´ æ”¾å…¥æ•°ç»„æœ«å°¾</li><li>æœ€åï¼Œå°†insetçš„encodingå±æ€§æ”¹ä¸ºINTSET_ENC_INT32ï¼Œå°†lengthå±æ€§æ”¹ä¸º4</li></ul><figure><img src="/blog/assets/img/1653985276621.a9edf545.png" alt="1653985276621" tabindex="0" loading="lazy"><figcaption>1653985276621</figcaption></figure><p>æºç å¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/1653985304075.bc9cbf31.png" alt="1653985304075" tabindex="0" loading="lazy"><figcaption>1653985304075</figcaption></figure><figure><img src="/blog/assets/img/1653985327653.655500be.png" alt="1653985327653" tabindex="0" loading="lazy"><figcaption>1653985327653</figcaption></figure><p>å°æ€»ç»“ï¼š</p><p>Intsetå¯ä»¥çœ‹åšæ˜¯ç‰¹æ®Šçš„æ•´æ•°æ•°ç»„ï¼Œå…·å¤‡ä¸€äº›ç‰¹ç‚¹ï¼š</p><ul><li>Redisä¼šç¡®ä¿Intsetä¸­çš„å…ƒç´ å”¯ä¸€ã€æœ‰åº</li><li>å…·å¤‡ç±»å‹å‡çº§æœºåˆ¶ï¼Œå¯ä»¥èŠ‚çœå†…å­˜ç©ºé—´</li><li>åº•å±‚é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾æ–¹å¼æ¥æŸ¥è¯¢</li></ul><h3 id="_1-3-redisæ•°æ®ç»“æ„-dict" tabindex="-1"><a class="header-anchor" href="#_1-3-redisæ•°æ®ç»“æ„-dict"><span>1.3 Redisæ•°æ®ç»“æ„-Dict</span></a></h3><p>æˆ‘ä»¬çŸ¥é“Redisæ˜¯ä¸€ä¸ªé”®å€¼å‹ï¼ˆKey-Value Pairï¼‰çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®é”®å®ç°å¿«é€Ÿçš„å¢åˆ æ”¹æŸ¥ã€‚è€Œé”®ä¸å€¼çš„æ˜ å°„å…³ç³»æ­£æ˜¯é€šè¿‡Dictæ¥å®ç°çš„ã€‚ Dictç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šå“ˆå¸Œè¡¨ï¼ˆDictHashTableï¼‰ã€å“ˆå¸ŒèŠ‚ç‚¹ï¼ˆDictEntryï¼‰ã€å­—å…¸ï¼ˆDictï¼‰</p><figure><img src="/blog/assets/img/1653985396560.a7f1fdb7.png" alt="1653985396560" tabindex="0" loading="lazy"><figcaption>1653985396560</figcaption></figure><p>å½“æˆ‘ä»¬å‘Dictæ·»åŠ é”®å€¼å¯¹æ—¶ï¼ŒRedisé¦–å…ˆæ ¹æ®keyè®¡ç®—å‡ºhashå€¼ï¼ˆhï¼‰ï¼Œç„¶ååˆ©ç”¨ h &amp; sizemaskæ¥è®¡ç®—å…ƒç´ åº”è¯¥å­˜å‚¨åˆ°æ•°ç»„ä¸­çš„å“ªä¸ªç´¢å¼•ä½ç½®ã€‚æˆ‘ä»¬å­˜å‚¨k1=v1ï¼Œå‡è®¾k1çš„å“ˆå¸Œå€¼h =1ï¼Œåˆ™1&amp;3 =1ï¼Œå› æ­¤k1=v1è¦å­˜å‚¨åˆ°æ•°ç»„è§’æ ‡1ä½ç½®ã€‚</p><figure><img src="/blog/assets/img/1653985497735.d31af2cd.png" alt="1653985497735" tabindex="0" loading="lazy"><figcaption>1653985497735</figcaption></figure><p>Dictç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šå“ˆå¸Œè¡¨ï¼ˆDictHashTableï¼‰ã€å“ˆå¸ŒèŠ‚ç‚¹ï¼ˆDictEntryï¼‰ã€å­—å…¸ï¼ˆDictï¼‰</p><figure><img src="/blog/assets/img/1653985570612.e12af29a.png" alt="1653985570612" tabindex="0" loading="lazy"><figcaption>1653985570612</figcaption></figure><figure><img src="/blog/assets/img/1653985586543.a322eea0.png" alt="1653985586543" tabindex="0" loading="lazy"><figcaption>1653985586543</figcaption></figure><figure><img src="/blog/assets/img/1653985640422.912d13ef.png" alt="1653985640422" tabindex="0" loading="lazy"><figcaption>1653985640422</figcaption></figure><p><strong>Dictçš„æ‰©å®¹</strong></p><p>Dictä¸­çš„HashTableå°±æ˜¯æ•°ç»„ç»“åˆå•å‘é“¾è¡¨çš„å®ç°ï¼Œå½“é›†åˆä¸­å…ƒç´ è¾ƒå¤šæ—¶ï¼Œå¿…ç„¶å¯¼è‡´å“ˆå¸Œå†²çªå¢å¤šï¼Œé“¾è¡¨è¿‡é•¿ï¼Œåˆ™æŸ¥è¯¢æ•ˆç‡ä¼šå¤§å¤§é™ä½ã€‚ Dictåœ¨æ¯æ¬¡æ–°å¢é”®å€¼å¯¹æ—¶éƒ½ä¼šæ£€æŸ¥è´Ÿè½½å› å­ï¼ˆLoadFactor = used/sizeï¼‰ ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ç§æƒ…å†µæ—¶ä¼šè§¦å‘å“ˆå¸Œè¡¨æ‰©å®¹ï¼š å“ˆå¸Œè¡¨çš„ LoadFactor &gt;= 1ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ²¡æœ‰æ‰§è¡Œ BGSAVE æˆ–è€… BGREWRITEAOF ç­‰åå°è¿›ç¨‹ï¼› å“ˆå¸Œè¡¨çš„ LoadFactor &gt; 5 ï¼›</p><figure><img src="/blog/assets/img/1653985716275.7c29302b.png" alt="1653985716275" tabindex="0" loading="lazy"><figcaption>1653985716275</figcaption></figure><figure><img src="/blog/assets/img/1653985743412.c3254346.png" alt="1653985743412" tabindex="0" loading="lazy"><figcaption>1653985743412</figcaption></figure><p><strong>Dictçš„rehash</strong></p><p>ä¸ç®¡æ˜¯æ‰©å®¹è¿˜æ˜¯æ”¶ç¼©ï¼Œå¿…å®šä¼šåˆ›å»ºæ–°çš„å“ˆå¸Œè¡¨ï¼Œå¯¼è‡´å“ˆå¸Œè¡¨çš„sizeå’Œsizemaskå˜åŒ–ï¼Œè€Œkeyçš„æŸ¥è¯¢ä¸sizemaskæœ‰å…³ã€‚å› æ­¤å¿…é¡»å¯¹å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸€ä¸ªkeyé‡æ–°è®¡ç®—ç´¢å¼•ï¼Œæ’å…¥æ–°çš„å“ˆå¸Œè¡¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºrehashã€‚è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li><p>è®¡ç®—æ–°hashè¡¨çš„realeSizeï¼Œå€¼å–å†³äºå½“å‰è¦åšçš„æ˜¯æ‰©å®¹è¿˜æ˜¯æ”¶ç¼©ï¼š</p><ul><li>å¦‚æœæ˜¯æ‰©å®¹ï¼Œåˆ™æ–°sizeä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºdict.ht[0].used + 1çš„2^n</li><li>å¦‚æœæ˜¯æ”¶ç¼©ï¼Œåˆ™æ–°sizeä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºdict.ht[0].usedçš„2^n ï¼ˆä¸å¾—å°äº4ï¼‰</li></ul></li><li><p>æŒ‰ç…§æ–°çš„realeSizeç”³è¯·å†…å­˜ç©ºé—´ï¼Œåˆ›å»ºdicthtï¼Œå¹¶èµ‹å€¼ç»™dict.ht[1]</p></li><li><p>è®¾ç½®dict.rehashidx = 0ï¼Œæ ‡ç¤ºå¼€å§‹rehash</p></li><li><p>å°†dict.ht[0]ä¸­çš„æ¯ä¸€ä¸ªdictEntryéƒ½rehashåˆ°dict.ht[1]</p></li><li><p>å°†dict.ht[1]èµ‹å€¼ç»™dict.ht[0]ï¼Œç»™dict.ht[1]åˆå§‹åŒ–ä¸ºç©ºå“ˆå¸Œè¡¨ï¼Œé‡Šæ”¾åŸæ¥çš„dict.ht[0]çš„å†…å­˜</p></li><li><p>å°†rehashidxèµ‹å€¼ä¸º-1ï¼Œä»£è¡¨rehashç»“æŸ</p></li><li><p>åœ¨rehashè¿‡ç¨‹ä¸­ï¼Œæ–°å¢æ“ä½œï¼Œåˆ™ç›´æ¥å†™å…¥ht[1]ï¼ŒæŸ¥è¯¢ã€ä¿®æ”¹å’Œåˆ é™¤åˆ™ä¼šåœ¨dict.ht[0]å’Œdict.ht[1]ä¾æ¬¡æŸ¥æ‰¾å¹¶æ‰§è¡Œã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ht[0]çš„æ•°æ®åªå‡ä¸å¢ï¼Œéšç€rehashæœ€ç»ˆä¸ºç©º</p></li></ul><p>æ•´ä¸ªè¿‡ç¨‹å¯ä»¥æè¿°æˆï¼š</p><figure><img src="/blog/assets/img/1653985824540.69bec2e6.png" alt="1653985824540" tabindex="0" loading="lazy"><figcaption>1653985824540</figcaption></figure><p>å°æ€»ç»“ï¼š</p><p>Dictçš„ç»“æ„ï¼š</p><ul><li>ç±»ä¼¼javaçš„HashTableï¼Œåº•å±‚æ˜¯æ•°ç»„åŠ é“¾è¡¨æ¥è§£å†³å“ˆå¸Œå†²çª</li><li>DictåŒ…å«ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼Œht[0]å¹³å¸¸ç”¨ï¼Œht[1]ç”¨æ¥rehash</li></ul><p>Dictçš„ä¼¸ç¼©ï¼š</p><ul><li>å½“LoadFactorå¤§äº5æˆ–è€…LoadFactorå¤§äº1å¹¶ä¸”æ²¡æœ‰å­è¿›ç¨‹ä»»åŠ¡æ—¶ï¼ŒDictæ‰©å®¹</li><li>å½“LoadFactorå°äº0.1æ—¶ï¼ŒDictæ”¶ç¼©</li><li>æ‰©å®¹å¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºused + 1çš„2^n</li><li>æ”¶ç¼©å¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºused çš„2^n</li><li>Dicté‡‡ç”¨æ¸è¿›å¼rehashï¼Œæ¯æ¬¡è®¿é—®Dictæ—¶æ‰§è¡Œä¸€æ¬¡rehash</li><li>rehashæ—¶ht[0]åªå‡ä¸å¢ï¼Œæ–°å¢æ“ä½œåªåœ¨ht[1]æ‰§è¡Œï¼Œå…¶å®ƒæ“ä½œåœ¨ä¸¤ä¸ªå“ˆå¸Œè¡¨</li></ul><h3 id="_1-4-redisæ•°æ®ç»“æ„-ziplist" tabindex="-1"><a class="header-anchor" href="#_1-4-redisæ•°æ®ç»“æ„-ziplist"><span>1.4 Redisæ•°æ®ç»“æ„-ZipList</span></a></h3><p>ZipList æ˜¯ä¸€ç§ç‰¹æ®Šçš„â€œåŒç«¯é“¾è¡¨â€ ï¼Œç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å—ç»„æˆã€‚å¯ä»¥åœ¨ä»»æ„ä¸€ç«¯è¿›è¡Œå‹å…¥/å¼¹å‡ºæ“ä½œ, å¹¶ä¸”è¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</p><figure><img src="/blog/assets/img/1653985987327.05088a43.png" alt="1653985987327" tabindex="0" loading="lazy"><figcaption>1653985987327</figcaption></figure><figure><img src="data:image/png;base64,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" alt="1653986020491" tabindex="0" loading="lazy"><figcaption>1653986020491</figcaption></figure><table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>ç±»å‹</strong></th><th><strong>é•¿åº¦</strong></th><th><strong>ç”¨é€”</strong></th></tr></thead><tbody><tr><td>zlbytes</td><td>uint32_t</td><td>4 å­—èŠ‚</td><td>è®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨çš„å†…å­˜å­—èŠ‚æ•°</td></tr><tr><td>zltail</td><td>uint32_t</td><td>4 å­—èŠ‚</td><td>è®°å½•å‹ç¼©åˆ—è¡¨è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚ï¼Œé€šè¿‡è¿™ä¸ªåç§»é‡ï¼Œå¯ä»¥ç¡®å®šè¡¨å°¾èŠ‚ç‚¹çš„åœ°å€ã€‚</td></tr><tr><td>zllen</td><td>uint16_t</td><td>2 å­—èŠ‚</td><td>è®°å½•äº†å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡ã€‚ æœ€å¤§å€¼ä¸ºUINT16_MAX ï¼ˆ65534ï¼‰ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œæ­¤å¤„ä¼šè®°å½•ä¸º65535ï¼Œä½†èŠ‚ç‚¹çš„çœŸå®æ•°é‡éœ€è¦éå†æ•´ä¸ªå‹ç¼©åˆ—è¡¨æ‰èƒ½è®¡ç®—å¾—å‡ºã€‚</td></tr><tr><td>entry</td><td>åˆ—è¡¨èŠ‚ç‚¹</td><td>ä¸å®š</td><td>å‹ç¼©åˆ—è¡¨åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„é•¿åº¦ç”±èŠ‚ç‚¹ä¿å­˜çš„å†…å®¹å†³å®šã€‚</td></tr><tr><td>zlend</td><td>uint8_t</td><td>1 å­—èŠ‚</td><td>ç‰¹æ®Šå€¼ 0xFF ï¼ˆåè¿›åˆ¶ 255 ï¼‰ï¼Œç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯ã€‚</td></tr></tbody></table><p><strong>ZipListEntry</strong></p><p>ZipList ä¸­çš„Entryå¹¶ä¸åƒæ™®é€šé“¾è¡¨é‚£æ ·è®°å½•å‰åèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå› ä¸ºè®°å½•ä¸¤ä¸ªæŒ‡é’ˆè¦å ç”¨16ä¸ªå­—èŠ‚ï¼Œæµªè´¹å†…å­˜ã€‚è€Œæ˜¯é‡‡ç”¨äº†ä¸‹é¢çš„ç»“æ„ï¼š</p><figure><img src="data:image/png;base64,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" alt="1653986055253" tabindex="0" loading="lazy"><figcaption>1653986055253</figcaption></figure><ul><li><p>previous_entry_lengthï¼šå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦ï¼Œå 1ä¸ªæˆ–5ä¸ªå­—èŠ‚ã€‚</p><ul><li>å¦‚æœå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦å°äº254å­—èŠ‚ï¼Œåˆ™é‡‡ç”¨1ä¸ªå­—èŠ‚æ¥ä¿å­˜è¿™ä¸ªé•¿åº¦å€¼</li><li>å¦‚æœå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦å¤§äº254å­—èŠ‚ï¼Œåˆ™é‡‡ç”¨5ä¸ªå­—èŠ‚æ¥ä¿å­˜è¿™ä¸ªé•¿åº¦å€¼ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º0xfeï¼Œåå››ä¸ªå­—èŠ‚æ‰æ˜¯çœŸå®é•¿åº¦æ•°æ®</li></ul></li><li><p>encodingï¼šç¼–ç å±æ€§ï¼Œè®°å½•contentçš„æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²è¿˜æ˜¯æ•´æ•°ï¼‰ä»¥åŠé•¿åº¦ï¼Œå ç”¨1ä¸ªã€2ä¸ªæˆ–5ä¸ªå­—èŠ‚</p></li><li><p>contentsï¼šè´Ÿè´£ä¿å­˜èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ•´æ•°</p></li></ul><p>ZipListä¸­æ‰€æœ‰å­˜å‚¨é•¿åº¦çš„æ•°å€¼å‡é‡‡ç”¨å°ç«¯å­—èŠ‚åºï¼Œå³ä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨åã€‚ä¾‹å¦‚ï¼šæ•°å€¼0x1234ï¼Œé‡‡ç”¨å°ç«¯å­—èŠ‚åºåå®é™…å­˜å‚¨å€¼ä¸ºï¼š0x3412</p><p><strong>Encodingç¼–ç </strong></p><p>ZipListEntryä¸­çš„encodingç¼–ç åˆ†ä¸ºå­—ç¬¦ä¸²å’Œæ•´æ•°ä¸¤ç§ï¼š å­—ç¬¦ä¸²ï¼šå¦‚æœencodingæ˜¯ä»¥â€œ00â€ã€â€œ01â€æˆ–è€…â€œ10â€å¼€å¤´ï¼Œåˆ™è¯æ˜contentæ˜¯å­—ç¬¦ä¸²</p><table><thead><tr><th><strong>ç¼–ç </strong></th><th><strong>ç¼–ç é•¿åº¦</strong></th><th><strong>å­—ç¬¦ä¸²å¤§å°</strong></th></tr></thead><tbody><tr><td>|00pppppp|</td><td>1 bytes</td><td>&lt;= 63 bytes</td></tr><tr><td>|01pppppp|qqqqqqqq|</td><td>2 bytes</td><td>&lt;= 16383 bytes</td></tr><tr><td>|10000000|qqqqqqqq|rrrrrrrr|ssssssss|tttttttt|</td><td>5 bytes</td><td>&lt;= 4294967295 bytes</td></tr></tbody></table><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦ä¿å­˜å­—ç¬¦ä¸²ï¼šâ€œabâ€å’Œ â€œbcâ€</p><figure><img src="/blog/assets/img/1653986172002.b3d23d72.png" alt="1653986172002" tabindex="0" loading="lazy"><figcaption>1653986172002</figcaption></figure><p>ZipListEntryä¸­çš„encodingç¼–ç åˆ†ä¸ºå­—ç¬¦ä¸²å’Œæ•´æ•°ä¸¤ç§ï¼š</p><ul><li>æ•´æ•°ï¼šå¦‚æœencodingæ˜¯ä»¥â€œ11â€å¼€å§‹ï¼Œåˆ™è¯æ˜contentæ˜¯æ•´æ•°ï¼Œä¸”encodingå›ºå®šåªå ç”¨1ä¸ªå­—èŠ‚</li></ul><table><thead><tr><th><strong>ç¼–ç </strong></th><th><strong>ç¼–ç é•¿åº¦</strong></th><th><strong>æ•´æ•°ç±»å‹</strong></th></tr></thead><tbody><tr><td>11000000</td><td>1</td><td>int16_tï¼ˆ2 bytesï¼‰</td></tr><tr><td>11010000</td><td>1</td><td>int32_tï¼ˆ4 bytesï¼‰</td></tr><tr><td>11100000</td><td>1</td><td>int64_tï¼ˆ8 bytesï¼‰</td></tr><tr><td>11110000</td><td>1</td><td>24ä½æœ‰ç¬¦æ•´æ•°(3 bytes)</td></tr><tr><td>11111110</td><td>1</td><td>8ä½æœ‰ç¬¦æ•´æ•°(1 bytes)</td></tr><tr><td>1111xxxx</td><td>1</td><td>ç›´æ¥åœ¨xxxxä½ç½®ä¿å­˜æ•°å€¼ï¼ŒèŒƒå›´ä»0001~1101ï¼Œå‡1åç»“æœä¸ºå®é™…å€¼</td></tr></tbody></table><figure><img src="/blog/assets/img/1653986282879.47bb3ddd.png" alt="1653986282879" tabindex="0" loading="lazy"><figcaption>1653986282879</figcaption></figure><figure><img src="data:image/png;base64,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" alt="1653986217182" tabindex="0" loading="lazy"><figcaption>1653986217182</figcaption></figure><h3 id="_1-5-redisæ•°æ®ç»“æ„-ziplistçš„è¿é”æ›´æ–°é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-5-redisæ•°æ®ç»“æ„-ziplistçš„è¿é”æ›´æ–°é—®é¢˜"><span>1.5 Redisæ•°æ®ç»“æ„-ZipListçš„è¿é”æ›´æ–°é—®é¢˜</span></a></h3><p>ZipListçš„æ¯ä¸ªEntryéƒ½åŒ…å«previous_entry_lengthæ¥è®°å½•ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°ï¼Œé•¿åº¦æ˜¯1ä¸ªæˆ–5ä¸ªå­—èŠ‚ï¼š å¦‚æœå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦å°äº254å­—èŠ‚ï¼Œåˆ™é‡‡ç”¨1ä¸ªå­—èŠ‚æ¥ä¿å­˜è¿™ä¸ªé•¿åº¦å€¼ å¦‚æœå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦å¤§äºç­‰äº254å­—èŠ‚ï¼Œåˆ™é‡‡ç”¨5ä¸ªå­—èŠ‚æ¥ä¿å­˜è¿™ä¸ªé•¿åº¦å€¼ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º0xfeï¼Œåå››ä¸ªå­—èŠ‚æ‰æ˜¯çœŸå®é•¿åº¦æ•°æ® ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æœ‰Nä¸ªè¿ç»­çš„ã€é•¿åº¦ä¸º250~253å­—èŠ‚ä¹‹é—´çš„entryï¼Œå› æ­¤entryçš„previous_entry_lengthå±æ€§ç”¨1ä¸ªå­—èŠ‚å³å¯è¡¨ç¤ºï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><figure><img src="/blog/assets/img/1653986328124.f5497e47.png" alt="1653986328124" tabindex="0" loading="lazy"><figcaption>1653986328124</figcaption></figure><p>ZipListè¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹äº§ç”Ÿçš„è¿ç»­å¤šæ¬¡ç©ºé—´æ‰©å±•æ“ä½œç§°ä¹‹ä¸ºè¿é”æ›´æ–°ï¼ˆCascade Updateï¼‰ã€‚æ–°å¢ã€åˆ é™¤éƒ½å¯èƒ½å¯¼è‡´è¿é”æ›´æ–°çš„å‘ç”Ÿã€‚</p><p><strong>å°æ€»ç»“ï¼š</strong></p><p><strong>ZipListç‰¹æ€§ï¼š</strong></p><ul><li>å‹ç¼©åˆ—è¡¨çš„å¯ä»¥çœ‹åšä¸€ç§è¿ç»­å†…å­˜ç©ºé—´çš„&quot;åŒå‘é“¾è¡¨&quot;</li><li>åˆ—è¡¨çš„èŠ‚ç‚¹ä¹‹é—´ä¸æ˜¯é€šè¿‡æŒ‡é’ˆè¿æ¥ï¼Œè€Œæ˜¯è®°å½•ä¸Šä¸€èŠ‚ç‚¹å’Œæœ¬èŠ‚ç‚¹é•¿åº¦æ¥å¯»å€ï¼Œå†…å­˜å ç”¨è¾ƒä½</li><li>å¦‚æœåˆ—è¡¨æ•°æ®è¿‡å¤šï¼Œå¯¼è‡´é“¾è¡¨è¿‡é•¿ï¼Œå¯èƒ½å½±å“æŸ¥è¯¢æ€§èƒ½</li><li>å¢æˆ–åˆ è¾ƒå¤§æ•°æ®æ—¶æœ‰å¯èƒ½å‘ç”Ÿè¿ç»­æ›´æ–°é—®é¢˜</li></ul><h3 id="_1-6-redisæ•°æ®ç»“æ„-quicklist" tabindex="-1"><a class="header-anchor" href="#_1-6-redisæ•°æ®ç»“æ„-quicklist"><span>1.6 Redisæ•°æ®ç»“æ„-QuickList</span></a></h3><p>é—®é¢˜1ï¼šZipListè™½ç„¶èŠ‚çœå†…å­˜ï¼Œä½†ç”³è¯·å†…å­˜å¿…é¡»æ˜¯è¿ç»­ç©ºé—´ï¼Œå¦‚æœå†…å­˜å ç”¨è¾ƒå¤šï¼Œç”³è¯·å†…å­˜æ•ˆç‡å¾ˆä½ã€‚æ€ä¹ˆåŠï¼Ÿ</p><p>â€‹ ç­”ï¼šä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»é™åˆ¶ZipListçš„é•¿åº¦å’Œentryå¤§å°ã€‚</p><p>é—®é¢˜2ï¼šä½†æ˜¯æˆ‘ä»¬è¦å­˜å‚¨å¤§é‡æ•°æ®ï¼Œè¶…å‡ºäº†ZipListæœ€ä½³çš„ä¸Šé™è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>â€‹ ç­”ï¼šæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸ªZipListæ¥åˆ†ç‰‡å­˜å‚¨æ•°æ®ã€‚</p><p>é—®é¢˜3ï¼šæ•°æ®æ‹†åˆ†åæ¯”è¾ƒåˆ†æ•£ï¼Œä¸æ–¹ä¾¿ç®¡ç†å’ŒæŸ¥æ‰¾ï¼Œè¿™å¤šä¸ªZipListå¦‚ä½•å»ºç«‹è”ç³»ï¼Ÿ</p><p>â€‹ ç­”ï¼šRedisåœ¨3.2ç‰ˆæœ¬å¼•å…¥äº†æ–°çš„æ•°æ®ç»“æ„QuickListï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒç«¯é“¾è¡¨ï¼Œåªä¸è¿‡é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªZipListã€‚</p><figure><img src="/blog/assets/img/1653986474927.2ac23785.png" alt="1653986474927" tabindex="0" loading="lazy"><figcaption>1653986474927</figcaption></figure><p>ä¸ºäº†é¿å…QuickListä¸­çš„æ¯ä¸ªZipListä¸­entryè¿‡å¤šï¼ŒRedisæä¾›äº†ä¸€ä¸ªé…ç½®é¡¹ï¼šlist-max-ziplist-sizeæ¥é™åˆ¶ã€‚ å¦‚æœå€¼ä¸ºæ­£ï¼Œåˆ™ä»£è¡¨ZipListçš„å…è®¸çš„entryä¸ªæ•°çš„æœ€å¤§å€¼ å¦‚æœå€¼ä¸ºè´Ÿï¼Œåˆ™ä»£è¡¨ZipListçš„æœ€å¤§å†…å­˜å¤§å°ï¼Œåˆ†5ç§æƒ…å†µï¼š</p><ul><li>-1ï¼šæ¯ä¸ªZipListçš„å†…å­˜å ç”¨ä¸èƒ½è¶…è¿‡4kb</li><li>-2ï¼šæ¯ä¸ªZipListçš„å†…å­˜å ç”¨ä¸èƒ½è¶…è¿‡8kb</li><li>-3ï¼šæ¯ä¸ªZipListçš„å†…å­˜å ç”¨ä¸èƒ½è¶…è¿‡16kb</li><li>-4ï¼šæ¯ä¸ªZipListçš„å†…å­˜å ç”¨ä¸èƒ½è¶…è¿‡32kb</li><li>-5ï¼šæ¯ä¸ªZipListçš„å†…å­˜å ç”¨ä¸èƒ½è¶…è¿‡64kb</li></ul><p>å…¶é»˜è®¤å€¼ä¸º -2ï¼š</p><figure><img src="/blog/assets/img/1653986642777.9ab3e504.png" alt="1653986642777" tabindex="0" loading="lazy"><figcaption>1653986642777</figcaption></figure><p>ä»¥ä¸‹æ˜¯QuickListçš„å’ŒQuickListNodeçš„ç»“æ„æºç ï¼š</p><figure><img src="/blog/assets/img/1653986667228.562bedaf.png" alt="1653986667228" tabindex="0" loading="lazy"><figcaption>1653986667228</figcaption></figure><p>æˆ‘ä»¬æ¥ä¸‹æ¥ç”¨ä¸€æ®µæµç¨‹å›¾æ¥æè¿°å½“å‰çš„è¿™ä¸ªç»“æ„</p><figure><img src="/blog/assets/img/1653986718554.ce455352.png" alt="1653986718554" tabindex="0" loading="lazy"><figcaption>1653986718554</figcaption></figure><p>æ€»ç»“ï¼š</p><p>QuickListçš„ç‰¹ç‚¹ï¼š</p><ul><li>æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ä¸ºZipListçš„åŒç«¯é“¾è¡¨</li><li>èŠ‚ç‚¹é‡‡ç”¨ZipListï¼Œè§£å†³äº†ä¼ ç»Ÿé“¾è¡¨çš„å†…å­˜å ç”¨é—®é¢˜</li><li>æ§åˆ¶äº†ZipListå¤§å°ï¼Œè§£å†³è¿ç»­å†…å­˜ç©ºé—´ç”³è¯·æ•ˆç‡é—®é¢˜</li><li>ä¸­é—´èŠ‚ç‚¹å¯ä»¥å‹ç¼©ï¼Œè¿›ä¸€æ­¥èŠ‚çœäº†å†…å­˜</li></ul><p>1.7 Redisæ•°æ®ç»“æ„-SkipList</p><p>SkipListï¼ˆè·³è¡¨ï¼‰é¦–å…ˆæ˜¯é“¾è¡¨ï¼Œä½†ä¸ä¼ ç»Ÿé“¾è¡¨ç›¸æ¯”æœ‰å‡ ç‚¹å·®å¼‚ï¼š å…ƒç´ æŒ‰ç…§å‡åºæ’åˆ—å­˜å‚¨ èŠ‚ç‚¹å¯èƒ½åŒ…å«å¤šä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆè·¨åº¦ä¸åŒã€‚</p><figure><img src="/blog/assets/img/1653986771309.a3e21474.png" alt="1653986771309" tabindex="0" loading="lazy"><figcaption>1653986771309</figcaption></figure><p>SkipListï¼ˆè·³è¡¨ï¼‰é¦–å…ˆæ˜¯é“¾è¡¨ï¼Œä½†ä¸ä¼ ç»Ÿé“¾è¡¨ç›¸æ¯”æœ‰å‡ ç‚¹å·®å¼‚ï¼š å…ƒç´ æŒ‰ç…§å‡åºæ’åˆ—å­˜å‚¨ èŠ‚ç‚¹å¯èƒ½åŒ…å«å¤šä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆè·¨åº¦ä¸åŒã€‚</p><figure><img src="/blog/assets/img/1653986813240.89f188ae.png" alt="1653986813240" tabindex="0" loading="lazy"><figcaption>1653986813240</figcaption></figure><p>SkipListï¼ˆè·³è¡¨ï¼‰é¦–å…ˆæ˜¯é“¾è¡¨ï¼Œä½†ä¸ä¼ ç»Ÿé“¾è¡¨ç›¸æ¯”æœ‰å‡ ç‚¹å·®å¼‚ï¼š å…ƒç´ æŒ‰ç…§å‡åºæ’åˆ—å­˜å‚¨ èŠ‚ç‚¹å¯èƒ½åŒ…å«å¤šä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆè·¨åº¦ä¸åŒã€‚</p><figure><img src="/blog/assets/img/1653986877620.95ba23e8.png" alt="1653986877620" tabindex="0" loading="lazy"><figcaption>1653986877620</figcaption></figure><p>å°æ€»ç»“ï¼š</p><p>SkipListçš„ç‰¹ç‚¹ï¼š</p><ul><li>è·³è·ƒè¡¨æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«scoreå’Œeleå€¼</li><li>èŠ‚ç‚¹æŒ‰ç…§scoreå€¼æ’åºï¼Œscoreå€¼ä¸€æ ·åˆ™æŒ‰ç…§eleå­—å…¸æ’åº</li><li>æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥åŒ…å«å¤šå±‚æŒ‡é’ˆï¼Œå±‚æ•°æ˜¯1åˆ°32ä¹‹é—´çš„éšæœºæ•°</li><li>ä¸åŒå±‚æŒ‡é’ˆåˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„è·¨åº¦ä¸åŒï¼Œå±‚çº§è¶Šé«˜ï¼Œè·¨åº¦è¶Šå¤§</li><li>å¢åˆ æ”¹æŸ¥æ•ˆç‡ä¸çº¢é»‘æ ‘åŸºæœ¬ä¸€è‡´ï¼Œå®ç°å´æ›´ç®€å•</li></ul><h3 id="_1-7-redisæ•°æ®ç»“æ„-redisobject" tabindex="-1"><a class="header-anchor" href="#_1-7-redisæ•°æ®ç»“æ„-redisobject"><span>1.7 Redisæ•°æ®ç»“æ„-RedisObject</span></a></h3><p>Redisä¸­çš„ä»»æ„æ•°æ®ç±»å‹çš„é”®å’Œå€¼éƒ½ä¼šè¢«å°è£…ä¸ºä¸€ä¸ªRedisObjectï¼Œä¹Ÿå«åšRediså¯¹è±¡ï¼Œæºç å¦‚ä¸‹ï¼š</p><p>1ã€ä»€ä¹ˆæ˜¯redisObjectï¼š ä»Redisçš„ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œâ¼€ä¸ªRedisèŠ‚ç‚¹åŒ…å«å¤šä¸ªdatabaseï¼ˆéclusteræ¨¡å¼ä¸‹é»˜è®¤æ˜¯16ä¸ªï¼Œclusteræ¨¡å¼ä¸‹åªèƒ½æ˜¯1ä¸ªï¼‰ï¼Œè€Œä¸€ä¸ªdatabaseç»´æŠ¤äº†ä»key spaceåˆ°object spaceçš„æ˜ å°„å…³ç³»ã€‚è¿™ä¸ªæ˜ å°„å…³ç³»çš„keyæ˜¯stringç±»å‹ï¼Œâ½½valueå¯ä»¥æ˜¯å¤šç§æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ï¼š string, list, hashã€setã€sorted setç­‰ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œkeyçš„ç±»å‹å›ºå®šæ˜¯stringï¼Œè€Œvalueå¯èƒ½çš„ç±»å‹æ˜¯å¤šä¸ªã€‚ â½½ä»Rediså†…éƒ¨å®ç°çš„â¾“åº¦æ¥çœ‹ï¼Œdatabaseå†…çš„è¿™ä¸ªæ˜ å°„å…³ç³»æ˜¯ç”¨â¼€ä¸ªdictæ¥ç»´æŠ¤çš„ã€‚dictçš„keyå›ºå®šç”¨â¼€ç§æ•°æ®ç»“æ„æ¥è¡¨è¾¾å°±å¤Ÿäº†ï¼Œè¿™å°±æ˜¯åŠ¨æ€å­—ç¬¦ä¸²sdsã€‚è€Œvalueåˆ™æ¯”è¾ƒå¤æ‚ï¼Œä¸ºäº†åœ¨åŒâ¼€ä¸ªdictå†…èƒ½å¤Ÿå­˜å‚¨ä¸åŒç±»å‹çš„valueï¼Œè¿™å°±éœ€è¦â¼€ä¸ªé€šâ½¤çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªé€šç”¨çš„æ•°æ®ç»“æ„å°±æ˜¯robjï¼Œå…¨åæ˜¯redisObjectã€‚</p><figure><img src="/blog/assets/img/1653986956618.2984471a.png" alt="1653986956618" tabindex="0" loading="lazy"><figcaption>1653986956618</figcaption></figure><p>Redisçš„ç¼–ç æ–¹å¼</p><p>Redisä¸­ä¼šæ ¹æ®å­˜å‚¨çš„æ•°æ®ç±»å‹ä¸åŒï¼Œé€‰æ‹©ä¸åŒçš„ç¼–ç æ–¹å¼ï¼Œå…±åŒ…å«11ç§ä¸åŒç±»å‹ï¼š</p><table><thead><tr><th><strong>ç¼–å·</strong></th><th><strong>ç¼–ç æ–¹å¼</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>0</td><td>OBJ_ENCODING_RAW</td><td>rawç¼–ç åŠ¨æ€å­—ç¬¦ä¸²</td></tr><tr><td>1</td><td>OBJ_ENCODING_INT</td><td>longç±»å‹çš„æ•´æ•°çš„å­—ç¬¦ä¸²</td></tr><tr><td>2</td><td>OBJ_ENCODING_HT</td><td>hashè¡¨ï¼ˆå­—å…¸dictï¼‰</td></tr><tr><td>3</td><td>OBJ_ENCODING_ZIPMAP</td><td>å·²åºŸå¼ƒ</td></tr><tr><td>4</td><td>OBJ_ENCODING_LINKEDLIST</td><td>åŒç«¯é“¾è¡¨</td></tr><tr><td>5</td><td>OBJ_ENCODING_ZIPLIST</td><td>å‹ç¼©åˆ—è¡¨</td></tr><tr><td>6</td><td>OBJ_ENCODING_INTSET</td><td>æ•´æ•°é›†åˆ</td></tr><tr><td>7</td><td>OBJ_ENCODING_SKIPLIST</td><td>è·³è¡¨</td></tr><tr><td>8</td><td>OBJ_ENCODING_EMBSTR</td><td>embstrçš„åŠ¨æ€å­—ç¬¦ä¸²</td></tr><tr><td>9</td><td>OBJ_ENCODING_QUICKLIST</td><td>å¿«é€Ÿåˆ—è¡¨</td></tr><tr><td>10</td><td>OBJ_ENCODING_STREAM</td><td>Streamæµ</td></tr></tbody></table><p>äº”ç§æ•°æ®ç»“æ„</p><p>Redisä¸­ä¼šæ ¹æ®å­˜å‚¨çš„æ•°æ®ç±»å‹ä¸åŒï¼Œé€‰æ‹©ä¸åŒçš„ç¼–ç æ–¹å¼ã€‚æ¯ç§æ•°æ®ç±»å‹çš„ä½¿ç”¨çš„ç¼–ç æ–¹å¼å¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>æ•°æ®ç±»å‹</strong></th><th><strong>ç¼–ç æ–¹å¼</strong></th></tr></thead><tbody><tr><td>OBJ_STRING</td><td>intã€embstrã€raw</td></tr><tr><td>OBJ_LIST</td><td>LinkedListå’ŒZipList(3.2ä»¥å‰)ã€QuickListï¼ˆ3.2ä»¥åï¼‰</td></tr><tr><td>OBJ_SET</td><td>intsetã€HT</td></tr><tr><td>OBJ_ZSET</td><td>ZipListã€HTã€SkipList</td></tr><tr><td>OBJ_HASH</td><td>ZipListã€HT</td></tr></tbody></table><h3 id="_1-8-redisæ•°æ®ç»“æ„-string" tabindex="-1"><a class="header-anchor" href="#_1-8-redisæ•°æ®ç»“æ„-string"><span>1.8 Redisæ•°æ®ç»“æ„-String</span></a></h3><p>Stringæ˜¯Redisä¸­æœ€å¸¸è§çš„æ•°æ®å­˜å‚¨ç±»å‹ï¼š</p><p>å…¶åŸºæœ¬ç¼–ç æ–¹å¼æ˜¯RAWï¼ŒåŸºäºç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼ˆSDSï¼‰å®ç°ï¼Œå­˜å‚¨ä¸Šé™ä¸º512mbã€‚</p><p>å¦‚æœå­˜å‚¨çš„SDSé•¿åº¦å°äº44å­—èŠ‚ï¼Œåˆ™ä¼šé‡‡ç”¨EMBSTRç¼–ç ï¼Œæ­¤æ—¶object headä¸SDSæ˜¯ä¸€æ®µè¿ç»­ç©ºé—´ã€‚ç”³è¯·å†…å­˜æ—¶</p><p>åªéœ€è¦è°ƒç”¨ä¸€æ¬¡å†…å­˜åˆ†é…å‡½æ•°ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p><p>ï¼ˆ1ï¼‰åº•å±‚å®ç°â½…å¼ï¼šåŠ¨æ€å­—ç¬¦ä¸²sds æˆ–è€… long Stringçš„å†…éƒ¨å­˜å‚¨ç»“æ„â¼€èˆ¬æ˜¯sdsï¼ˆSimple Dynamic Stringï¼Œå¯ä»¥åŠ¨æ€æ‰©å±•å†…å­˜ï¼‰ï¼Œä½†æ˜¯å¦‚æœâ¼€ä¸ªStringç±»å‹çš„valueçš„å€¼æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆRediså†…éƒ¨ä¼šæŠŠå®ƒè½¬æˆlongç±»å‹æ¥å­˜å‚¨ï¼Œä»â½½å‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚</p><figure><img src="/blog/assets/img/1653987103450.1ab44b79.png" alt="1653987103450" tabindex="0" loading="lazy"><figcaption>1653987103450</figcaption></figure><p>å¦‚æœå­˜å‚¨çš„å­—ç¬¦ä¸²æ˜¯æ•´æ•°å€¼ï¼Œå¹¶ä¸”å¤§å°åœ¨LONG_MAXèŒƒå›´å†…ï¼Œåˆ™ä¼šé‡‡ç”¨INTç¼–ç ï¼šç›´æ¥å°†æ•°æ®ä¿å­˜åœ¨RedisObjectçš„ptræŒ‡é’ˆä½ç½®ï¼ˆåˆšå¥½8å­—èŠ‚ï¼‰ï¼Œä¸å†éœ€è¦SDSäº†ã€‚</p><figure><img src="/blog/assets/img/1653987159575.c6de92fd.png" alt="1653987159575" tabindex="0" loading="lazy"><figcaption>1653987159575</figcaption></figure><figure><img src="/blog/assets/img/1653987172764.79543a8f.png" alt="1653987172764" tabindex="0" loading="lazy"><figcaption>1653987172764</figcaption></figure><figure><img src="/blog/assets/img/1653987202522.94b084d1.png" alt="1653987202522" tabindex="0" loading="lazy"><figcaption>1653987202522</figcaption></figure><p>ç¡®åˆ‡åœ°è¯´ï¼ŒStringåœ¨Redisä¸­æ˜¯â½¤â¼€ä¸ªrobjæ¥è¡¨ç¤ºçš„ã€‚</p><p>ç”¨æ¥è¡¨ç¤ºStringçš„robjå¯èƒ½ç¼–ç æˆ3ç§å†…éƒ¨è¡¨â½°ï¼šOBJ_ENCODING_RAWï¼ŒOBJ_ENCODING_EMBSTRï¼ŒOBJ_ENCODING_INTã€‚ å…¶ä¸­å‰ä¸¤ç§ç¼–ç ä½¿â½¤çš„æ˜¯sdsæ¥å­˜å‚¨ï¼Œæœ€åâ¼€ç§OBJ_ENCODING_INTç¼–ç ç›´æ¥æŠŠstringå­˜æˆäº†longå‹ã€‚ åœ¨å¯¹stringè¿›è¡Œincr, decrç­‰æ“ä½œçš„æ—¶å€™ï¼Œå¦‚æœå®ƒå†…éƒ¨æ˜¯OBJ_ENCODING_INTç¼–ç ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¡ŒåŠ å‡æ“ä½œï¼›å¦‚æœå®ƒå†…éƒ¨æ˜¯OBJ_ENCODING_RAWæˆ–OBJ_ENCODING_EMBSTRç¼–ç ï¼Œé‚£ä¹ˆRedisä¼šå…ˆè¯•å›¾æŠŠsdså­˜å‚¨çš„å­—ç¬¦ä¸²è½¬æˆlongå‹ï¼Œå¦‚æœèƒ½è½¬æˆåŠŸï¼Œå†è¿›è¡ŒåŠ å‡æ“ä½œã€‚å¯¹â¼€ä¸ªå†…éƒ¨è¡¨ç¤ºæˆlongå‹çš„stringæ‰§è¡Œappend, setbit, getrangeè¿™äº›å‘½ä»¤ï¼Œé’ˆå¯¹çš„ä»ç„¶æ˜¯stringçš„å€¼ï¼ˆå³â¼—è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å†…éƒ¨è¡¨â½°çš„longå‹è¿›â¾æ“ä½œã€‚æ¯”å¦‚å­—ç¬¦ä¸²â€32â€ï¼Œå¦‚æœæŒ‰ç…§å­—ç¬¦æ•°ç»„æ¥è§£é‡Šï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼Œå®ƒä»¬çš„ASCIIç åˆ†åˆ«æ˜¯0x33å’Œ0x32ã€‚å½“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤setbit key 7 0çš„æ—¶å€™ï¼Œç›¸å½“äºæŠŠå­—ç¬¦0x33å˜æˆäº†0x32ï¼Œè¿™æ ·å­—ç¬¦ä¸²çš„å€¼å°±å˜æˆäº†â€22â€ã€‚â½½å¦‚æœå°†å­—ç¬¦ä¸²â€32â€æŒ‰ç…§å†…éƒ¨çš„64ä½longå‹æ¥è§£é‡Šï¼Œé‚£ä¹ˆå®ƒæ˜¯0x0000000000000020ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ‰§â¾setbitä½æ“ä½œï¼Œç»“æœå°±å®Œå…¨ä¸å¯¹äº†ã€‚å› æ­¤ï¼Œåœ¨è¿™äº›å‘½ä»¤çš„å®ç°ä¸­ï¼Œä¼šæŠŠlongå‹å…ˆè½¬æˆå­—ç¬¦ä¸²å†è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚</p><h3 id="_1-9-redisæ•°æ®ç»“æ„-list" tabindex="-1"><a class="header-anchor" href="#_1-9-redisæ•°æ®ç»“æ„-list"><span>1.9 Redisæ•°æ®ç»“æ„-List</span></a></h3><p>Redisçš„Listç±»å‹å¯ä»¥ä»é¦–ã€å°¾æ“ä½œåˆ—è¡¨ä¸­çš„å…ƒç´ ï¼š</p><figure><img src="/blog/assets/img/1653987240622.1934d6a0.png" alt="1653987240622" tabindex="0" loading="lazy"><figcaption>1653987240622</figcaption></figure><p>å“ªä¸€ä¸ªæ•°æ®ç»“æ„èƒ½æ»¡è¶³ä¸Šè¿°ç‰¹å¾ï¼Ÿ</p><ul><li>LinkedList ï¼šæ™®é€šé“¾è¡¨ï¼Œå¯ä»¥ä»åŒç«¯è®¿é—®ï¼Œå†…å­˜å ç”¨è¾ƒé«˜ï¼Œå†…å­˜ç¢ç‰‡è¾ƒå¤š</li><li>ZipList ï¼šå‹ç¼©åˆ—è¡¨ï¼Œå¯ä»¥ä»åŒç«¯è®¿é—®ï¼Œå†…å­˜å ç”¨ä½ï¼Œå­˜å‚¨ä¸Šé™ä½</li><li>QuickListï¼šLinkedList + ZipListï¼Œå¯ä»¥ä»åŒç«¯è®¿é—®ï¼Œå†…å­˜å ç”¨è¾ƒä½ï¼ŒåŒ…å«å¤šä¸ªZipListï¼Œå­˜å‚¨ä¸Šé™é«˜</li></ul><p>Redisçš„Listç»“æ„ç±»ä¼¼ä¸€ä¸ªåŒç«¯é“¾è¡¨ï¼Œå¯ä»¥ä»é¦–ã€å°¾æ“ä½œåˆ—è¡¨ä¸­çš„å…ƒç´ ï¼š</p><p>åœ¨3.2ç‰ˆæœ¬ä¹‹å‰ï¼ŒRedisé‡‡ç”¨ZipListå’ŒLinkedListæ¥å®ç°Listï¼Œå½“å…ƒç´ æ•°é‡å°äº512å¹¶ä¸”å…ƒç´ å¤§å°å°äº64å­—èŠ‚æ—¶é‡‡ç”¨ZipListç¼–ç ï¼Œè¶…è¿‡åˆ™é‡‡ç”¨LinkedListç¼–ç ã€‚</p><p>åœ¨3.2ç‰ˆæœ¬ä¹‹åï¼ŒRedisç»Ÿä¸€é‡‡ç”¨QuickListæ¥å®ç°Listï¼š</p><figure><img src="/blog/assets/img/1653987313461.b9362668.png" alt="1653987313461" tabindex="0" loading="lazy"><figcaption>1653987313461</figcaption></figure><h3 id="_2-0-redisæ•°æ®ç»“æ„-setç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-0-redisæ•°æ®ç»“æ„-setç»“æ„"><span>2.0 Redisæ•°æ®ç»“æ„-Setç»“æ„</span></a></h3><p>Setæ˜¯Redisä¸­çš„å•åˆ—é›†åˆï¼Œæ»¡è¶³ä¸‹åˆ—ç‰¹ç‚¹ï¼š</p><ul><li>ä¸ä¿è¯æœ‰åºæ€§</li><li>ä¿è¯å…ƒç´ å”¯ä¸€</li><li>æ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†</li></ul><figure><img src="/blog/assets/img/1653987342550.91ebc66b.png" alt="1653987342550" tabindex="0" loading="lazy"><figcaption>1653987342550</figcaption></figure><p>å¯ä»¥çœ‹å‡ºï¼ŒSetå¯¹æŸ¥è¯¢å…ƒç´ çš„æ•ˆç‡è¦æ±‚éå¸¸é«˜ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„å¯ä»¥æ»¡è¶³ï¼Ÿ HashTableï¼Œä¹Ÿå°±æ˜¯Redisä¸­çš„Dictï¼Œä¸è¿‡Dictæ˜¯åŒåˆ—é›†åˆï¼ˆå¯ä»¥å­˜é”®ã€å€¼å¯¹ï¼‰</p><p>Setæ˜¯Redisä¸­çš„é›†åˆï¼Œä¸ä¸€å®šç¡®ä¿å…ƒç´ æœ‰åºï¼Œå¯ä»¥æ»¡è¶³å…ƒç´ å”¯ä¸€ã€æŸ¥è¯¢æ•ˆç‡è¦æ±‚æé«˜ã€‚ ä¸ºäº†æŸ¥è¯¢æ•ˆç‡å’Œå”¯ä¸€æ€§ï¼Œseté‡‡ç”¨HTç¼–ç ï¼ˆDictï¼‰ã€‚Dictä¸­çš„keyç”¨æ¥å­˜å‚¨å…ƒç´ ï¼Œvalueç»Ÿä¸€ä¸ºnullã€‚ å½“å­˜å‚¨çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯æ•´æ•°ï¼Œå¹¶ä¸”å…ƒç´ æ•°é‡ä¸è¶…è¿‡set-max-intset-entriesæ—¶ï¼ŒSetä¼šé‡‡ç”¨IntSetç¼–ç ï¼Œä»¥èŠ‚çœå†…å­˜</p><figure><img src="/blog/assets/img/1653987388177.a5c1b30e.png" alt="1653987388177" tabindex="0" loading="lazy"><figcaption>1653987388177</figcaption></figure><p>ç»“æ„å¦‚ä¸‹ï¼š</p><p>â€‹ <img src="/blog/assets/img/1653987454403.0f1d2a5a.png" alt="1653987454403" loading="lazy"></p><h3 id="_2-1ã€redisæ•°æ®ç»“æ„-zset" tabindex="-1"><a class="header-anchor" href="#_2-1ã€redisæ•°æ®ç»“æ„-zset"><span>2.1ã€Redisæ•°æ®ç»“æ„-ZSET</span></a></h3><p>ZSetä¹Ÿå°±æ˜¯SortedSetï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½éœ€è¦æŒ‡å®šä¸€ä¸ªscoreå€¼å’Œmemberå€¼ï¼š</p><ul><li>å¯ä»¥æ ¹æ®scoreå€¼æ’åºå</li><li>memberå¿…é¡»å”¯ä¸€</li><li>å¯ä»¥æ ¹æ®memberæŸ¥è¯¢åˆ†æ•°</li></ul><figure><img src="/blog/assets/img/1653992091967.caeedb48.png" alt="1653992091967" tabindex="0" loading="lazy"><figcaption>1653992091967</figcaption></figure><p>å› æ­¤ï¼Œzsetåº•å±‚æ•°æ®ç»“æ„å¿…é¡»æ»¡è¶³é”®å€¼å­˜å‚¨ã€é”®å¿…é¡»å”¯ä¸€ã€å¯æ’åºè¿™å‡ ä¸ªéœ€æ±‚ã€‚ä¹‹å‰å­¦ä¹ çš„å“ªç§ç¼–ç ç»“æ„å¯ä»¥æ»¡è¶³ï¼Ÿ</p><ul><li>SkipListï¼šå¯ä»¥æ’åºï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶å­˜å‚¨scoreå’Œeleå€¼ï¼ˆmemberï¼‰</li><li>HTï¼ˆDictï¼‰ï¼šå¯ä»¥é”®å€¼å­˜å‚¨ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®keyæ‰¾value</li></ul><figure><img src="/blog/assets/img/1653992121692.e3bc53b2.png" alt="1653992121692" tabindex="0" loading="lazy"><figcaption>1653992121692</figcaption></figure><figure><img src="/blog/assets/img/1653992172526.480032aa.png" alt="1653992172526" tabindex="0" loading="lazy"><figcaption>1653992172526</figcaption></figure><p>å½“å…ƒç´ æ•°é‡ä¸å¤šæ—¶ï¼ŒHTå’ŒSkipListçš„ä¼˜åŠ¿ä¸æ˜æ˜¾ï¼Œè€Œä¸”æ›´è€—å†…å­˜ã€‚å› æ­¤zsetè¿˜ä¼šé‡‡ç”¨ZipListç»“æ„æ¥èŠ‚çœå†…å­˜ï¼Œä¸è¿‡éœ€è¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>å…ƒç´ æ•°é‡å°äºzset_max_ziplist_entriesï¼Œé»˜è®¤å€¼128</li><li>æ¯ä¸ªå…ƒç´ éƒ½å°äºzset_max_ziplist_valueå­—èŠ‚ï¼Œé»˜è®¤å€¼64</li></ul><p>ziplistæœ¬èº«æ²¡æœ‰æ’åºåŠŸèƒ½ï¼Œè€Œä¸”æ²¡æœ‰é”®å€¼å¯¹çš„æ¦‚å¿µï¼Œå› æ­¤éœ€è¦æœ‰zseté€šè¿‡ç¼–ç å®ç°ï¼š</p><ul><li>ZipListæ˜¯è¿ç»­å†…å­˜ï¼Œå› æ­¤scoreå’Œelementæ˜¯ç´§æŒ¨åœ¨ä¸€èµ·çš„ä¸¤ä¸ªentryï¼Œ elementåœ¨å‰ï¼Œscoreåœ¨å</li><li>scoreè¶Šå°è¶Šæ¥è¿‘é˜Ÿé¦–ï¼Œscoreè¶Šå¤§è¶Šæ¥è¿‘é˜Ÿå°¾ï¼ŒæŒ‰ç…§scoreå€¼å‡åºæ’åˆ—</li></ul><figure><img src="/blog/assets/img/1653992238097.66e9f757.png" alt="1653992238097" tabindex="0" loading="lazy"><figcaption>1653992238097</figcaption></figure><figure><img src="/blog/assets/img/1653992299740.8c5c18b8.png" alt="1653992299740" tabindex="0" loading="lazy"><figcaption>1653992299740</figcaption></figure><h3 id="_2-2-ã€redisæ•°æ®ç»“æ„-hash" tabindex="-1"><a class="header-anchor" href="#_2-2-ã€redisæ•°æ®ç»“æ„-hash"><span>2.2 ã€Redisæ•°æ®ç»“æ„-Hash</span></a></h3><p>Hashç»“æ„ä¸Redisä¸­çš„Zsetéå¸¸ç±»ä¼¼ï¼š</p><ul><li>éƒ½æ˜¯é”®å€¼å­˜å‚¨</li><li>éƒ½éœ€æ±‚æ ¹æ®é”®è·å–å€¼</li><li>é”®å¿…é¡»å”¯ä¸€</li></ul><p>åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>zsetçš„é”®æ˜¯memberï¼Œå€¼æ˜¯scoreï¼›hashçš„é”®å’Œå€¼éƒ½æ˜¯ä»»æ„å€¼</li><li>zsetè¦æ ¹æ®scoreæ’åºï¼›hashåˆ™æ— éœ€æ’åº</li></ul><p>ï¼ˆ1ï¼‰åº•å±‚å®ç°æ–¹å¼ï¼šå‹ç¼©åˆ—è¡¨ziplist æˆ–è€… å­—å…¸dict å½“Hashä¸­æ•°æ®é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒHashåº•å±‚æ‰â½¤å‹ç¼©åˆ—è¡¨ziplistè¿›â¾å­˜å‚¨æ•°æ®ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œåº•å±‚çš„ziplistå°±å¯èƒ½ä¼šè½¬æˆdictï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p><p>hash-max-ziplist-entries 512</p><p>hash-max-ziplist-value 64</p><p>å½“æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶å…¶ä¸­ä¹‹â¼€çš„æ—¶å€™ï¼ŒRediså°±ä½¿â½¤dictå­—å…¸æ¥å®ç°hashã€‚ Redisçš„hashä¹‹æ‰€ä»¥è¿™æ ·è®¾è®¡ï¼Œæ˜¯å› ä¸ºå½“ziplistå˜å¾—å¾ˆâ¼¤çš„æ—¶å€™ï¼Œå®ƒæœ‰å¦‚ä¸‹å‡ ä¸ªç¼ºç‚¹ï¼š</p><ul><li>æ¯æ¬¡æ’â¼Šæˆ–ä¿®æ”¹å¼•å‘çš„reallocæ“ä½œä¼šæœ‰æ›´â¼¤çš„æ¦‚ç‡é€ æˆå†…å­˜æ‹·è´ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚</li><li>â¼€æ—¦å‘ç”Ÿå†…å­˜æ‹·è´ï¼Œå†…å­˜æ‹·è´çš„æˆæœ¬ä¹Ÿç›¸åº”å¢åŠ ï¼Œå› ä¸ºè¦æ‹·è´æ›´â¼¤çš„â¼€å—æ•°æ®ã€‚</li><li>å½“ziplistæ•°æ®é¡¹è¿‡å¤šçš„æ—¶å€™ï¼Œåœ¨å®ƒä¸Šâ¾¯æŸ¥æ‰¾æŒ‡å®šçš„æ•°æ®é¡¹å°±ä¼šæ€§èƒ½å˜å¾—å¾ˆä½ï¼Œå› ä¸ºziplistä¸Šçš„æŸ¥æ‰¾éœ€è¦è¿›è¡Œéå†ã€‚</li></ul><p>æ€»ä¹‹ï¼Œziplistæœ¬æ¥å°±è®¾è®¡ä¸ºå„ä¸ªæ•°æ®é¡¹æŒ¨åœ¨â¼€èµ·ç»„æˆè¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œè¿™ç§ç»“æ„å¹¶ä¸æ“…é•¿åšä¿®æ”¹æ“ä½œã€‚â¼€æ—¦æ•°æ®å‘â½£æ”¹åŠ¨ï¼Œå°±ä¼šå¼•å‘å†…å­˜reallocï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æ‹·è´ã€‚</p><p>hashç»“æ„å¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/1653992339937.dbb0ca05.png" alt="1653992339937" tabindex="0" loading="lazy"><figcaption>1653992339937</figcaption></figure><p>zseté›†åˆå¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/1653992360355.fb08de8b.png" alt="1653992360355" tabindex="0" loading="lazy"><figcaption>1653992360355</figcaption></figure><p>å› æ­¤ï¼ŒHashåº•å±‚é‡‡ç”¨çš„ç¼–ç ä¸Zsetä¹ŸåŸºæœ¬ä¸€è‡´ï¼Œåªéœ€è¦æŠŠæ’åºæœ‰å…³çš„SkipListå»æ‰å³å¯ï¼š</p><p>Hashç»“æ„é»˜è®¤é‡‡ç”¨ZipListç¼–ç ï¼Œç”¨ä»¥èŠ‚çœå†…å­˜ã€‚ ZipListä¸­ç›¸é‚»çš„ä¸¤ä¸ªentry åˆ†åˆ«ä¿å­˜fieldå’Œvalue</p><p>å½“æ•°æ®é‡è¾ƒå¤§æ—¶ï¼ŒHashç»“æ„ä¼šè½¬ä¸ºHTç¼–ç ï¼Œä¹Ÿå°±æ˜¯Dictï¼Œè§¦å‘æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p><ul><li>ZipListä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡äº†hash-max-ziplist-entriesï¼ˆé»˜è®¤512ï¼‰</li><li>ZipListä¸­çš„ä»»æ„entryå¤§å°è¶…è¿‡äº†hash-max-ziplist-valueï¼ˆé»˜è®¤64å­—èŠ‚ï¼‰</li></ul><figure><img src="/blog/assets/img/1653992413406.5824cbeb.png" alt="1653992413406" tabindex="0" loading="lazy"><figcaption>1653992413406</figcaption></figure><h2 id="_2ã€åŸç†ç¯‡-redisç½‘ç»œæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_2ã€åŸç†ç¯‡-redisç½‘ç»œæ¨¡å‹"><span>2ã€åŸç†ç¯‡-Redisç½‘ç»œæ¨¡å‹</span></a></h2><h3 id="_2-1-ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸æ€ç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_2-1-ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸æ€ç©ºé—´"><span>2.1 ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸æ€ç©ºé—´</span></a></h3><p>æœåŠ¡å™¨å¤§å¤šéƒ½é‡‡ç”¨Linuxç³»ç»Ÿï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥Linuxä¸ºä¾‹æ¥è®²è§£:</p><p>ubuntuå’ŒCentos éƒ½æ˜¯Linuxçš„å‘è¡Œç‰ˆï¼Œå‘è¡Œç‰ˆå¯ä»¥çœ‹æˆå¯¹linuxåŒ…äº†ä¸€å±‚å£³ï¼Œä»»ä½•Linuxå‘è¡Œç‰ˆï¼Œå…¶ç³»ç»Ÿå†…æ ¸éƒ½æ˜¯Linuxã€‚æˆ‘ä»¬çš„åº”ç”¨éƒ½éœ€è¦é€šè¿‡Linuxå†…æ ¸ä¸ç¡¬ä»¶äº¤äº’</p><figure><img src="/blog/assets/img/1653844970346.19e902fa.png" alt="1653844970346" tabindex="0" loading="lazy"><figcaption>1653844970346</figcaption></figure><p>ç”¨æˆ·çš„åº”ç”¨ï¼Œæ¯”å¦‚redisï¼Œmysqlç­‰å…¶å®æ˜¯æ²¡æœ‰åŠæ³•å»æ‰§è¡Œè®¿é—®æˆ‘ä»¬æ“ä½œç³»ç»Ÿçš„ç¡¬ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘è¡Œç‰ˆçš„è¿™ä¸ªå£³å­å»è®¿é—®å†…æ ¸ï¼Œå†é€šè¿‡å†…æ ¸å»è®¿é—®è®¡ç®—æœºç¡¬ä»¶</p><figure><img src="/blog/assets/img/1653845147190.fc2f0eee.png" alt="1653845147190" tabindex="0" loading="lazy"><figcaption>1653845147190</figcaption></figure><p>è®¡ç®—æœºç¡¬ä»¶åŒ…æ‹¬ï¼Œå¦‚cpuï¼Œå†…å­˜ï¼Œç½‘å¡ç­‰ç­‰ï¼Œå†…æ ¸ï¼ˆé€šè¿‡å¯»å€ç©ºé—´ï¼‰å¯ä»¥æ“ä½œç¡¬ä»¶çš„ï¼Œä½†æ˜¯å†…æ ¸éœ€è¦ä¸åŒè®¾å¤‡çš„é©±åŠ¨ï¼Œæœ‰äº†è¿™äº›é©±åŠ¨ä¹‹åï¼Œå†…æ ¸å°±å¯ä»¥å»å¯¹è®¡ç®—æœºç¡¬ä»¶å»è¿›è¡Œ å†…å­˜ç®¡ç†ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„ç®¡ç†ï¼Œè¿›ç¨‹çš„ç®¡ç†ç­‰ç­‰</p><figure><img src="/blog/assets/img/1653896065386.e9f527c9.png" alt="1653896065386" tabindex="0" loading="lazy"><figcaption>1653896065386</figcaption></figure><p>æˆ‘ä»¬æƒ³è¦ç”¨æˆ·çš„åº”ç”¨æ¥è®¿é—®ï¼Œè®¡ç®—æœºå°±å¿…é¡»è¦é€šè¿‡å¯¹å¤–æš´éœ²çš„ä¸€äº›æ¥å£ï¼Œæ‰èƒ½è®¿é—®åˆ°ï¼Œä»è€Œç®€ä»‹çš„å®ç°å¯¹å†…æ ¸çš„æ“æ§ï¼Œä½†æ˜¯å†…æ ¸æœ¬èº«ä¸Šæ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ï¼Œæ‰€ä»¥ä»–æœ¬èº«ä¹Ÿéœ€è¦ä¸€äº›å†…å­˜ï¼Œcpuç­‰è®¾å¤‡èµ„æºï¼Œç”¨æˆ·åº”ç”¨æœ¬èº«ä¹Ÿåœ¨æ¶ˆè€—è¿™äº›èµ„æºï¼Œå¦‚æœä¸åŠ ä»»ä½•é™åˆ¶ï¼Œç”¨æˆ·å»æ“ä½œéšæ„çš„å»æ“ä½œæˆ‘ä»¬çš„èµ„æºï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´ä¸€äº›å†²çªï¼Œç”šè‡³æœ‰å¯èƒ½å¯¼è‡´æˆ‘ä»¬çš„ç³»ç»Ÿå‡ºç°æ— æ³•è¿è¡Œçš„é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŠŠç”¨æˆ·å’Œ<strong>å†…æ ¸éš”ç¦»å¼€</strong></p><p>è¿›ç¨‹çš„å¯»å€ç©ºé—´åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼š<strong>å†…æ ¸ç©ºé—´ã€ç”¨æˆ·ç©ºé—´</strong></p><p>ä»€ä¹ˆæ˜¯å¯»å€ç©ºé—´å‘¢ï¼Ÿæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¹Ÿå¥½ï¼Œè¿˜æ˜¯å†…æ ¸ç©ºé—´ä¹Ÿå¥½ï¼Œéƒ½æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥å»ç‰©ç†å†…å­˜çš„ï¼Œè€Œæ˜¯é€šè¿‡åˆ†é…ä¸€äº›è™šæ‹Ÿå†…å­˜æ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œæˆ‘ä»¬çš„å†…æ ¸å’Œåº”ç”¨ç¨‹åºå»è®¿é—®è™šæ‹Ÿå†…å­˜çš„æ—¶å€™ï¼Œå°±éœ€è¦ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œè¿™ä¸ªåœ°å€æ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„æ•´æ•°ï¼Œæ¯”å¦‚ä¸€ä¸ª32ä½çš„æ“ä½œç³»ç»Ÿï¼Œä»–çš„å¸¦å®½å°±æ˜¯32ï¼Œä»–çš„è™šæ‹Ÿåœ°å€å°±æ˜¯2çš„32æ¬¡æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–å¯»å€çš„èŒƒå›´å°±æ˜¯0~2çš„32æ¬¡æ–¹ï¼Œ è¿™ç‰‡å¯»å€ç©ºé—´å¯¹åº”çš„å°±æ˜¯2çš„32ä¸ªå­—èŠ‚ï¼Œå°±æ˜¯4GBï¼Œè¿™ä¸ª4GBï¼Œä¼šæœ‰3ä¸ªGBåˆ†ç»™ç”¨æˆ·ç©ºé—´ï¼Œä¼šæœ‰1GBç»™å†…æ ¸ç³»ç»Ÿ</p><figure><img src="/blog/assets/img/1653896377259.f26a568e.png" alt="1653896377259" tabindex="0" loading="lazy"><figcaption>1653896377259</figcaption></figure><p>åœ¨linuxä¸­ï¼Œä»–ä»¬æƒé™åˆ†æˆä¸¤ä¸ªç­‰çº§ï¼Œ0å’Œ3ï¼Œç”¨æˆ·ç©ºé—´åªèƒ½æ‰§è¡Œå—é™çš„å‘½ä»¤ï¼ˆRing3ï¼‰ï¼Œè€Œä¸”ä¸èƒ½ç›´æ¥è°ƒç”¨ç³»ç»Ÿèµ„æºï¼Œå¿…é¡»é€šè¿‡å†…æ ¸æä¾›çš„æ¥å£æ¥è®¿é—®å†…æ ¸ç©ºé—´å¯ä»¥æ‰§è¡Œç‰¹æƒå‘½ä»¤ï¼ˆRing0ï¼‰ï¼Œè°ƒç”¨ä¸€åˆ‡ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨æˆ·çš„æ“ä½œæ˜¯è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œè€Œå†…æ ¸è¿è¡Œçš„æ•°æ®æ˜¯åœ¨å†…æ ¸ç©ºé—´çš„ï¼Œè€Œæœ‰çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºéœ€è¦å»è°ƒç”¨ä¸€äº›ç‰¹æƒèµ„æºï¼Œå»è°ƒç”¨ä¸€äº›å†…æ ¸ç©ºé—´çš„æ“ä½œï¼Œæ‰€ä»¥æ­¤æ—¶ä»–ä¿©éœ€è¦åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</p><p>æ¯”å¦‚ï¼š</p><p>Linuxç³»ç»Ÿä¸ºäº†æé«˜IOæ•ˆç‡ï¼Œä¼šåœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´éƒ½åŠ å…¥ç¼“å†²åŒºï¼š</p><p>å†™æ•°æ®æ—¶ï¼Œè¦æŠŠç”¨æˆ·ç¼“å†²æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œç„¶åå†™å…¥è®¾å¤‡</p><p>è¯»æ•°æ®æ—¶ï¼Œè¦ä»è®¾å¤‡è¯»å–æ•°æ®åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œç„¶åæ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒº</p><p>é’ˆå¯¹è¿™ä¸ªæ“ä½œï¼šæˆ‘ä»¬çš„ç”¨æˆ·åœ¨å†™è¯»æ•°æ®æ—¶ï¼Œä¼šå»å‘å†…æ ¸æ€ç”³è¯·ï¼Œæƒ³è¦è¯»å–å†…æ ¸çš„æ•°æ®ï¼Œè€Œå†…æ ¸æ•°æ®è¦å»ç­‰å¾…é©±åŠ¨ç¨‹åºä»ç¡¬ä»¶ä¸Šè¯»å–æ•°æ®ï¼Œå½“ä»ç£ç›˜ä¸ŠåŠ è½½åˆ°æ•°æ®ä¹‹åï¼Œå†…æ ¸ä¼šå°†æ•°æ®å†™å…¥åˆ°å†…æ ¸çš„ç¼“å†²åŒºä¸­ï¼Œç„¶åå†å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·æ€çš„bufferä¸­ï¼Œç„¶åå†è¿”å›ç»™åº”ç”¨ç¨‹åºï¼Œæ•´ä½“è€Œè¨€ï¼Œé€Ÿåº¦æ…¢ï¼Œå°±æ˜¯è¿™ä¸ªåŸå› ï¼Œä¸ºäº†åŠ é€Ÿï¼Œæˆ‘ä»¬å¸Œæœ›readä¹Ÿå¥½ï¼Œè¿˜æ˜¯wait for dataä¹Ÿæœ€å¥½éƒ½ä¸è¦ç­‰å¾…ï¼Œæˆ–è€…æ—¶é—´å°½é‡çš„çŸ­ã€‚</p><figure><img src="/blog/assets/img/1653896687354.6d64fc30.png" alt="1653896687354" tabindex="0" loading="lazy"><figcaption>1653896687354</figcaption></figure><h3 id="_2-2-ç½‘ç»œæ¨¡å‹-é˜»å¡io" tabindex="-1"><a class="header-anchor" href="#_2-2-ç½‘ç»œæ¨¡å‹-é˜»å¡io"><span>2.2.ç½‘ç»œæ¨¡å‹-é˜»å¡IO</span></a></h3><p>åœ¨ã€ŠUNIXç½‘ç»œç¼–ç¨‹ã€‹ä¸€ä¹¦ä¸­ï¼Œæ€»ç»“å½’çº³äº†5ç§IOæ¨¡å‹ï¼š</p><ul><li>é˜»å¡IOï¼ˆBlocking IOï¼‰</li><li>éé˜»å¡IOï¼ˆNonblocking IOï¼‰</li><li>IOå¤šè·¯å¤ç”¨ï¼ˆIO Multiplexingï¼‰</li><li>ä¿¡å·é©±åŠ¨IOï¼ˆSignal Driven IOï¼‰</li><li>å¼‚æ­¥IOï¼ˆAsynchronous IOï¼‰</li></ul><p>åº”ç”¨ç¨‹åºæƒ³è¦å»è¯»å–æ•°æ®ï¼Œä»–æ˜¯æ— æ³•ç›´æ¥å»è¯»å–ç£ç›˜æ•°æ®çš„ï¼Œä»–éœ€è¦å…ˆåˆ°å†…æ ¸é‡Œè¾¹å»ç­‰å¾…å†…æ ¸æ“ä½œç¡¬ä»¶æ‹¿åˆ°æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯1ï¼Œæ˜¯éœ€è¦ç­‰å¾…çš„ï¼Œç­‰åˆ°å†…æ ¸ä»ç£ç›˜ä¸ŠæŠŠæ•°æ®åŠ è½½å‡ºæ¥ä¹‹åï¼Œå†æŠŠè¿™ä¸ªæ•°æ®å†™ç»™ç”¨æˆ·çš„ç¼“å­˜åŒºï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯2ï¼Œå¦‚æœæ˜¯é˜»å¡IOï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ä»å‘èµ·è¯»è¯·æ±‚å¼€å§‹ï¼Œä¸€ç›´åˆ°è¯»å–åˆ°æ•°æ®ï¼Œéƒ½æ˜¯ä¸€ä¸ªé˜»å¡çŠ¶æ€ã€‚</p><figure><img src="/blog/assets/img/1653897115346.82d661c4.png" alt="1653897115346" tabindex="0" loading="lazy"><figcaption>1653897115346</figcaption></figure><p>å…·ä½“æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p>ç”¨æˆ·å»è¯»å–æ•°æ®æ—¶ï¼Œä¼šå»å…ˆå‘èµ·recvformä¸€ä¸ªå‘½ä»¤ï¼Œå»å°è¯•ä»å†…æ ¸ä¸ŠåŠ è½½æ•°æ®ï¼Œå¦‚æœå†…æ ¸æ²¡æœ‰æ•°æ®ï¼Œé‚£ä¹ˆç”¨æˆ·å°±ä¼šç­‰å¾…ï¼Œæ­¤æ—¶å†…æ ¸ä¼šå»ä»ç¡¬ä»¶ä¸Šè¯»å–æ•°æ®ï¼Œå†…æ ¸è¯»å–æ•°æ®ä¹‹åï¼Œä¼šæŠŠæ•°æ®æ‹·è´åˆ°ç”¨æˆ·æ€ï¼Œå¹¶ä¸”è¿”å›okï¼Œæ•´ä¸ªè¿‡ç¨‹ï¼Œéƒ½æ˜¯é˜»å¡ç­‰å¾…çš„ï¼Œè¿™å°±æ˜¯é˜»å¡IO</p><p>æ€»ç»“å¦‚ä¸‹ï¼š</p><p>é¡¾åæ€ä¹‰ï¼Œé˜»å¡IOå°±æ˜¯ä¸¤ä¸ªé˜¶æ®µéƒ½å¿…é¡»é˜»å¡ç­‰å¾…ï¼š</p><p><strong>é˜¶æ®µä¸€ï¼š</strong></p><ul><li>ç”¨æˆ·è¿›ç¨‹å°è¯•è¯»å–æ•°æ®ï¼ˆæ¯”å¦‚ç½‘å¡æ•°æ®ï¼‰</li><li>æ­¤æ—¶æ•°æ®å°šæœªåˆ°è¾¾ï¼Œå†…æ ¸éœ€è¦ç­‰å¾…æ•°æ®</li><li>æ­¤æ—¶ç”¨æˆ·è¿›ç¨‹ä¹Ÿå¤„äºé˜»å¡çŠ¶æ€</li></ul><p>é˜¶æ®µäºŒï¼š</p><ul><li>æ•°æ®åˆ°è¾¾å¹¶æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œä»£è¡¨å·²å°±ç»ª</li><li>å°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>æ‹·è´è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¾ç„¶é˜»å¡ç­‰å¾…</li><li>æ‹·è´å®Œæˆï¼Œç”¨æˆ·è¿›ç¨‹è§£é™¤é˜»å¡ï¼Œå¤„ç†æ•°æ®</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œé˜»å¡IOæ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹åœ¨ä¸¤ä¸ªé˜¶æ®µéƒ½æ˜¯é˜»å¡çŠ¶æ€ã€‚</p><figure><img src="/blog/assets/img/1653897270074.19076e13.png" alt="1653897270074" tabindex="0" loading="lazy"><figcaption>1653897270074</figcaption></figure><h3 id="_2-3-ç½‘ç»œæ¨¡å‹-éé˜»å¡io" tabindex="-1"><a class="header-anchor" href="#_2-3-ç½‘ç»œæ¨¡å‹-éé˜»å¡io"><span>2.3 ç½‘ç»œæ¨¡å‹-éé˜»å¡IO</span></a></h3><p>é¡¾åæ€ä¹‰ï¼Œéé˜»å¡IOçš„recvfromæ“ä½œä¼šç«‹å³è¿”å›ç»“æœè€Œä¸æ˜¯é˜»å¡ç”¨æˆ·è¿›ç¨‹ã€‚</p><p>é˜¶æ®µä¸€ï¼š</p><ul><li>ç”¨æˆ·è¿›ç¨‹å°è¯•è¯»å–æ•°æ®ï¼ˆæ¯”å¦‚ç½‘å¡æ•°æ®ï¼‰</li><li>æ­¤æ—¶æ•°æ®å°šæœªåˆ°è¾¾ï¼Œå†…æ ¸éœ€è¦ç­‰å¾…æ•°æ®</li><li>è¿”å›å¼‚å¸¸ç»™ç”¨æˆ·è¿›ç¨‹</li><li>ç”¨æˆ·è¿›ç¨‹æ‹¿åˆ°erroråï¼Œå†æ¬¡å°è¯•è¯»å–</li><li>å¾ªç¯å¾€å¤ï¼Œç›´åˆ°æ•°æ®å°±ç»ª</li></ul><p>é˜¶æ®µäºŒï¼š</p><ul><li>å°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>æ‹·è´è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¾ç„¶é˜»å¡ç­‰å¾…</li><li>æ‹·è´å®Œæˆï¼Œç”¨æˆ·è¿›ç¨‹è§£é™¤é˜»å¡ï¼Œå¤„ç†æ•°æ®</li><li>å¯ä»¥çœ‹åˆ°ï¼Œéé˜»å¡IOæ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯éé˜»å¡ï¼Œç¬¬äºŒä¸ªé˜¶æ®µæ˜¯é˜»å¡çŠ¶æ€ã€‚è™½ç„¶æ˜¯éé˜»å¡ï¼Œä½†æ€§èƒ½å¹¶æ²¡æœ‰å¾—åˆ°æé«˜ã€‚è€Œä¸”å¿™ç­‰æœºåˆ¶ä¼šå¯¼è‡´CPUç©ºè½¬ï¼ŒCPUä½¿ç”¨ç‡æš´å¢ã€‚</li></ul><figure><img src="/blog/assets/img/1653897490116.ca0181fa.png" alt="1653897490116" tabindex="0" loading="lazy"><figcaption>1653897490116</figcaption></figure><h3 id="_2-4-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-4-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨"><span>2.4 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨</span></a></h3><p>æ— è®ºæ˜¯é˜»å¡IOè¿˜æ˜¯éé˜»å¡IOï¼Œç”¨æˆ·åº”ç”¨åœ¨ä¸€é˜¶æ®µéƒ½éœ€è¦è°ƒç”¨recvfromæ¥è·å–æ•°æ®ï¼Œå·®åˆ«åœ¨äºæ— æ•°æ®æ—¶çš„å¤„ç†æ–¹æ¡ˆï¼š</p><p>å¦‚æœè°ƒç”¨recvfromæ—¶ï¼Œæ°å¥½æ²¡æœ‰æ•°æ®ï¼Œé˜»å¡IOä¼šä½¿CPUé˜»å¡ï¼Œéé˜»å¡IOä½¿CPUç©ºè½¬ï¼Œéƒ½ä¸èƒ½å……åˆ†å‘æŒ¥CPUçš„ä½œç”¨ã€‚ å¦‚æœè°ƒç”¨recvfromæ—¶ï¼Œæ°å¥½æœ‰æ•°æ®ï¼Œåˆ™ç”¨æˆ·è¿›ç¨‹å¯ä»¥ç›´æ¥è¿›å…¥ç¬¬äºŒé˜¶æ®µï¼Œè¯»å–å¹¶å¤„ç†æ•°æ®</p><p>æ‰€ä»¥æ€ä¹ˆçœ‹èµ·æ¥ä»¥ä¸Šä¸¤ç§æ–¹å¼æ€§èƒ½éƒ½ä¸å¥½</p><p>è€Œåœ¨å•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œåªèƒ½ä¾æ¬¡å¤„ç†IOäº‹ä»¶ï¼Œå¦‚æœæ­£åœ¨å¤„ç†çš„IOäº‹ä»¶æ°å¥½æœªå°±ç»ªï¼ˆæ•°æ®ä¸å¯è¯»æˆ–ä¸å¯å†™ï¼‰ï¼Œçº¿ç¨‹å°±ä¼šè¢«é˜»å¡ï¼Œæ‰€æœ‰IOäº‹ä»¶éƒ½å¿…é¡»ç­‰å¾…ï¼Œæ€§èƒ½è‡ªç„¶ä¼šå¾ˆå·®ã€‚</p><p>å°±æ¯”å¦‚æœåŠ¡å‘˜ç»™é¡¾å®¢ç‚¹é¤ï¼Œ<strong>åˆ†ä¸¤æ­¥</strong>ï¼š</p><ul><li>é¡¾å®¢æ€è€ƒè¦åƒä»€ä¹ˆï¼ˆç­‰å¾…æ•°æ®å°±ç»ªï¼‰</li><li>é¡¾å®¢æƒ³å¥½äº†ï¼Œå¼€å§‹ç‚¹é¤ï¼ˆè¯»å–æ•°æ®ï¼‰</li></ul><p>è¦æé«˜æ•ˆç‡æœ‰å‡ ç§åŠæ³•ï¼Ÿ</p><p>æ–¹æ¡ˆä¸€ï¼šå¢åŠ æ›´å¤šæœåŠ¡å‘˜ï¼ˆå¤šçº¿ç¨‹ï¼‰ æ–¹æ¡ˆäºŒï¼šä¸æ’é˜Ÿï¼Œè°æƒ³å¥½äº†åƒä»€ä¹ˆï¼ˆæ•°æ®å°±ç»ªäº†ï¼‰ï¼ŒæœåŠ¡å‘˜å°±ç»™è°ç‚¹é¤ï¼ˆç”¨æˆ·åº”ç”¨å°±å»è¯»å–æ•°æ®ï¼‰</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šç”¨æˆ·è¿›ç¨‹å¦‚ä½•çŸ¥é“å†…æ ¸ä¸­æ•°æ®æ˜¯å¦å°±ç»ªå‘¢ï¼Ÿ</p><p>æ‰€ä»¥æ¥ä¸‹æ¥å°±éœ€è¦è¯¦ç»†çš„æ¥è§£å†³å¤šè·¯å¤ç”¨æ¨¡å‹æ˜¯å¦‚ä½•çŸ¥é“åˆ°åº•æ€ä¹ˆçŸ¥é“å†…æ ¸æ•°æ®æ˜¯å¦å°±ç»ªçš„é—®é¢˜äº†</p><p>è¿™ä¸ªé—®é¢˜çš„è§£å†³ä¾èµ–äºæå‡ºçš„</p><p>æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰ï¼šç®€ç§°FDï¼Œæ˜¯ä¸€ä¸ªä»0 å¼€å§‹çš„æ— ç¬¦å·æ•´æ•°ï¼Œç”¨æ¥å…³è”Linuxä¸­çš„ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨Linuxä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œä¾‹å¦‚å¸¸è§„æ–‡ä»¶ã€è§†é¢‘ã€ç¡¬ä»¶è®¾å¤‡ç­‰ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ç½‘ç»œå¥—æ¥å­—ï¼ˆSocketï¼‰ã€‚</p><p>é€šè¿‡FDï¼Œæˆ‘ä»¬çš„ç½‘ç»œæ¨¡å‹å¯ä»¥åˆ©ç”¨ä¸€ä¸ªçº¿ç¨‹ç›‘å¬å¤šä¸ªFDï¼Œå¹¶åœ¨æŸä¸ªFDå¯è¯»ã€å¯å†™æ—¶å¾—åˆ°é€šçŸ¥ï¼Œä»è€Œé¿å…æ— æ•ˆçš„ç­‰å¾…ï¼Œå……åˆ†åˆ©ç”¨CPUèµ„æºã€‚</p><p>é˜¶æ®µä¸€ï¼š</p><ul><li>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨selectï¼ŒæŒ‡å®šè¦ç›‘å¬çš„FDé›†åˆ</li><li>æ ¸ç›‘å¬FDå¯¹åº”çš„å¤šä¸ªsocket</li><li>ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªsocketæ•°æ®å°±ç»ªåˆ™è¿”å›readable</li><li>æ­¤è¿‡ç¨‹ä¸­ç”¨æˆ·è¿›ç¨‹é˜»å¡</li></ul><p>é˜¶æ®µäºŒï¼š</p><ul><li>ç”¨æˆ·è¿›ç¨‹æ‰¾åˆ°å°±ç»ªçš„socket</li><li>ä¾æ¬¡è°ƒç”¨recvfromè¯»å–æ•°æ®</li><li>å†…æ ¸å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</li><li>ç”¨æˆ·è¿›ç¨‹å¤„ç†æ•°æ®</li></ul><p>å½“ç”¨æˆ·å»è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸å†å»ç›´æ¥è°ƒç”¨recvfromäº†ï¼Œè€Œæ˜¯è°ƒç”¨selectçš„å‡½æ•°ï¼Œselectå‡½æ•°ä¼šå°†éœ€è¦ç›‘å¬çš„æ•°æ®äº¤ç»™å†…æ ¸ï¼Œç”±å†…æ ¸å»æ£€æŸ¥è¿™äº›æ•°æ®æ˜¯å¦å°±ç»ªäº†ï¼Œå¦‚æœè¯´è¿™ä¸ªæ•°æ®å°±ç»ªäº†ï¼Œå°±ä¼šé€šçŸ¥åº”ç”¨ç¨‹åºæ•°æ®å°±ç»ªï¼Œç„¶åæ¥è¯»å–æ•°æ®ï¼Œå†ä»å†…æ ¸ä¸­æŠŠæ•°æ®æ‹·è´ç»™ç”¨æˆ·æ€ï¼Œå®Œæˆæ•°æ®å¤„ç†ï¼Œå¦‚æœNå¤šä¸ªFDä¸€ä¸ªéƒ½æ²¡å¤„ç†å®Œï¼Œæ­¤æ—¶å°±è¿›è¡Œç­‰å¾…ã€‚</p><p>ç”¨IOå¤ç”¨æ¨¡å¼ï¼Œå¯ä»¥ç¡®ä¿å»è¯»æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®æ˜¯ä¸€å®šå­˜åœ¨çš„ï¼Œä»–çš„æ•ˆç‡æ¯”åŸæ¥çš„é˜»å¡IOå’Œéé˜»å¡IOæ€§èƒ½éƒ½è¦é«˜</p><figure><img src="/blog/assets/img/1653898691736.37a22eca.png" alt="1653898691736" tabindex="0" loading="lazy"><figcaption>1653898691736</figcaption></figure><p>IOå¤šè·¯å¤ç”¨æ˜¯åˆ©ç”¨å•ä¸ªçº¿ç¨‹æ¥åŒæ—¶ç›‘å¬å¤šä¸ªFDï¼Œå¹¶åœ¨æŸä¸ªFDå¯è¯»ã€å¯å†™æ—¶å¾—åˆ°é€šçŸ¥ï¼Œä»è€Œé¿å…æ— æ•ˆçš„ç­‰å¾…ï¼Œå……åˆ†åˆ©ç”¨CPUèµ„æºã€‚ä¸è¿‡ç›‘å¬FDçš„æ–¹å¼ã€é€šçŸ¥çš„æ–¹å¼åˆæœ‰å¤šç§å®ç°ï¼Œå¸¸è§çš„æœ‰ï¼š</p><ul><li>select</li><li>poll</li><li>epoll</li></ul><p>å…¶ä¸­selectå’Œpoolç›¸å½“äºæ˜¯å½“è¢«ç›‘å¬çš„æ•°æ®å‡†å¤‡å¥½ä¹‹åï¼Œä»–ä¼šæŠŠä½ ç›‘å¬çš„FDæ•´ä¸ªæ•°æ®éƒ½å‘ç»™ä½ ï¼Œä½ éœ€è¦åˆ°æ•´ä¸ªFDä¸­å»æ‰¾ï¼Œå“ªäº›æ˜¯å¤„ç†å¥½äº†çš„ï¼Œéœ€è¦é€šè¿‡éå†çš„æ–¹å¼ï¼Œæ‰€ä»¥æ€§èƒ½ä¹Ÿå¹¶ä¸æ˜¯é‚£ä¹ˆå¥½</p><p>è€Œepollï¼Œåˆ™ç›¸å½“äºå†…æ ¸å‡†å¤‡å¥½äº†ä¹‹åï¼Œä»–ä¼šæŠŠå‡†å¤‡å¥½çš„æ•°æ®ï¼Œç›´æ¥å‘ç»™ä½ ï¼Œå’±ä»¬å°±çœå»äº†éå†çš„åŠ¨ä½œã€‚</p><h3 id="_2-5-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨-selectæ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_2-5-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨-selectæ–¹å¼"><span>2.5 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨-selectæ–¹å¼</span></a></h3><p>selectæ˜¯Linuxæœ€æ—©æ˜¯ç”±çš„I/Oå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼š</p><p>ç®€å•è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬æŠŠéœ€è¦å¤„ç†çš„æ•°æ®å°è£…æˆFDï¼Œç„¶ååœ¨ç”¨æˆ·æ€æ—¶åˆ›å»ºä¸€ä¸ªfdçš„é›†åˆï¼ˆè¿™ä¸ªé›†åˆçš„å¤§å°æ˜¯è¦ç›‘å¬çš„é‚£ä¸ªFDçš„æœ€å¤§å€¼+1ï¼Œä½†æ˜¯å¤§å°æ•´ä½“æ˜¯æœ‰é™åˆ¶çš„ ï¼‰ï¼Œè¿™ä¸ªé›†åˆçš„é•¿åº¦å¤§å°æ˜¯æœ‰é™åˆ¶çš„ï¼ŒåŒæ—¶åœ¨è¿™ä¸ªé›†åˆä¸­ï¼Œæ ‡æ˜å‡ºæ¥æˆ‘ä»¬è¦æ§åˆ¶å“ªäº›æ•°æ®ï¼Œ</p><p>æ¯”å¦‚è¦ç›‘å¬çš„æ•°æ®ï¼Œæ˜¯1,2,5ä¸‰ä¸ªæ•°æ®ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œselectå‡½æ•°ï¼Œç„¶åå°†æ•´ä¸ªfdå‘ç»™å†…æ ¸æ€ï¼Œå†…æ ¸æ€ä¼šå»éå†ç”¨æˆ·æ€ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œå¦‚æœå‘ç°è¿™é‡Œè¾¹éƒ½æ•°æ®éƒ½æ²¡æœ‰å°±ç»ªï¼Œå°±ä¼‘çœ ï¼Œç›´åˆ°æœ‰æ•°æ®å‡†å¤‡å¥½æ—¶ï¼Œå°±ä¼šè¢«å”¤é†’ï¼Œå”¤é†’ä¹‹åï¼Œå†æ¬¡éå†ä¸€éï¼Œçœ‹çœ‹è°å‡†å¤‡å¥½äº†ï¼Œç„¶åå†å°†å¤„ç†æ‰æ²¡æœ‰å‡†å¤‡å¥½çš„æ•°æ®ï¼Œæœ€åå†å°†è¿™ä¸ªFDé›†åˆå†™å›åˆ°ç”¨æˆ·æ€ä¸­å»ï¼Œæ­¤æ—¶ç”¨æˆ·æ€å°±çŸ¥é“äº†ï¼Œå¥¥ï¼Œæœ‰äººå‡†å¤‡å¥½äº†ï¼Œä½†æ˜¯å¯¹äºç”¨æˆ·æ€è€Œè¨€ï¼Œå¹¶ä¸çŸ¥é“è°å¤„ç†å¥½äº†ï¼Œæ‰€ä»¥ç”¨æˆ·æ€ä¹Ÿéœ€è¦å»è¿›è¡Œéå†ï¼Œç„¶åæ‰¾åˆ°å¯¹åº”å‡†å¤‡å¥½æ•°æ®çš„èŠ‚ç‚¹ï¼Œå†å»å‘èµ·è¯»è¯·æ±‚ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ç§æ¨¡å¼ä¸‹ä»–è™½ç„¶æ¯”é˜»å¡IOå’Œéé˜»å¡IOå¥½ï¼Œä½†æ˜¯ä¾ç„¶æœ‰äº›éº»çƒ¦çš„äº‹æƒ…ï¼Œ æ¯”å¦‚è¯´é¢‘ç¹çš„ä¼ é€’fdé›†åˆï¼Œé¢‘ç¹çš„å»éå†FDç­‰é—®é¢˜</p><figure><img src="/blog/assets/img/1653900022580.b9c24479.png" alt="1653900022580" tabindex="0" loading="lazy"><figcaption>1653900022580</figcaption></figure><h3 id="_2-6-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-pollæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_2-6-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-pollæ¨¡å¼"><span>2.6 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨æ¨¡å‹-pollæ¨¡å¼</span></a></h3><p>pollæ¨¡å¼å¯¹selectæ¨¡å¼åšäº†ç®€å•æ”¹è¿›ï¼Œä½†æ€§èƒ½æå‡ä¸æ˜æ˜¾ï¼Œéƒ¨åˆ†å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><p>IOæµç¨‹ï¼š</p><ul><li>åˆ›å»ºpollfdæ•°ç»„ï¼Œå‘å…¶ä¸­æ·»åŠ å…³æ³¨çš„fdä¿¡æ¯ï¼Œæ•°ç»„å¤§å°è‡ªå®šä¹‰</li><li>è°ƒç”¨pollå‡½æ•°ï¼Œå°†pollfdæ•°ç»„æ‹·è´åˆ°å†…æ ¸ç©ºé—´ï¼Œè½¬é“¾è¡¨å­˜å‚¨ï¼Œæ— ä¸Šé™</li><li>å†…æ ¸éå†fdï¼Œåˆ¤æ–­æ˜¯å¦å°±ç»ª</li><li>æ•°æ®å°±ç»ªæˆ–è¶…æ—¶åï¼Œæ‹·è´pollfdæ•°ç»„åˆ°ç”¨æˆ·ç©ºé—´ï¼Œè¿”å›å°±ç»ªfdæ•°é‡n</li><li>ç”¨æˆ·è¿›ç¨‹åˆ¤æ–­næ˜¯å¦å¤§äº0,å¤§äº0åˆ™éå†pollfdæ•°ç»„ï¼Œæ‰¾åˆ°å°±ç»ªçš„fd</li></ul><p><strong>ä¸selectå¯¹æ¯”ï¼š</strong></p><ul><li>selectæ¨¡å¼ä¸­çš„fd_setå¤§å°å›ºå®šä¸º1024ï¼Œè€Œpollfdåœ¨å†…æ ¸ä¸­é‡‡ç”¨é“¾è¡¨ï¼Œç†è®ºä¸Šæ— ä¸Šé™</li><li>ç›‘å¬FDè¶Šå¤šï¼Œæ¯æ¬¡éå†æ¶ˆè€—æ—¶é—´ä¹Ÿè¶Šä¹…ï¼Œæ€§èƒ½åè€Œä¼šä¸‹é™</li></ul><figure><img src="/blog/assets/img/1653900721427.d34cfb25.png" alt="1653900721427" tabindex="0" loading="lazy"><figcaption>1653900721427</figcaption></figure><h3 id="_2-7-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-epollå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_2-7-ç½‘ç»œæ¨¡å‹-ioå¤šè·¯å¤ç”¨æ¨¡å‹-epollå‡½æ•°"><span>2.7 ç½‘ç»œæ¨¡å‹-IOå¤šè·¯å¤ç”¨æ¨¡å‹-epollå‡½æ•°</span></a></h3><p>epollæ¨¡å¼æ˜¯å¯¹selectå’Œpollçš„æ”¹è¿›ï¼Œå®ƒæä¾›äº†ä¸‰ä¸ªå‡½æ•°ï¼š</p><p>ç¬¬ä¸€ä¸ªæ˜¯ï¼ševentpollçš„å‡½æ•°ï¼Œä»–å†…éƒ¨åŒ…å«ä¸¤ä¸ªä¸œè¥¿</p><p>ä¸€ä¸ªæ˜¯ï¼š</p><p>1ã€çº¢é»‘æ ‘-&gt; è®°å½•çš„äº‹è¦ç›‘å¬çš„FD</p><p>2ã€ä¸€ä¸ªæ˜¯é“¾è¡¨-&gt;ä¸€ä¸ªé“¾è¡¨ï¼Œè®°å½•çš„æ˜¯å°±ç»ªçš„FD</p><p>ç´§æ¥ç€è°ƒç”¨epoll_ctlæ“ä½œï¼Œå°†è¦ç›‘å¬çš„æ•°æ®æ·»åŠ åˆ°çº¢é»‘æ ‘ä¸Šå»ï¼Œå¹¶ä¸”ç»™æ¯ä¸ªfdè®¾ç½®ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨fdæ•°æ®å°±ç»ªæ—¶è§¦å‘ï¼Œå°±æ˜¯å‡†å¤‡å¥½äº†ï¼Œç°åœ¨å°±æŠŠfdæŠŠæ•°æ®æ·»åŠ åˆ°list_headä¸­å»</p><p>3ã€è°ƒç”¨epoll_waitå‡½æ•°</p><p>å°±å»ç­‰å¾…ï¼Œåœ¨ç”¨æˆ·æ€åˆ›å»ºä¸€ä¸ªç©ºçš„eventsæ•°ç»„ï¼Œå½“å°±ç»ªä¹‹åï¼Œæˆ‘ä»¬çš„å›è°ƒå‡½æ•°ä¼šæŠŠæ•°æ®æ·»åŠ åˆ°list_headä¸­å»ï¼Œå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå»æ£€æŸ¥list_headï¼Œå½“ç„¶è¿™ä¸ªè¿‡ç¨‹éœ€è¦å‚è€ƒé…ç½®çš„ç­‰å¾…æ—¶é—´ï¼Œå¯ä»¥ç­‰ä¸€å®šæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä¸€ç›´ç­‰ï¼Œ å¦‚æœåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ£€æŸ¥åˆ°äº†list_headä¸­æœ‰æ•°æ®ä¼šå°†æ•°æ®æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œæ­¤æ—¶å°†æ•°æ®æ”¾å…¥åˆ°eventsæ•°ç»„ä¸­ï¼Œå¹¶ä¸”è¿”å›å¯¹åº”çš„æ“ä½œçš„æ•°é‡ï¼Œç”¨æˆ·æ€çš„æ­¤æ—¶æ”¶åˆ°å“åº”åï¼Œä»eventsä¸­æ‹¿åˆ°å¯¹åº”å‡†å¤‡å¥½çš„æ•°æ®çš„èŠ‚ç‚¹ï¼Œå†å»è°ƒç”¨æ–¹æ³•å»æ‹¿æ•°æ®ã€‚</p><p>å°æ€»ç»“ï¼š</p><p>selectæ¨¡å¼å­˜åœ¨çš„ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li>èƒ½ç›‘å¬çš„FDæœ€å¤§ä¸è¶…è¿‡1024</li><li>æ¯æ¬¡selectéƒ½éœ€è¦æŠŠæ‰€æœ‰è¦ç›‘å¬çš„FDéƒ½æ‹·è´åˆ°å†…æ ¸ç©ºé—´</li><li>æ¯æ¬¡éƒ½è¦éå†æ‰€æœ‰FDæ¥åˆ¤æ–­å°±ç»ªçŠ¶æ€</li></ul><p>pollæ¨¡å¼çš„é—®é¢˜ï¼š</p><ul><li>pollåˆ©ç”¨é“¾è¡¨è§£å†³äº†selectä¸­ç›‘å¬FDä¸Šé™çš„é—®é¢˜ï¼Œä½†ä¾ç„¶è¦éå†æ‰€æœ‰FDï¼Œå¦‚æœç›‘å¬è¾ƒå¤šï¼Œæ€§èƒ½ä¼šä¸‹é™</li></ul><p>epollæ¨¡å¼ä¸­å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ</p><ul><li>åŸºäºepollå®ä¾‹ä¸­çš„çº¢é»‘æ ‘ä¿å­˜è¦ç›‘å¬çš„FDï¼Œç†è®ºä¸Šæ— ä¸Šé™ï¼Œè€Œä¸”å¢åˆ æ”¹æŸ¥æ•ˆç‡éƒ½éå¸¸é«˜</li><li>æ¯ä¸ªFDåªéœ€è¦æ‰§è¡Œä¸€æ¬¡epoll_ctlæ·»åŠ åˆ°çº¢é»‘æ ‘ï¼Œä»¥åæ¯æ¬¡epol_waitæ— éœ€ä¼ é€’ä»»ä½•å‚æ•°ï¼Œæ— éœ€é‡å¤æ‹·è´FDåˆ°å†…æ ¸ç©ºé—´</li><li>åˆ©ç”¨ep_poll_callbackæœºåˆ¶æ¥ç›‘å¬FDçŠ¶æ€ï¼Œæ— éœ€éå†æ‰€æœ‰FDï¼Œå› æ­¤æ€§èƒ½ä¸ä¼šéšç›‘å¬çš„FDæ•°é‡å¢å¤šè€Œä¸‹é™</li></ul><h3 id="_2-8ã€ç½‘ç»œæ¨¡å‹-epollä¸­çš„etå’Œlt" tabindex="-1"><a class="header-anchor" href="#_2-8ã€ç½‘ç»œæ¨¡å‹-epollä¸­çš„etå’Œlt"><span>2.8ã€ç½‘ç»œæ¨¡å‹-epollä¸­çš„ETå’ŒLT</span></a></h3><p>å½“FDæœ‰æ•°æ®å¯è¯»æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨epoll_waitï¼ˆæˆ–è€…selectã€pollï¼‰å¯ä»¥å¾—åˆ°é€šçŸ¥ã€‚ä½†æ˜¯äº‹ä»¶é€šçŸ¥çš„æ¨¡å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>LevelTriggeredï¼šç®€ç§°LTï¼Œä¹Ÿå«åšæ°´å¹³è§¦å‘ã€‚åªè¦æŸä¸ªFDä¸­æœ‰æ•°æ®å¯è¯»ï¼Œæ¯æ¬¡è°ƒç”¨epoll_waitéƒ½ä¼šå¾—åˆ°é€šçŸ¥ã€‚</li><li>EdgeTriggeredï¼šç®€ç§°ETï¼Œä¹Ÿå«åšè¾¹æ²¿è§¦å‘ã€‚åªæœ‰åœ¨æŸä¸ªFDæœ‰çŠ¶æ€å˜åŒ–æ—¶ï¼Œè°ƒç”¨epoll_waitæ‰ä¼šè¢«é€šçŸ¥ã€‚</li></ul><p>ä¸¾ä¸ªæ —å­ï¼š</p><ul><li>å‡è®¾ä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹åº”çš„FDå·²ç»æ³¨å†Œåˆ°äº†epollå®ä¾‹ä¸­</li><li>å®¢æˆ·ç«¯socketå‘é€äº†2kbçš„æ•°æ®</li><li>æœåŠ¡ç«¯è°ƒç”¨epoll_waitï¼Œå¾—åˆ°é€šçŸ¥è¯´FDå°±ç»ª</li><li>æœåŠ¡ç«¯ä»FDè¯»å–äº†1kbæ•°æ®å›åˆ°æ­¥éª¤3ï¼ˆå†æ¬¡è°ƒç”¨epoll_waitï¼Œå½¢æˆå¾ªç¯ï¼‰</li></ul><p>ç»“è®º</p><p>å¦‚æœæˆ‘ä»¬é‡‡ç”¨LTæ¨¡å¼ï¼Œå› ä¸ºFDä¸­ä»æœ‰1kbæ•°æ®ï¼Œåˆ™ç¬¬â‘¤æ­¥ä¾ç„¶ä¼šè¿”å›ç»“æœï¼Œå¹¶ä¸”å¾—åˆ°é€šçŸ¥ å¦‚æœæˆ‘ä»¬é‡‡ç”¨ETæ¨¡å¼ï¼Œå› ä¸ºç¬¬â‘¢æ­¥å·²ç»æ¶ˆè´¹äº†FDå¯è¯»äº‹ä»¶ï¼Œç¬¬â‘¤æ­¥FDçŠ¶æ€æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤epoll_waitä¸ä¼šè¿”å›ï¼Œæ•°æ®æ— æ³•è¯»å–ï¼Œå®¢æˆ·ç«¯å“åº”è¶…æ—¶ã€‚</p><h3 id="_2-9-ç½‘ç»œæ¨¡å‹-åŸºäºepollçš„æœåŠ¡å™¨ç«¯æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-9-ç½‘ç»œæ¨¡å‹-åŸºäºepollçš„æœåŠ¡å™¨ç«¯æµç¨‹"><span>2.9 ç½‘ç»œæ¨¡å‹-åŸºäºepollçš„æœåŠ¡å™¨ç«¯æµç¨‹</span></a></h3><p>æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹è¿™å¼ å›¾</p><p>æœåŠ¡å™¨å¯åŠ¨ä»¥åï¼ŒæœåŠ¡ç«¯ä¼šå»è°ƒç”¨epoll_createï¼Œåˆ›å»ºä¸€ä¸ªepollå®ä¾‹ï¼Œepollå®ä¾‹ä¸­åŒ…å«ä¸¤ä¸ªæ•°æ®</p><p>1ã€çº¢é»‘æ ‘ï¼ˆä¸ºç©ºï¼‰ï¼šrb_root ç”¨æ¥å»è®°å½•éœ€è¦è¢«ç›‘å¬çš„FD</p><p>2ã€é“¾è¡¨ï¼ˆä¸ºç©ºï¼‰ï¼šlist_headï¼Œç”¨æ¥å­˜æ”¾å·²ç»å°±ç»ªçš„FD</p><p>åˆ›å»ºå¥½äº†ä¹‹åï¼Œä¼šå»è°ƒç”¨epoll_ctlå‡½æ•°ï¼Œæ­¤å‡½æ•°ä¼šä¼šå°†éœ€è¦ç›‘å¬çš„æ•°æ®æ·»åŠ åˆ°rb_rootä¸­å»ï¼Œå¹¶ä¸”å¯¹å½“å‰è¿™äº›å­˜åœ¨äºçº¢é»‘æ ‘çš„èŠ‚ç‚¹è®¾ç½®å›è°ƒå‡½æ•°ï¼Œå½“è¿™äº›è¢«ç›‘å¬çš„æ•°æ®ä¸€æ—¦å‡†å¤‡å®Œæˆï¼Œå°±ä¼šè¢«è°ƒç”¨ï¼Œè€Œè°ƒç”¨çš„ç»“æœå°±æ˜¯å°†çº¢é»‘æ ‘çš„fdæ·»åŠ åˆ°list_headä¸­å»(ä½†æ˜¯æ­¤æ—¶å¹¶æ²¡æœ‰å®Œæˆ)</p><p>3ã€å½“ç¬¬äºŒæ­¥å®Œæˆåï¼Œå°±ä¼šè°ƒç”¨epoll_waitå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå»æ ¡éªŒæ˜¯å¦æœ‰æ•°æ®å‡†å¤‡å®Œæ¯•ï¼ˆå› ä¸ºæ•°æ®ä¸€æ—¦å‡†å¤‡å°±ç»ªï¼Œå°±ä¼šè¢«å›è°ƒå‡½æ•°æ·»åŠ åˆ°list_headä¸­ï¼‰ï¼Œåœ¨ç­‰å¾…äº†ä¸€æ®µæ—¶é—´å(å¯ä»¥è¿›è¡Œé…ç½®)ï¼Œå¦‚æœç­‰å¤Ÿäº†è¶…æ—¶æ—¶é—´ï¼Œåˆ™è¿”å›æ²¡æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿›ä¸€æ­¥åˆ¤æ–­å½“å‰æ˜¯ä»€ä¹ˆäº‹ä»¶ï¼Œå¦‚æœæ˜¯å»ºç«‹è¿æ¥æ—¶é—´ï¼Œåˆ™è°ƒç”¨accept() æ¥å—å®¢æˆ·ç«¯socketï¼Œæ‹¿åˆ°å»ºç«‹è¿æ¥çš„socketï¼Œç„¶åå»ºç«‹èµ·æ¥è¿æ¥ï¼Œå¦‚æœæ˜¯å…¶ä»–äº‹ä»¶ï¼Œåˆ™æŠŠæ•°æ®è¿›è¡Œå†™å‡º</p><figure><img src="/blog/assets/img/1653902845082.2f7255b2.png" alt="1653902845082" tabindex="0" loading="lazy"><figcaption>1653902845082</figcaption></figure><h3 id="_3-0-ã€ç½‘ç»œæ¨¡å‹-ä¿¡å·é©±åŠ¨" tabindex="-1"><a class="header-anchor" href="#_3-0-ã€ç½‘ç»œæ¨¡å‹-ä¿¡å·é©±åŠ¨"><span>3.0 ã€ç½‘ç»œæ¨¡å‹-ä¿¡å·é©±åŠ¨</span></a></h3><p>ä¿¡å·é©±åŠ¨IOæ˜¯ä¸å†…æ ¸å»ºç«‹SIGIOçš„ä¿¡å·å…³è”å¹¶è®¾ç½®å›è°ƒï¼Œå½“å†…æ ¸æœ‰FDå°±ç»ªæ—¶ï¼Œä¼šå‘å‡ºSIGIOä¿¡å·é€šçŸ¥ç”¨æˆ·ï¼ŒæœŸé—´ç”¨æˆ·åº”ç”¨å¯ä»¥æ‰§è¡Œå…¶å®ƒä¸šåŠ¡ï¼Œæ— éœ€é˜»å¡ç­‰å¾…ã€‚</p><p>é˜¶æ®µä¸€ï¼š</p><ul><li>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨sigactionï¼Œæ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°</li><li>å†…æ ¸è¿”å›æˆåŠŸï¼Œå¼€å§‹ç›‘å¬FD</li><li>ç”¨æˆ·è¿›ç¨‹ä¸é˜»å¡ç­‰å¾…ï¼Œå¯ä»¥æ‰§è¡Œå…¶å®ƒä¸šåŠ¡</li><li>å½“å†…æ ¸æ•°æ®å°±ç»ªåï¼Œå›è°ƒç”¨æˆ·è¿›ç¨‹çš„SIGIOå¤„ç†å‡½æ•°</li></ul><p>é˜¶æ®µäºŒï¼š</p><ul><li>æ”¶åˆ°SIGIOå›è°ƒä¿¡å·</li><li>è°ƒç”¨recvfromï¼Œè¯»å–</li><li>å†…æ ¸å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</li><li>ç”¨æˆ·è¿›ç¨‹å¤„ç†æ•°æ®</li></ul><figure><img src="/blog/assets/img/1653911776583.11c3b647.png" alt="1653911776583" tabindex="0" loading="lazy"><figcaption>1653911776583</figcaption></figure><p>å½“æœ‰å¤§é‡IOæ“ä½œæ—¶ï¼Œä¿¡å·è¾ƒå¤šï¼ŒSIGIOå¤„ç†å‡½æ•°ä¸èƒ½åŠæ—¶å¤„ç†å¯èƒ½å¯¼è‡´ä¿¡å·é˜Ÿåˆ—æº¢å‡ºï¼Œè€Œä¸”å†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´çš„é¢‘ç¹ä¿¡å·äº¤äº’æ€§èƒ½ä¹Ÿè¾ƒä½ã€‚</p><h4 id="_3-0-1-å¼‚æ­¥io" tabindex="-1"><a class="header-anchor" href="#_3-0-1-å¼‚æ­¥io"><span>3.0.1 å¼‚æ­¥IO</span></a></h4><p>è¿™ç§æ–¹å¼ï¼Œä¸ä»…ä»…æ˜¯ç”¨æˆ·æ€åœ¨è¯•å›¾è¯»å–æ•°æ®åï¼Œä¸é˜»å¡ï¼Œè€Œä¸”å½“å†…æ ¸çš„æ•°æ®å‡†å¤‡å®Œæˆåï¼Œä¹Ÿä¸ä¼šé˜»å¡</p><p>ä»–ä¼šç”±å†…æ ¸å°†æ‰€æœ‰æ•°æ®å¤„ç†å®Œæˆåï¼Œç”±å†…æ ¸å°†æ•°æ®å†™å…¥åˆ°ç”¨æˆ·æ€ä¸­ï¼Œç„¶åæ‰ç®—å®Œæˆï¼Œæ‰€ä»¥æ€§èƒ½æé«˜ï¼Œä¸ä¼šæœ‰ä»»ä½•é˜»å¡ï¼Œå…¨éƒ¨éƒ½ç”±å†…æ ¸å®Œæˆï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¼‚æ­¥IOæ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹åœ¨ä¸¤ä¸ªé˜¶æ®µéƒ½æ˜¯éé˜»å¡çŠ¶æ€ã€‚</p><figure><img src="/blog/assets/img/1653911877542.ee656119.png" alt="1653911877542" tabindex="0" loading="lazy"><figcaption>1653911877542</figcaption></figure><h4 id="_3-0-2-å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_3-0-2-å¯¹æ¯”"><span>3.0.2 å¯¹æ¯”</span></a></h4><p>æœ€åç”¨ä¸€å¹…å›¾ï¼Œæ¥è¯´æ˜ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«</p><figure><img src="/blog/assets/img/1653912219712.aa8653f7.png" alt="1653912219712" tabindex="0" loading="lazy"><figcaption>1653912219712</figcaption></figure><h3 id="_3-1-ã€ç½‘ç»œæ¨¡å‹-redisæ˜¯å•çº¿ç¨‹çš„å—-ä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-1-ã€ç½‘ç»œæ¨¡å‹-redisæ˜¯å•çº¿ç¨‹çš„å—-ä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹"><span>3.1 ã€ç½‘ç»œæ¨¡å‹-Redisæ˜¯å•çº¿ç¨‹çš„å—ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹</span></a></h3><p><strong>Redisåˆ°åº•æ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ</strong></p><ul><li>å¦‚æœä»…ä»…èŠRedisçš„æ ¸å¿ƒä¸šåŠ¡éƒ¨åˆ†ï¼ˆå‘½ä»¤å¤„ç†ï¼‰ï¼Œç­”æ¡ˆæ˜¯å•çº¿ç¨‹</li><li>å¦‚æœæ˜¯èŠæ•´ä¸ªRedisï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯å¤šçº¿ç¨‹</li></ul><p>åœ¨Redisç‰ˆæœ¬è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåœ¨ä¸¤ä¸ªé‡è¦çš„æ—¶é—´èŠ‚ç‚¹ä¸Šå¼•å…¥äº†å¤šçº¿ç¨‹çš„æ”¯æŒï¼š</p><ul><li>Redis v4.0ï¼šå¼•å…¥å¤šçº¿ç¨‹å¼‚æ­¥å¤„ç†ä¸€äº›è€—æ—¶è¾ƒæ—§çš„ä»»åŠ¡ï¼Œä¾‹å¦‚å¼‚æ­¥åˆ é™¤å‘½ä»¤unlink</li><li>Redis v6.0ï¼šåœ¨æ ¸å¿ƒç½‘ç»œæ¨¡å‹ä¸­å¼•å…¥ å¤šçº¿ç¨‹ï¼Œè¿›ä¸€æ­¥æé«˜å¯¹äºå¤šæ ¸CPUçš„åˆ©ç”¨ç‡</li></ul><p>å› æ­¤ï¼Œå¯¹äºRedisçš„æ ¸å¿ƒç½‘ç»œæ¨¡å‹ï¼Œåœ¨Redis 6.0ä¹‹å‰ç¡®å®éƒ½æ˜¯å•çº¿ç¨‹ã€‚æ˜¯åˆ©ç”¨epollï¼ˆLinuxç³»ç»Ÿï¼‰è¿™æ ·çš„IOå¤šè·¯å¤ç”¨æŠ€æœ¯åœ¨äº‹ä»¶å¾ªç¯ä¸­ä¸æ–­å¤„ç†å®¢æˆ·ç«¯æƒ…å†µã€‚</p><p><strong>ä¸ºä»€ä¹ˆRedisè¦é€‰æ‹©å•çº¿ç¨‹ï¼Ÿ</strong></p><ul><li>æŠ›å¼€æŒä¹…åŒ–ä¸è°ˆï¼ŒRedisæ˜¯çº¯ å†…å­˜æ“ä½œï¼Œæ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ï¼Œå®ƒçš„æ€§èƒ½ç“¶é¢ˆæ˜¯ç½‘ç»œå»¶è¿Ÿè€Œä¸æ˜¯æ‰§è¡Œé€Ÿåº¦ï¼Œå› æ­¤å¤šçº¿ç¨‹å¹¶ä¸ä¼šå¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡ã€‚</li><li>å¤šçº¿ç¨‹ä¼šå¯¼è‡´è¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å¼€é”€</li><li>å¼•å…¥å¤šçº¿ç¨‹ä¼šé¢ä¸´çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå¿…ç„¶è¦å¼•å…¥çº¿ç¨‹é”è¿™æ ·çš„å®‰å…¨æ‰‹æ®µï¼Œå®ç°å¤æ‚åº¦å¢é«˜ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿä¼šå¤§æ‰“æŠ˜æ‰£</li></ul><h3 id="_3-2-ã€redisçš„å•çº¿ç¨‹æ¨¡å‹-rediså•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç½‘ç»œæ¨¡å‹å˜æ›´" tabindex="-1"><a class="header-anchor" href="#_3-2-ã€redisçš„å•çº¿ç¨‹æ¨¡å‹-rediså•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç½‘ç»œæ¨¡å‹å˜æ›´"><span>3.2 ã€Redisçš„å•çº¿ç¨‹æ¨¡å‹-Rediså•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç½‘ç»œæ¨¡å‹å˜æ›´</span></a></h3><figure><img src="/blog/assets/img/1653982278727.951e9683.png" alt="1653982278727" tabindex="0" loading="lazy"><figcaption>1653982278727</figcaption></figure><p>å½“æˆ‘ä»¬çš„å®¢æˆ·ç«¯æƒ³è¦å»è¿æ¥æˆ‘ä»¬æœåŠ¡å™¨ï¼Œä¼šå»å…ˆåˆ°IOå¤šè·¯å¤ç”¨æ¨¡å‹å»è¿›è¡Œæ’é˜Ÿï¼Œä¼šæœ‰ä¸€ä¸ªè¿æ¥åº”ç­”å¤„ç†å™¨ï¼Œä»–ä¼šå»æ¥å—è¯»è¯·æ±‚ï¼Œç„¶ååˆæŠŠè¯»è¯·æ±‚æ³¨å†Œåˆ°å…·ä½“æ¨¡å‹ä¸­å»ï¼Œæ­¤æ—¶è¿™äº›å»ºç«‹èµ·æ¥çš„è¿æ¥ï¼Œå¦‚æœæ˜¯å®¢æˆ·ç«¯è¯·æ±‚å¤„ç†å™¨å»è¿›è¡Œæ‰§è¡Œå‘½ä»¤æ—¶ï¼Œä»–ä¼šå»æŠŠæ•°æ®è¯»å–å‡ºæ¥ï¼Œç„¶åæŠŠæ•°æ®æ”¾å…¥åˆ°clientä¸­ï¼Œ clinetå»è§£æå½“å‰çš„å‘½ä»¤è½¬åŒ–ä¸ºredisè®¤è¯†çš„å‘½ä»¤ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹å¤„ç†è¿™äº›å‘½ä»¤ï¼Œä»redisä¸­çš„commandä¸­æ‰¾åˆ°è¿™äº›å‘½ä»¤ï¼Œç„¶åå°±çœŸæ­£çš„å»æ“ä½œå¯¹åº”çš„æ•°æ®äº†ï¼Œå½“æ•°æ®æ“ä½œå®Œæˆåï¼Œä¼šå»æ‰¾åˆ°å‘½ä»¤å›å¤å¤„ç†å™¨ï¼Œå†ç”±ä»–å°†æ•°æ®å†™å‡ºã€‚</p><h2 id="_3ã€redisé€šä¿¡åè®®-respåè®®" tabindex="-1"><a class="header-anchor" href="#_3ã€redisé€šä¿¡åè®®-respåè®®"><span>3ã€Redisé€šä¿¡åè®®-RESPåè®®</span></a></h2><p>Redisæ˜¯ä¸€ä¸ªCSæ¶æ„çš„è½¯ä»¶ï¼Œé€šä¿¡ä¸€èˆ¬åˆ†ä¸¤æ­¥ï¼ˆä¸åŒ…æ‹¬pipelineå’ŒPubSubï¼‰ï¼š</p><p>å®¢æˆ·ç«¯ï¼ˆclientï¼‰å‘æœåŠ¡ç«¯ï¼ˆserverï¼‰å‘é€ä¸€æ¡å‘½ä»¤</p><p>æœåŠ¡ç«¯è§£æå¹¶æ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›å“åº”ç»“æœç»™å®¢æˆ·ç«¯</p><p>å› æ­¤å®¢æˆ·ç«¯å‘é€å‘½ä»¤çš„æ ¼å¼ã€æœåŠ¡ç«¯å“åº”ç»“æœçš„æ ¼å¼å¿…é¡»æœ‰ä¸€ä¸ªè§„èŒƒï¼Œè¿™ä¸ªè§„èŒƒå°±æ˜¯é€šä¿¡åè®®ã€‚</p><p>è€Œåœ¨Redisä¸­é‡‡ç”¨çš„æ˜¯RESPï¼ˆRedis Serialization Protocolï¼‰åè®®ï¼š</p><p>Redis 1.2ç‰ˆæœ¬å¼•å…¥äº†RESPåè®®</p><p>Redis 2.0ç‰ˆæœ¬ä¸­æˆä¸ºä¸RedisæœåŠ¡ç«¯é€šä¿¡çš„æ ‡å‡†ï¼Œç§°ä¸ºRESP2</p><p>Redis 6.0ç‰ˆæœ¬ä¸­ï¼Œä»RESP2å‡çº§åˆ°äº†RESP3åè®®ï¼Œå¢åŠ äº†æ›´å¤šæ•°æ®ç±»å‹å¹¶ä¸”æ”¯æŒ6.0çš„æ–°ç‰¹æ€§--å®¢æˆ·ç«¯ç¼“å­˜</p><p>ä½†ç›®å‰ï¼Œé»˜è®¤ä½¿ç”¨çš„ä¾ç„¶æ˜¯RESP2åè®®ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è¦å­¦ä¹ çš„åè®®ç‰ˆæœ¬ï¼ˆä»¥ä¸‹ç®€ç§°RESPï¼‰ã€‚</p><p>åœ¨RESPä¸­ï¼Œé€šè¿‡é¦–å­—èŠ‚çš„å­—ç¬¦æ¥åŒºåˆ†ä¸åŒæ•°æ®ç±»å‹ï¼Œå¸¸ç”¨çš„æ•°æ®ç±»å‹åŒ…æ‹¬5ç§ï¼š</p><p>å•è¡Œå­—ç¬¦ä¸²ï¼šé¦–å­—èŠ‚æ˜¯ â€˜+â€™ ï¼Œåé¢è·Ÿä¸Šå•è¡Œå­—ç¬¦ä¸²ï¼Œä»¥CRLFï¼ˆ &quot;\r\n&quot; ï¼‰ç»“å°¾ã€‚ä¾‹å¦‚è¿”å›&quot;OK&quot;ï¼š &quot;+OK\r\n&quot;</p><p>é”™è¯¯ï¼ˆErrorsï¼‰ï¼šé¦–å­—èŠ‚æ˜¯ â€˜-â€™ ï¼Œä¸å•è¡Œå­—ç¬¦ä¸²æ ¼å¼ä¸€æ ·ï¼Œåªæ˜¯å­—ç¬¦ä¸²æ˜¯å¼‚å¸¸ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š&quot;-Error message\r\n&quot;</p><p>æ•°å€¼ï¼šé¦–å­—èŠ‚æ˜¯ â€˜:â€™ ï¼Œåé¢è·Ÿä¸Šæ•°å­—æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä»¥CRLFç»“å°¾ã€‚ä¾‹å¦‚ï¼š&quot;:10\r\n&quot;</p><p>å¤šè¡Œå­—ç¬¦ä¸²ï¼šé¦–å­—èŠ‚æ˜¯ â€˜$â€™ ï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶å®‰å…¨çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§æ”¯æŒ512MBï¼š</p><p>å¦‚æœå¤§å°ä¸º0ï¼Œåˆ™ä»£è¡¨ç©ºå­—ç¬¦ä¸²ï¼š&quot;$0\r\n\r\n&quot;</p><p>å¦‚æœå¤§å°ä¸º-1ï¼Œåˆ™ä»£è¡¨ä¸å­˜åœ¨ï¼š&quot;$-1\r\n&quot;</p><p>æ•°ç»„ï¼šé¦–å­—èŠ‚æ˜¯ â€˜*â€™ï¼Œåé¢è·Ÿä¸Šæ•°ç»„å…ƒç´ ä¸ªæ•°ï¼Œå†è·Ÿä¸Šå…ƒç´ ï¼Œå…ƒç´ æ•°æ®ç±»å‹ä¸é™:</p><figure><img src="/blog/assets/img/1653982993020.25bb5556.png" alt="1653982993020" tabindex="0" loading="lazy"><figcaption>1653982993020</figcaption></figure><h3 id="_3-1ã€redisé€šä¿¡åè®®-åŸºäºsocketè‡ªå®šä¹‰redisçš„å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#_3-1ã€redisé€šä¿¡åè®®-åŸºäºsocketè‡ªå®šä¹‰redisçš„å®¢æˆ·ç«¯"><span>3.1ã€Redisé€šä¿¡åè®®-åŸºäºSocketè‡ªå®šä¹‰Redisçš„å®¢æˆ·ç«¯</span></a></h3><p>Redisæ”¯æŒTCPé€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Socketæ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯ï¼Œä¸RedisæœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Socket</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> PrintWriter</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BufferedReader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 1.å»ºç«‹è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> host</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;192.168.150.101&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Socket</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(host, port);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 2.è·å–è¾“å‡ºæµã€è¾“å…¥æµ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> PrintWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> OutputStreamWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getOutputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StandardCharsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">UTF_8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            reader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BufferedReader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> InputStreamReader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StandardCharsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">UTF_8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 3.å‘å‡ºè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 3.1.è·å–æˆæƒ auth 123321</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            sendRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;auth&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;123321&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">            Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;obj = &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 3.2.set name è™å“¥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            sendRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;set&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è™å“¥&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 4.è§£æå“åº”</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            obj </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;obj = &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 3.2.set name è™å“¥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            sendRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;get&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 4.è§£æå“åº”</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            obj </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;obj = &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 3.2.set name è™å“¥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            sendRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;mget&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;num&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;msg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 4.è§£æå“åº”</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            obj </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;obj = &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IOException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">printStackTrace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">finally</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // 5.é‡Šæ”¾è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (reader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IOException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">printStackTrace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Object</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IOException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // è¯»å–é¦–å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // åˆ¤æ–­æ•°æ®ç±»å‹æ ‡ç¤º</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        switch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (prefix) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            case</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;+&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å•è¡Œå­—ç¬¦ä¸²ï¼Œç›´æ¥è¯»ä¸€è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            case</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;-&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å¼‚å¸¸ï¼Œä¹Ÿè¯»ä¸€è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            case</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;:&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æ•°å­—</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">parseLong</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            case</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;$&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å¤šè¡Œå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                // å…ˆè¯»é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (len </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (len </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    return</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                }</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                // å†è¯»æ•°æ®,è¯»lenä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬å‡è®¾æ²¡æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥è¯»ä¸€è¡Œï¼ˆç®€åŒ–ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            case</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;*&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> readBulkString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            default:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;é”™è¯¯çš„æ•°æ®æ ¼å¼ï¼&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Object</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> readBulkString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IOException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // è·å–æ•°ç»„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">reader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readLine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (len </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // å®šä¹‰é›†åˆï¼Œæ¥æ”¶å¤šä¸ªå…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        List</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Object</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">list</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;(len);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // éå†ï¼Œä¾æ¬¡è¯»å–æ¯ä¸ªå…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> len; i++) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">handleResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> list;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // set name è™å“¥</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sendRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> arg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> args) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;$&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> arg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getBytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StandardCharsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">UTF_8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(arg);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">flush</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2ã€rediså†…å­˜å›æ”¶-è¿‡æœŸkeyå¤„ç†" tabindex="-1"><a class="header-anchor" href="#_3-2ã€rediså†…å­˜å›æ”¶-è¿‡æœŸkeyå¤„ç†"><span>3.2ã€Rediså†…å­˜å›æ”¶-è¿‡æœŸkeyå¤„ç†</span></a></h3><p>Redisä¹‹æ‰€ä»¥æ€§èƒ½å¼ºï¼Œæœ€ä¸»è¦çš„åŸå› å°±æ˜¯åŸºäºå†…å­˜å­˜å‚¨ã€‚ç„¶è€Œå•èŠ‚ç‚¹çš„Rediså…¶å†…å­˜å¤§å°ä¸å®œè¿‡å¤§ï¼Œä¼šå½±å“æŒä¹…åŒ–æˆ–ä¸»ä»åŒæ­¥æ€§èƒ½ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥è®¾ç½®Redisçš„æœ€å¤§å†…å­˜ï¼š</p><figure><img src="data:image/png;base64,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" alt="1653983341150" tabindex="0" loading="lazy"><figcaption>1653983341150</figcaption></figure><p>å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°ä¸Šé™æ—¶ï¼Œå°±æ— æ³•å­˜å‚¨æ›´å¤šæ•°æ®äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRedisæä¾›äº†ä¸€äº›ç­–ç•¥å®ç°å†…å­˜å›æ”¶ï¼š</p><p>å†…å­˜è¿‡æœŸç­–ç•¥</p><p>åœ¨å­¦ä¹ Redisç¼“å­˜çš„æ—¶å€™æˆ‘ä»¬è¯´è¿‡ï¼Œå¯ä»¥é€šè¿‡expireå‘½ä»¤ç»™Redisçš„keyè®¾ç½®TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰ï¼š</p><figure><img src="/blog/assets/img/1653983366243.04fce6c4.png" alt="1653983366243" tabindex="0" loading="lazy"><figcaption>1653983366243</figcaption></figure><p>å¯ä»¥å‘ç°ï¼Œå½“keyçš„TTLåˆ°æœŸä»¥åï¼Œå†æ¬¡è®¿é—®nameè¿”å›çš„æ˜¯nilï¼Œè¯´æ˜è¿™ä¸ªkeyå·²ç»ä¸å­˜åœ¨äº†ï¼Œå¯¹åº”çš„å†…å­˜ä¹Ÿå¾—åˆ°é‡Šæ”¾ã€‚ä»è€Œèµ·åˆ°å†…å­˜å›æ”¶çš„ç›®çš„ã€‚</p><p>Redisæœ¬èº«æ˜¯ä¸€ä¸ªå…¸å‹çš„key-valueå†…å­˜å­˜å‚¨æ•°æ®åº“ï¼Œå› æ­¤æ‰€æœ‰çš„keyã€valueéƒ½ä¿å­˜åœ¨ä¹‹å‰å­¦ä¹ è¿‡çš„Dictç»“æ„ä¸­ã€‚ä¸è¿‡åœ¨å…¶databaseç»“æ„ä½“ä¸­ï¼Œæœ‰ä¸¤ä¸ªDictï¼šä¸€ä¸ªç”¨æ¥è®°å½•key-valueï¼›å¦ä¸€ä¸ªç”¨æ¥è®°å½•key-TTLã€‚</p><figure><img src="/blog/assets/img/1653983423128.65948185.png" alt="1653983423128" tabindex="0" loading="lazy"><figcaption>1653983423128</figcaption></figure><figure><img src="/blog/assets/img/1653983606531.db7bf14d.png" alt="1653983606531" tabindex="0" loading="lazy"><figcaption>1653983606531</figcaption></figure><p>è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦æˆ‘ä»¬æ€è€ƒï¼š Redisæ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªkeyæ˜¯å¦è¿‡æœŸå‘¢ï¼Ÿ</p><p>åˆ©ç”¨ä¸¤ä¸ªDictåˆ†åˆ«è®°å½•key-valueå¯¹åŠkey-ttlå¯¹</p><p>æ˜¯ä¸æ˜¯TTLåˆ°æœŸå°±ç«‹å³åˆ é™¤äº†å‘¢ï¼Ÿ</p><p><strong>æƒ°æ€§åˆ é™¤</strong></p><p>æƒ°æ€§åˆ é™¤ï¼šé¡¾æ˜æ€è®®å¹¶ä¸æ˜¯åœ¨TTLåˆ°æœŸåå°±ç«‹åˆ»åˆ é™¤ï¼Œè€Œæ˜¯åœ¨è®¿é—®ä¸€ä¸ªkeyçš„æ—¶å€™ï¼Œæ£€æŸ¥è¯¥keyçš„å­˜æ´»æ—¶é—´ï¼Œå¦‚æœå·²ç»è¿‡æœŸæ‰æ‰§è¡Œåˆ é™¤ã€‚</p><figure><img src="/blog/assets/img/1653983652865.117041d9.png" alt="1653983652865" tabindex="0" loading="lazy"><figcaption>1653983652865</figcaption></figure><p><strong>å‘¨æœŸåˆ é™¤</strong></p><p>å‘¨æœŸåˆ é™¤ï¼šé¡¾æ˜æ€è®®æ˜¯é€šè¿‡ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå‘¨æœŸæ€§çš„æŠ½æ ·éƒ¨åˆ†è¿‡æœŸçš„keyï¼Œç„¶åæ‰§è¡Œåˆ é™¤ã€‚æ‰§è¡Œå‘¨æœŸæœ‰ä¸¤ç§ï¼š RedisæœåŠ¡åˆå§‹åŒ–å‡½æ•°initServer()ä¸­è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ŒæŒ‰ç…§server.hzçš„é¢‘ç‡æ¥æ‰§è¡Œè¿‡æœŸkeyæ¸…ç†ï¼Œæ¨¡å¼ä¸ºSLOW Redisçš„æ¯ä¸ªäº‹ä»¶å¾ªç¯å‰ä¼šè°ƒç”¨beforeSleep()å‡½æ•°ï¼Œæ‰§è¡Œè¿‡æœŸkeyæ¸…ç†ï¼Œæ¨¡å¼ä¸ºFAST</p><p>å‘¨æœŸåˆ é™¤ï¼šé¡¾æ˜æ€è®®æ˜¯é€šè¿‡ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå‘¨æœŸæ€§çš„æŠ½æ ·éƒ¨åˆ†è¿‡æœŸçš„keyï¼Œç„¶åæ‰§è¡Œåˆ é™¤ã€‚æ‰§è¡Œå‘¨æœŸæœ‰ä¸¤ç§ï¼š RedisæœåŠ¡åˆå§‹åŒ–å‡½æ•°initServer()ä¸­è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ŒæŒ‰ç…§server.hzçš„é¢‘ç‡æ¥æ‰§è¡Œè¿‡æœŸkeyæ¸…ç†ï¼Œæ¨¡å¼ä¸ºSLOW Redisçš„æ¯ä¸ªäº‹ä»¶å¾ªç¯å‰ä¼šè°ƒç”¨beforeSleep()å‡½æ•°ï¼Œæ‰§è¡Œè¿‡æœŸkeyæ¸…ç†ï¼Œæ¨¡å¼ä¸ºFAST</p><p>SLOWæ¨¡å¼è§„åˆ™ï¼š</p><ul><li>æ‰§è¡Œé¢‘ç‡å—server.hzå½±å“ï¼Œé»˜è®¤ä¸º10ï¼Œå³æ¯ç§’æ‰§è¡Œ10æ¬¡ï¼Œæ¯ä¸ªæ‰§è¡Œå‘¨æœŸ100msã€‚</li><li>æ‰§è¡Œæ¸…ç†è€—æ—¶ä¸è¶…è¿‡ä¸€æ¬¡æ‰§è¡Œå‘¨æœŸçš„25%.é»˜è®¤slowæ¨¡å¼è€—æ—¶ä¸è¶…è¿‡25ms</li><li>é€ä¸ªéå†dbï¼Œé€ä¸ªéå†dbä¸­çš„bucketï¼ŒæŠ½å–20ä¸ªkeyåˆ¤æ–­æ˜¯å¦è¿‡æœŸ</li><li>å¦‚æœæ²¡è¾¾åˆ°æ—¶é—´ä¸Šé™ï¼ˆ25msï¼‰å¹¶ä¸”è¿‡æœŸkeyæ¯”ä¾‹å¤§äº10%ï¼Œå†è¿›è¡Œä¸€æ¬¡æŠ½æ ·ï¼Œå¦åˆ™ç»“æŸ</li><li>FASTæ¨¡å¼è§„åˆ™ï¼ˆè¿‡æœŸkeyæ¯”ä¾‹å°äº10%ä¸æ‰§è¡Œ ï¼‰ï¼š</li><li>æ‰§è¡Œé¢‘ç‡å—beforeSleep()è°ƒç”¨é¢‘ç‡å½±å“ï¼Œä½†ä¸¤æ¬¡FASTæ¨¡å¼é—´éš”ä¸ä½äº2ms</li><li>æ‰§è¡Œæ¸…ç†è€—æ—¶ä¸è¶…è¿‡1ms</li><li>é€ä¸ªéå†dbï¼Œé€ä¸ªéå†dbä¸­çš„bucketï¼ŒæŠ½å–20ä¸ªkeyåˆ¤æ–­æ˜¯å¦è¿‡æœŸ å¦‚æœæ²¡è¾¾åˆ°æ—¶é—´ä¸Šé™ï¼ˆ1msï¼‰å¹¶ä¸”è¿‡æœŸkeyæ¯”ä¾‹å¤§äº10%ï¼Œå†è¿›è¡Œä¸€æ¬¡æŠ½æ ·ï¼Œå¦åˆ™ç»“æŸ</li></ul><p>å°æ€»ç»“ï¼š</p><p>RedisKeyçš„TTLè®°å½•æ–¹å¼ï¼š</p><p>åœ¨RedisDBä¸­é€šè¿‡ä¸€ä¸ªDictè®°å½•æ¯ä¸ªKeyçš„TTLæ—¶é—´</p><p>è¿‡æœŸkeyçš„åˆ é™¤ç­–ç•¥ï¼š</p><p>æƒ°æ€§æ¸…ç†ï¼šæ¯æ¬¡æŸ¥æ‰¾keyæ—¶åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™åˆ é™¤</p><p>å®šæœŸæ¸…ç†ï¼šå®šæœŸæŠ½æ ·éƒ¨åˆ†keyï¼Œåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™åˆ é™¤ã€‚ å®šæœŸæ¸…ç†çš„ä¸¤ç§æ¨¡å¼ï¼š</p><p>SLOWæ¨¡å¼æ‰§è¡Œé¢‘ç‡é»˜è®¤ä¸º10ï¼Œæ¯æ¬¡ä¸è¶…è¿‡25ms</p><p>FASTæ¨¡å¼æ‰§è¡Œé¢‘ç‡ä¸å›ºå®šï¼Œä½†ä¸¤æ¬¡é—´éš”ä¸ä½äº2msï¼Œæ¯æ¬¡è€—æ—¶ä¸è¶…è¿‡1ms</p><h3 id="_3-3-rediså†…å­˜å›æ”¶-å†…å­˜æ·˜æ±°ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_3-3-rediså†…å­˜å›æ”¶-å†…å­˜æ·˜æ±°ç­–ç•¥"><span>3.3 Rediså†…å­˜å›æ”¶-å†…å­˜æ·˜æ±°ç­–ç•¥</span></a></h3><p>å†…å­˜æ·˜æ±°ï¼šå°±æ˜¯å½“Rediså†…å­˜ä½¿ç”¨è¾¾åˆ°è®¾ç½®çš„ä¸Šé™æ—¶ï¼Œä¸»åŠ¨æŒ‘é€‰éƒ¨åˆ†keyåˆ é™¤ä»¥é‡Šæ”¾æ›´å¤šå†…å­˜çš„æµç¨‹ã€‚Redisä¼šåœ¨å¤„ç†å®¢æˆ·ç«¯å‘½ä»¤çš„æ–¹æ³•processCommand()ä¸­å°è¯•åšå†…å­˜æ·˜æ±°ï¼š</p><figure><img src="/blog/assets/img/1653983978671.793af552.png" alt="1653983978671" tabindex="0" loading="lazy"><figcaption>1653983978671</figcaption></figure><p>æ·˜æ±°ç­–ç•¥</p><p>Redisæ”¯æŒ8ç§ä¸åŒç­–ç•¥æ¥é€‰æ‹©è¦åˆ é™¤çš„keyï¼š</p><ul><li>noevictionï¼š ä¸æ·˜æ±°ä»»ä½•keyï¼Œä½†æ˜¯å†…å­˜æ»¡æ—¶ä¸å…è®¸å†™å…¥æ–°æ•°æ®ï¼Œé»˜è®¤å°±æ˜¯è¿™ç§ç­–ç•¥ã€‚</li><li>volatile-ttlï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼Œæ¯”è¾ƒkeyçš„å‰©ä½™TTLå€¼ï¼ŒTTLè¶Šå°è¶Šå…ˆè¢«æ·˜æ±°</li><li>allkeys-randomï¼šå¯¹å…¨ä½“key ï¼Œéšæœºè¿›è¡Œæ·˜æ±°ã€‚ä¹Ÿå°±æ˜¯ç›´æ¥ä»db-&gt;dictä¸­éšæœºæŒ‘é€‰</li><li>volatile-randomï¼šå¯¹è®¾ç½®äº†TTLçš„key ï¼Œéšæœºè¿›è¡Œæ·˜æ±°ã€‚ä¹Ÿå°±æ˜¯ä»db-&gt;expiresä¸­éšæœºæŒ‘é€‰ã€‚</li><li>allkeys-lruï¼š å¯¹å…¨ä½“keyï¼ŒåŸºäºLRUç®—æ³•è¿›è¡Œæ·˜æ±°</li><li>volatile-lruï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼ŒåŸºäºLRUç®—æ³•è¿›è¡Œæ·˜æ±°</li><li>allkeys-lfuï¼š å¯¹å…¨ä½“keyï¼ŒåŸºäºLFUç®—æ³•è¿›è¡Œæ·˜æ±°</li><li>volatile-lfuï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼ŒåŸºäºLFIç®—æ³•è¿›è¡Œæ·˜æ±° æ¯”è¾ƒå®¹æ˜“æ··æ·†çš„æœ‰ä¸¤ä¸ªï¼š <ul><li>LRUï¼ˆLeast Recently Usedï¼‰ï¼Œæœ€å°‘æœ€è¿‘ä½¿ç”¨ã€‚ç”¨å½“å‰æ—¶é—´å‡å»æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´ï¼Œè¿™ä¸ªå€¼è¶Šå¤§åˆ™æ·˜æ±°ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li><li>LFUï¼ˆLeast Frequently Usedï¼‰ï¼Œæœ€å°‘é¢‘ç‡ä½¿ç”¨ã€‚ä¼šç»Ÿè®¡æ¯ä¸ªkeyçš„è®¿é—®é¢‘ç‡ï¼Œå€¼è¶Šå°æ·˜æ±°ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li></ul></li></ul><p>Redisçš„æ•°æ®éƒ½ä¼šè¢«å°è£…ä¸ºRedisObjectç»“æ„ï¼š</p><figure><img src="/blog/assets/img/1653984029506.f1949647.png" alt="1653984029506" tabindex="0" loading="lazy"><figcaption>1653984029506</figcaption></figure><p>LFUçš„è®¿é—®æ¬¡æ•°ä¹‹æ‰€ä»¥å«åšé€»è¾‘è®¿é—®æ¬¡æ•°ï¼Œæ˜¯å› ä¸ºå¹¶ä¸æ˜¯æ¯æ¬¡keyè¢«è®¿é—®éƒ½è®¡æ•°ï¼Œè€Œæ˜¯é€šè¿‡è¿ç®—ï¼š</p><ul><li>ç”Ÿæˆ0~1ä¹‹é—´çš„éšæœºæ•°R</li><li>è®¡ç®— (æ—§æ¬¡æ•° * lfu_log_factor + 1)ï¼Œè®°å½•ä¸ºP</li><li>å¦‚æœ R &lt; P ï¼Œåˆ™è®¡æ•°å™¨ + 1ï¼Œä¸”æœ€å¤§ä¸è¶…è¿‡255</li><li>è®¿é—®æ¬¡æ•°ä¼šéšæ—¶é—´è¡°å‡ï¼Œè·ç¦»ä¸Šä¸€æ¬¡è®¿é—®æ—¶é—´æ¯éš” lfu_decay_time åˆ†é’Ÿï¼Œè®¡æ•°å™¨ -1</li></ul><p>æœ€åç”¨ä¸€å‰¯å›¾æ¥æè¿°å½“å‰çš„è¿™ä¸ªæµç¨‹å§</p><figure><img src="/blog/assets/img/1653984085095.dd73209b.png" alt="1653984085095" tabindex="0" loading="lazy"><figcaption>1653984085095</figcaption></figure><h2 id="_4ã€ç»“æŸè¯­" tabindex="-1"><a class="header-anchor" href="#_4ã€ç»“æŸè¯­"><span>4ã€ç»“æŸè¯­</span></a></h2><p>äº²çˆ±çš„å°ä¼™ä¼´ä»¬ï¼Œæˆ‘ä»¬çš„redisåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å¥½å¥½å­¦ä¹ ï¼Œæ‰¾åˆ°ä¸€ä»½æ»¡æ„çš„å·¥ä½œï¼ä¼ æ™ºä¸ºä½ åŠ æ²¹ã€‚</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/JL-20191210/blog/edit/main/src/Database/Redis/4.åŸç†/åŸç†ç¯‡.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">å“Ÿå¼~</div><div class="vp-copyright">Copyright Â© 2025 æ¥æ¯å†°æŸ æª¬ </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/blog/assets/js/runtime~app.69685e2a.js" defer></script><script src="/blog/assets/js/9703.e09ff620.js" defer></script><script src="/blog/assets/js/app.66fc43a4.js" defer></script>
  </body>
</html>
