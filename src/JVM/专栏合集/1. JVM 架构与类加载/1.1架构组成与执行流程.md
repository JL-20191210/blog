# 1.1《深入理解 JVM：架构组成与执行流程》

------

## 🧠 什么是 JVM？

JVM（Java Virtual Machine，Java 虚拟机）是 Java 技术的核心，它实现了“编译一次，到处运行”的跨平台特性。JVM 是一个运行 Java 字节码的抽象计算机，通过将 `.class` 文件加载并执行，实现 Java 程序在各种硬件和操作系统上的兼容性。

------

## 🧱 JVM 架构图

```
┌────────────────────────────┐
│         Java 程序源码       │
├────────────────────────────┤
│        Java 编译器 (javac)   │
├────────────────────────────┤
│        字节码 (.class 文件) │
├────────────────────────────┤
│         JVM 运行时架构       │
│ ┌────────────────────────┐ │
│ │ 类加载子系统            │ │
│ │ 执行引擎                │ │
│ │ 内存结构（方法区、堆等）│ │
│ │ 本地接口                │ │
│ │ 本地方法库              │ │
│ └────────────────────────┘ │
└────────────────────────────┘
```

------

## 🔍 JVM 架构主要组件详解

| 组件             | 说明                                               |
| ---------------- | -------------------------------------------------- |
| **类加载子系统** | 加载 `.class` 文件，生成 `Class` 对象              |
| **执行引擎**     | 将字节码解释或编译成本地机器码执行                 |
| **运行时数据区** | 包括方法区、堆、虚拟机栈、本地方法栈、程序计数器等 |
| **本地接口**     | 调用本地方法（如 C/C++ 编写的库）                  |
| **本地方法库**   | 被调用的本地代码实现，如 JNI                       |

------

## 🧠 JVM 运行时数据区结构

| 区域             | 特性         | 说明                                 |
| ---------------- | ------------ | ------------------------------------ |
| 程序计数器       | 每个线程私有 | 记录当前线程执行字节码的位置         |
| Java 虚拟机栈    | 每个线程私有 | 存储栈帧（局部变量、操作数栈等）     |
| 本地方法栈       | 每个线程私有 | 调用本地方法所使用的栈空间           |
| 堆               | 所有线程共享 | 存储对象和数组，是 GC 的主要管理区域 |
| 方法区（元空间） | 所有线程共享 | 存储类信息、常量、静态变量等         |

------

## ⚙️ JVM 执行流程总结

1. 编译 Java 文件为 `.class`
2. 类加载器将 `.class` 文件加载到内存
3. 类信息存入方法区，实例对象分配在堆中
4. 虚拟机栈执行方法调用，执行引擎逐条解释字节码
5. 调用本地方法接口时跳转到 C/C++ 实现

------

## ✅ 示例代码说明执行过程

```java
public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, JVM");
    }
}
```

运行流程：

- `javac` 编译为 `HelloWorld.class`
- JVM 通过类加载器加载该类
- 方法区存储类元信息，堆中创建字符串对象
- 虚拟机栈执行 `main` 方法，输出内容

------

## 📌 面试高频问题

1. JVM 架构有哪些核心组件？
2. 程序计数器和虚拟机栈的区别？
3. 方法区与堆的区别？
4. JVM 为什么需要本地方法接口？

------

## 📝 小结

- JVM 架构以类加载器、执行引擎、内存模型为核心
- 各内存区域职责清晰、配合完成字节码的执行
- 理解 JVM 执行流程是掌握性能调优与 GC 分析的基础

------

👉 下一篇：[1.2 类加载机制详解（含双亲委派）]