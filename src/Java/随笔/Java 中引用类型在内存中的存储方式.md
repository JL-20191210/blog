# Java 中**引用类型在内存中的存储方式** 

## 🧠 一、什么是引用类型？

在 Java 中，除了 8 种基本类型，其他都是 **引用类型**，包括：

- 类（`new` 出来的对象）
- 接口
- 数组
- 枚举
- 字符串（虽然是特殊的，但也是引用类型）

------

## 🧩 二、Java 内存结构简要回顾

Java 的内存结构大致如下（基于 HotSpot JVM）：

| 区域                    | 描述                                         |
| ----------------------- | -------------------------------------------- |
| **栈（Stack）**         | 存放方法调用帧、局部变量表（包括引用变量）   |
| **堆（Heap）**          | 存放所有对象实例和数组，垃圾回收主要作用于此 |
| **方法区（MetaSpace）** | 类信息、常量池、静态变量等                   |
| **程序计数器**          | 每个线程的执行字节码的指令地址               |
| **本地方法栈**          | 用于调用本地方法（JNI）                      |

------

## 📦 三、引用类型是如何存储的？

```java
Person p = new Person();
```

### 存储过程是这样的：

#### ✅ 栈（Stack）：

- `p` 是一个**引用变量**，它本身存放在**当前线程的栈帧中的局部变量表里**。
- `p` 里面保存的是一个**地址值**（指向堆中的真实对象）。

#### ✅ 堆（Heap）：

- `new Person()` 会在**堆上创建一个 Person 对象**。
- 对象内部包含字段（如 `name`、`age`），如果这些字段也是引用类型（如 `String name`），它们的值同样是指向其他对象的地址。

------

### ✅ 内存示意图：

```
栈内存（方法栈）：
┌───────────────┐
│ 局部变量表     │
│  p ─────────┐ │
└─────────────│─┘
              ↓
            堆内存（对象）
            ┌────────────────┐
            │ Person 对象     │
            │ name ─────┐     │
            │ age  = 18 │     │
            └──────────│─────┘
                       ↓
                    String 对象
                    "张三"
```

------

## 🧹 四、和垃圾回收有什么关系？

- **引用变量失效**（比如作用域结束、被赋 null、被覆盖）后，如果堆中的对象不再被任何 GC Root 引用，它就会被垃圾回收。
- 所以：**Java 中变量保存的是“对象的地址”**，并不是对象本身！

------

## 🔍 小结

| 区域   | 存什么                         |
| ------ | ------------------------------ |
| 栈     | 引用变量（保存对象地址）       |
| 堆     | 真正的对象实例及其字段数据     |
| 方法区 | 类的结构信息、静态字段、常量等 |