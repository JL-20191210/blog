# Javaé›†åˆé¢è¯•é¢˜

## æ¦‚å¿µ

### 1.æ•°ç»„ä¸é›†åˆåŒºåˆ«ï¼Œç”¨è¿‡å“ªäº›ï¼Ÿ

æ•°ç»„å’Œé›†åˆçš„åŒºåˆ«ï¼š

- æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„æ•°æ®ç»“æ„ï¼Œä¸€æ—¦åˆ›å»ºé•¿åº¦å°±æ— æ³•æ”¹å˜ï¼Œè€Œé›†åˆæ˜¯åŠ¨æ€é•¿åº¦çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€å¢åŠ æˆ–å‡å°‘å…ƒç´ ã€‚
- æ•°ç»„å¯ä»¥åŒ…å«åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹è±¡ï¼Œè€Œé›†åˆåªèƒ½åŒ…å«å¯¹è±¡ã€‚
- æ•°ç»„å¯ä»¥ç›´æ¥è®¿é—®å…ƒç´ ï¼Œè€Œé›†åˆéœ€è¦é€šè¿‡è¿­ä»£å™¨æˆ–å…¶ä»–æ–¹æ³•è®¿é—®å…ƒç´ ã€‚

æˆ‘ç”¨è¿‡çš„ä¸€äº› Java é›†åˆç±»ï¼š

- **ArrayListï¼š** åŠ¨æ€æ•°ç»„ï¼Œå®ç°äº†Listæ¥å£ï¼Œæ”¯æŒåŠ¨æ€å¢é•¿ã€‚
- **LinkedListï¼š** åŒå‘é“¾è¡¨ï¼Œä¹Ÿå®ç°äº†Listæ¥å£ï¼Œæ”¯æŒå¿«é€Ÿçš„æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚
- **HashMapï¼š** åŸºäºå“ˆå¸Œè¡¨çš„Mapå®ç°ï¼Œå­˜å‚¨é”®å€¼å¯¹ï¼Œé€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å€¼ã€‚
- **HashSetï¼š** åŸºäºHashMapå®ç°çš„Seté›†åˆï¼Œç”¨äºå­˜å‚¨å”¯ä¸€å…ƒç´ ã€‚
- **TreeMapï¼š** åŸºäºçº¢é»‘æ ‘å®ç°çš„æœ‰åºMapé›†åˆï¼Œå¯ä»¥æŒ‰ç…§é”®çš„é¡ºåºè¿›è¡Œæ’åºã€‚
- **LinkedHashMapï¼š** åŸºäºå“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨å®ç°çš„Mapé›†åˆï¼Œä¿æŒæ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåºã€‚
- **PriorityQueueï¼š** ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯ä»¥æŒ‰ç…§æ¯”è¾ƒå™¨æˆ–å…ƒç´ çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºã€‚

### 2.è¯´è¯´Javaä¸­çš„é›†åˆï¼Ÿ

![img](assets/1750392807027-ed6329d5-eb7b-448f-a5a7-9d83ec94c1c3.webp)

> Listæ˜¯æœ‰åºçš„Collectionï¼Œä½¿ç”¨æ­¤æ¥å£èƒ½å¤Ÿç²¾ç¡®çš„æ§åˆ¶æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®ï¼Œç”¨æˆ·èƒ½æ ¹æ®ç´¢å¼•è®¿é—®Listä¸­å…ƒç´ ã€‚å¸¸ç”¨çš„å®ç°Listçš„ç±»æœ‰LinkedListï¼ŒArrayListï¼ŒVectorï¼ŒStackã€‚

- ArrayListæ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨åˆ—è¡¨ï¼Œå…¶åº•å±‚ä½¿ç”¨æ•°ç»„å®ç°ã€‚å½“å‡ ä½•æ‰©å®¹æ—¶ï¼Œä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ï¼Œå¹¶æŠŠåŸæ•°ç»„å¤åˆ¶åˆ°æ–°æ•°ç»„ã€‚ArrayListæ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ’å…¥ä¸åˆ é™¤é€Ÿåº¦å¾ˆæ…¢ã€‚
- LinkedListæœ¬è´¨æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œä¸ArrayListç›¸æ¯”ï¼Œï¼Œå…¶æ’å…¥å’Œåˆ é™¤é€Ÿåº¦æ›´å¿«ï¼Œä½†éšæœºè®¿é—®é€Ÿåº¦æ›´æ…¢ã€‚

> Setä¸å…è®¸å­˜åœ¨é‡å¤çš„å…ƒç´ ï¼Œä¸Listä¸åŒï¼Œsetä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ã€‚å¸¸ç”¨çš„å®ç°æœ‰HashSetï¼ŒLinkedHashSetå’ŒTreeSetã€‚

- HashSeté€šè¿‡HashMapå®ç°ï¼ŒHashMapçš„Keyå³HashSetå­˜å‚¨çš„å…ƒç´ ï¼Œæ‰€æœ‰Keyéƒ½æ˜¯ç”¨ç›¸åŒçš„Valueï¼Œä¸€ä¸ªåä¸ºPRESENTçš„Objectç±»å‹å¸¸é‡ã€‚ä½¿ç”¨Keyä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼Œä½†ä¸ä¿è¯æœ‰åºæ€§ã€‚ç”±äºHashSetæ˜¯HashMapå®ç°çš„ï¼Œå› æ­¤çº¿ç¨‹ä¸å®‰å…¨ã€‚
- LinkedHashSetç»§æ‰¿è‡ªHashSetï¼Œé€šè¿‡LinkedHashMapå®ç°ï¼Œä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ æ’å…¥é¡ºåºã€‚
- TreeSeté€šè¿‡TreeMapå®ç°çš„ï¼Œæ·»åŠ å…ƒç´ åˆ°é›†åˆæ—¶æŒ‰ç…§æ¯”è¾ƒè§„åˆ™å°†å…¶æ’å…¥åˆé€‚çš„ä½ç½®ï¼Œä¿è¯æ’å…¥åçš„é›†åˆä»ç„¶æœ‰åºã€‚

> Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå­˜å‚¨é”®ã€å€¼å’Œä¹‹é—´çš„æ˜ å°„ã€‚Key æ— åºï¼Œå”¯ä¸€ï¼›value ä¸è¦æ±‚æœ‰åºï¼Œå…è®¸é‡å¤ã€‚Map æ²¡æœ‰ç»§æ‰¿äºCollection æ¥å£ï¼Œä» Map é›†åˆä¸­æ£€ç´¢å…ƒç´ æ—¶ï¼Œåªè¦ç»™å‡ºé”®å¯¹è±¡ï¼Œå°±ä¼šè¿”å›å¯¹åº”çš„å€¼å¯¹è±¡ã€‚ä¸»è¦å®ç°æœ‰TreeMapã€HashMapã€HashTableã€LinkedHashMapã€ConcurrentHashMap

- HashMapï¼šJDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ï¼ŒJDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´
- LinkedHashMapï¼šLinkedHashMap ç»§æ‰¿è‡ª HashMapï¼Œæ‰€ä»¥å®ƒçš„åº•å±‚ä»ç„¶æ˜¯åŸºäºæ‹‰é“¾å¼æ•£åˆ—ç»“æ„å³ç”±æ•°ç»„å’Œé“¾è¡¨æˆ–çº¢é»‘æ ‘ç»„æˆã€‚å¦å¤–ï¼ŒLinkedHashMap åœ¨ä¸Šé¢ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—ä¸Šé¢çš„ç»“æ„å¯ä»¥ä¿æŒé”®å€¼å¯¹çš„æ’å…¥é¡ºåºã€‚åŒæ—¶é€šè¿‡å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå®ç°äº†è®¿é—®é¡ºåºç›¸å…³é€»è¾‘ã€‚
- HashTableï¼šæ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashTable çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„
- TreeMapï¼šçº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰
- ConcurrentHashMapï¼šNodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å®ç°ï¼Œçº¿ç¨‹å®‰å…¨çš„ï¼ˆjdk1.8ä»¥å‰Segmenté”ï¼Œ1.8ä»¥åvolatile + CAS æˆ–è€… synchronizedï¼‰

### 3.Javaä¸­çš„çº¿ç¨‹å®‰å…¨çš„é›†åˆæ˜¯ä»€ä¹ˆï¼Ÿ

> [!important]
>
> åœ¨ java.util åŒ…ä¸­çš„çº¿ç¨‹å®‰å…¨çš„ç±»ä¸»è¦ 2 ä¸ªï¼Œå…¶ä»–éƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚

- **Vector**ï¼šçº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„ï¼Œå…¶å†…éƒ¨æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡synchronizedä¿®é¥°ï¼Œå¦‚æœä¸éœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸å»ºè®®é€‰æ‹©ï¼Œæ¯•ç«ŸåŒæ­¥æ˜¯æœ‰é¢å¤–å¼€é”€çš„ã€‚Vector å†…éƒ¨æ˜¯ä½¿ç”¨å¯¹è±¡æ•°ç»„æ¥ä¿å­˜æ•°æ®ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨çš„å¢åŠ å®¹é‡ï¼Œå½“æ•°ç»„å·²æ»¡æ—¶ï¼Œä¼šåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œå¹¶æ‹·è´åŸæœ‰æ•°ç»„æ•°æ®ã€‚
- **Hashtable**ï¼šçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ï¼ŒHashTable çš„åŠ é”æ–¹æ³•æ˜¯ç»™æ¯ä¸ªæ–¹æ³•åŠ ä¸Š synchronized å…³é”®å­—ï¼Œè¿™æ ·é”ä½çš„æ˜¯æ•´ä¸ª Table å¯¹è±¡ï¼Œä¸æ”¯æŒ null é”®å’Œå€¼ï¼Œç”±äºåŒæ­¥å¯¼è‡´çš„æ€§èƒ½å¼€é”€ï¼Œæ‰€ä»¥å·²ç»å¾ˆå°‘è¢«æ¨èä½¿ç”¨ï¼Œå¦‚æœè¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ï¼Œå¯ä»¥ç”¨ConcurrentHashMapã€‚

> java.util.concurrent åŒ…æä¾›çš„éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„é›†åˆï¼š

> [!note]
>
> å¹¶å‘Mapï¼š

- **ConcurrentHashMap**ï¼šå®ƒä¸ HashTable çš„ä¸»è¦åŒºåˆ«æ˜¯äºŒè€…åŠ é”ç²’åº¦çš„ä¸åŒï¼Œåœ¨**JDK1.7**ï¼ŒConcurrentHashMapåŠ çš„æ˜¯åˆ†æ®µé”ï¼Œä¹Ÿå°±æ˜¯Segmenté”ï¼Œæ¯ä¸ªSegment å«æœ‰æ•´ä¸ª table çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·ä¸åŒåˆ†æ®µä¹‹é—´çš„å¹¶å‘æ“ä½œå°±äº’ä¸å½±å“ã€‚åœ¨**JDK 1.8** ï¼Œå®ƒå–æ¶ˆäº†Segmentå­—æ®µï¼Œç›´æ¥åœ¨tableå…ƒç´ ä¸ŠåŠ é”ï¼Œå®ç°å¯¹æ¯ä¸€è¡Œè¿›è¡ŒåŠ é”ï¼Œè¿›ä¸€æ­¥å‡å°äº†å¹¶å‘å†²çªçš„æ¦‚ç‡ã€‚å¯¹äºputæ“ä½œï¼Œå¦‚æœKeyå¯¹åº”çš„æ•°ç»„å…ƒç´ ä¸ºnullï¼Œåˆ™é€šè¿‡CASæ“ä½œï¼ˆCompare and Swapï¼‰å°†å…¶è®¾ç½®ä¸ºå½“å‰å€¼ã€‚å¦‚æœKeyå¯¹åº”çš„æ•°ç»„å…ƒç´ ï¼ˆä¹Ÿå³é“¾è¡¨è¡¨å¤´æˆ–è€…æ ‘çš„æ ¹å…ƒç´ ï¼‰ä¸ä¸ºnullï¼Œåˆ™å¯¹è¯¥å…ƒç´ ä½¿ç”¨ synchronized å…³é”®å­—ç”³è¯·é”ï¼Œç„¶åè¿›è¡Œæ“ä½œã€‚å¦‚æœè¯¥ put æ“ä½œä½¿å¾—å½“å‰é“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™å°†è¯¥é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä»è€Œæé«˜å¯»å€æ•ˆç‡ã€‚
- **ConcurrentSkipListMap**ï¼šå®ç°äº†ä¸€ä¸ªåŸºäºSkipListï¼ˆè·³è¡¨ï¼‰ç®—æ³•çš„å¯æ’åºçš„å¹¶å‘é›†åˆï¼ŒSkipListæ˜¯ä¸€ç§å¯ä»¥åœ¨å¯¹æ•°é¢„æœŸæ—¶é—´å†…å®Œæˆæœç´¢ã€æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œçš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ç»´æŠ¤å¤šä¸ªæŒ‡å‘å…¶ä»–å…ƒç´ çš„â€œè·³è·ƒâ€é“¾æ¥æ¥å®ç°é«˜æ•ˆæŸ¥æ‰¾ã€‚

> [!note]
>
>å¹¶å‘Setï¼š

- **ConcurrentSkipListSet**ï¼šæ˜¯çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„é›†åˆã€‚åº•å±‚æ˜¯ä½¿ç”¨ConcurrentSkipListMapå®ç°ã€‚
- **CopyOnWriteArraySet**ï¼šæ˜¯çº¿ç¨‹å®‰å…¨çš„Setå®ç°ï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„æ— åºçš„é›†åˆï¼Œå¯ä»¥å°†å®ƒç†è§£æˆçº¿ç¨‹å®‰å…¨çš„HashSetã€‚æœ‰æ„æ€çš„æ˜¯ï¼ŒCopyOnWriteArraySetå’ŒHashSetè™½ç„¶éƒ½ç»§æ‰¿äºå…±åŒçš„çˆ¶ç±»AbstractSetï¼›ä½†æ˜¯ï¼ŒHashSetæ˜¯é€šè¿‡â€œæ•£åˆ—è¡¨â€å®ç°çš„ï¼Œè€ŒCopyOnWriteArraySetåˆ™æ˜¯é€šè¿‡â€œåŠ¨æ€æ•°ç»„(CopyOnWriteArrayList)â€å®ç°çš„ï¼Œå¹¶ä¸æ˜¯æ•£åˆ—è¡¨ã€‚

> [!note]
>
>å¹¶å‘Listï¼š

- **CopyOnWriteArrayList**ï¼šå®ƒæ˜¯ ArrayList çš„çº¿ç¨‹å®‰å…¨çš„å˜ä½“ï¼Œå…¶ä¸­æ‰€æœ‰å†™æ“ä½œï¼ˆaddï¼Œsetç­‰ï¼‰éƒ½é€šè¿‡å¯¹åº•å±‚æ•°ç»„è¿›è¡Œå…¨æ–°å¤åˆ¶æ¥å®ç°ï¼Œå…è®¸å­˜å‚¨ null å…ƒç´ ã€‚å³å½“å¯¹è±¡è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä½¿ç”¨äº†Locké”åšåŒæ­¥å¤„ç†ï¼Œå†…éƒ¨æ‹·è´äº†åŸæ•°ç»„ï¼Œå¹¶åœ¨æ–°æ•°ç»„ä¸Šè¿›è¡Œæ·»åŠ æ“ä½œï¼Œæœ€åå°†æ–°æ•°ç»„æ›¿æ¢æ‰æ—§æ•°ç»„ï¼›è‹¥è¿›è¡Œçš„è¯»æ“ä½œï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœï¼Œæ“ä½œè¿‡ç¨‹ä¸­ä¸éœ€è¦è¿›è¡ŒåŒæ­¥ã€‚
> [!note]
>
>å¹¶å‘ Queueï¼š

- **ConcurrentLinkedQueue**ï¼šæ˜¯ä¸€ä¸ªé€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯ä¸‹çš„é˜Ÿåˆ—ï¼Œå®ƒé€šè¿‡æ— é”çš„æ–¹å¼(CAS)ï¼Œå®ç°äº†é«˜å¹¶å‘çŠ¶æ€ä¸‹çš„é«˜æ€§èƒ½ã€‚é€šå¸¸ï¼ŒConcurrentLinkedQueue çš„æ€§èƒ½è¦å¥½äº BlockingQueue ã€‚
- **BlockingQueue**ï¼šä¸ ConcurrentLinkedQueue çš„ä½¿ç”¨åœºæ™¯ä¸åŒï¼ŒBlockingQueue çš„ä¸»è¦åŠŸèƒ½å¹¶ä¸æ˜¯åœ¨äºæå‡é«˜å¹¶å‘æ—¶çš„é˜Ÿåˆ—æ€§èƒ½ï¼Œè€Œåœ¨äºç®€åŒ–å¤šçº¿ç¨‹é—´çš„æ•°æ®å…±äº«ã€‚BlockingQueue æä¾›ä¸€ç§è¯»å†™é˜»å¡ç­‰å¾…çš„æœºåˆ¶ï¼Œå³å¦‚æœæ¶ˆè´¹è€…é€Ÿåº¦è¾ƒå¿«ï¼Œåˆ™ BlockingQueue åˆ™å¯èƒ½è¢«æ¸…ç©ºï¼Œæ­¤æ—¶æ¶ˆè´¹çº¿ç¨‹å†è¯•å›¾ä» BlockingQueue è¯»å–æ•°æ®æ—¶å°±ä¼šè¢«é˜»å¡ã€‚åä¹‹ï¼Œå¦‚æœç”Ÿäº§çº¿ç¨‹è¾ƒå¿«ï¼Œåˆ™ BlockingQueue å¯èƒ½ä¼šè¢«è£…æ»¡ï¼Œæ­¤æ—¶ï¼Œç”Ÿäº§çº¿ç¨‹å†è¯•å›¾å‘ BlockingQueue é˜Ÿåˆ—è£…å…¥æ•°æ®æ—¶ï¼Œä¾¿ä¼šè¢«é˜»å¡ç­‰å¾…ã€‚

> [!note]
>
>å¹¶å‘ Dequeï¼š

- **LinkedBlockingDeque**ï¼šæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„åŒç«¯é˜Ÿåˆ—å®ç°ã€‚å®ƒçš„å†…éƒ¨ä½¿ç”¨é“¾è¡¨ç»“æ„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªå‰é©±èŠ‚ç‚¹å’Œä¸€ä¸ªåé©±èŠ‚ç‚¹ã€‚LinkedBlockingDeque æ²¡æœ‰è¿›è¡Œè¯»å†™é”çš„åˆ†ç¦»ï¼Œå› æ­¤åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œæ“ä½œ
- **ConcurrentLinkedDeque**ï¼šConcurrentLinkedDequeæ˜¯ä¸€ç§åŸºäºé“¾æ¥èŠ‚ç‚¹çš„æ— é™å¹¶å‘é“¾è¡¨ã€‚å¯ä»¥å®‰å…¨åœ°å¹¶å‘æ‰§è¡Œæ’å…¥ã€åˆ é™¤å’Œè®¿é—®æ“ä½œã€‚å½“è®¸å¤šçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå…¬å…±é›†åˆæ—¶ï¼ŒConcurrentLinkedDequeæ˜¯ä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚

### 4.Collectionså’ŒCollectionçš„åŒºåˆ«

- Collectionæ˜¯Javaé›†åˆæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œå®ƒæ˜¯æ‰€æœ‰é›†åˆç±»çš„åŸºç¡€æ¥å£ã€‚å®ƒå®šä¹‰äº†ä¸€ç»„é€šç”¨çš„æ“ä½œå’Œæ–¹æ³•ï¼Œå¦‚æ·»åŠ ã€åˆ é™¤ã€éå†ç­‰ï¼Œç”¨äºæ“ä½œå’Œç®¡ç†ä¸€ç»„å¯¹è±¡ã€‚Collectionæ¥å£æœ‰è®¸å¤šå®ç°ç±»ï¼Œå¦‚Listã€Setå’ŒQueueç­‰ã€‚
- Collectionsï¼ˆæ³¨æ„æœ‰ä¸€ä¸ªsï¼‰æ˜¯Javaæä¾›çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œä½äºjava.utilåŒ…ä¸­ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—é™æ€æ–¹æ³•ï¼Œç”¨äºå¯¹é›†åˆè¿›è¡Œæ“ä½œå’Œç®—æ³•ã€‚Collectionsç±»ä¸­çš„æ–¹æ³•åŒ…æ‹¬æ’åºã€æŸ¥æ‰¾ã€æ›¿æ¢ã€åè½¬ã€éšæœºåŒ–ç­‰ç­‰ã€‚è¿™äº›æ–¹æ³•å¯ä»¥å¯¹å®ç°äº†Collectionæ¥å£çš„é›†åˆè¿›è¡Œæ“ä½œï¼Œå¦‚Listå’ŒSetã€‚

### 5.é›†åˆéå†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ

åœ¨Javaä¸­ï¼Œé›†åˆçš„éå†æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š

- **æ™®é€š for å¾ªç¯ï¼š** å¯ä»¥ä½¿ç”¨å¸¦æœ‰ç´¢å¼•çš„æ™®é€š for å¾ªç¯æ¥éå† Listã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

for (int i = 0; i < list.size(); i++) {
    String element = list.get(i);
    System.out.println(element);
}
```

- **å¢å¼º for å¾ªç¯ï¼ˆfor-eachå¾ªç¯ï¼‰ï¼š** ç”¨äºå¾ªç¯è®¿é—®æ•°ç»„æˆ–é›†åˆä¸­çš„å…ƒç´ ã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

for (String element : list) {
    System.out.println(element);
}
```

- **Iterator è¿­ä»£å™¨ï¼š** å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æ¥éå†é›†åˆï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦åˆ é™¤å…ƒç´ çš„æƒ…å†µã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

Iterator<String> iterator = list.iterator();
while(iterator.hasNext()) {
    String element = iterator.next();
    System.out.println(element);
}
```

- **ListIterator åˆ—è¡¨è¿­ä»£å™¨ï¼š** ListIteratoræ˜¯è¿­ä»£å™¨çš„å­ç±»ï¼Œå¯ä»¥åŒå‘è®¿é—®åˆ—è¡¨å¹¶åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¿®æ”¹å…ƒç´ ã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

ListIterator<String> listIterator= list.listIterator();
while(listIterator.hasNext()) {
    String element = listIterator.next();
    System.out.println(element);
}
```

- **ä½¿ç”¨ forEach æ–¹æ³•ï¼š** Java 8å¼•å…¥äº† forEach æ–¹æ³•ï¼Œå¯ä»¥å¯¹é›†åˆè¿›è¡Œå¿«é€Ÿéå†ã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

list.forEach(element -> System.out.println(element));
```

- **Stream APIï¼š** Java 8çš„Stream APIæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¯ä»¥å¯¹é›†åˆè¿›è¡Œå‡½æ•°å¼æ“ä½œï¼Œå¦‚è¿‡æ»¤ã€æ˜ å°„ç­‰ã€‚

```java
List<String> list = new ArrayList<>();
list.add("A");
list.add("B");
list.add("C");

list.stream().forEach(element -> System.out.println(element));
```

è¿™äº›æ˜¯å¸¸ç”¨çš„é›†åˆéå†æ–¹æ³•ï¼Œæ ¹æ®æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ³•æ¥éå†å’Œæ“ä½œé›†åˆã€‚

## List

### 1.å¸¸è§çš„List

![img](assets/1750411521154-9d611a80-a70b-4392-8f56-ad26cc9db87d.webp)å¸¸è§çš„Listé›†åˆï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰ï¼š

- `ArrayList`åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œå®ƒå…è®¸å¿«é€Ÿçš„éšæœºè®¿é—®ï¼Œå³é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O (1)ã€‚åœ¨æ·»åŠ å’Œåˆ é™¤å…ƒç´ æ—¶ï¼Œå¦‚æœæ“ä½œä½ç½®ä¸æ˜¯åˆ—è¡¨æœ«å°¾ï¼Œå¯èƒ½éœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´ ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒä½ã€‚é€‚ç”¨äºéœ€è¦é¢‘ç¹éšæœºè®¿é—®å…ƒç´ ï¼Œè€Œå¯¹æ’å…¥å’Œåˆ é™¤æ“ä½œæ€§èƒ½è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œå¦‚æ•°æ®çš„æŸ¥è¯¢å’Œå±•ç¤ºç­‰ã€‚
- `LinkedList`åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œåœ¨æ’å…¥å’Œåˆ é™¤å…ƒç´ æ—¶ï¼Œåªéœ€ä¿®æ”¹é“¾è¡¨çš„æŒ‡é’ˆï¼Œä¸éœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O (1)ã€‚ä½†éšæœºè®¿é—®å…ƒç´ æ—¶ï¼Œéœ€è¦ä»é“¾è¡¨å¤´æˆ–é“¾è¡¨å°¾å¼€å§‹éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O (n)ã€‚é€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„åœºæ™¯ï¼Œå¦‚é˜Ÿåˆ—ã€æ ˆç­‰æ•°æ®ç»“æ„çš„å®ç°ï¼Œä»¥åŠéœ€è¦åœ¨åˆ—è¡¨ä¸­é—´é¢‘ç¹æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æƒ…å†µã€‚

å¸¸è§çš„Listé›†åˆï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ï¼š

- `Vector`å’Œ`ArrayList`ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åŸºäºæ•°ç»„å®ç°ã€‚`Vector`ä¸­çš„æ–¹æ³•å¤§å¤šæ˜¯åŒæ­¥çš„ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯ä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œç”±äºåŒæ­¥å¸¦æ¥çš„å¼€é”€ï¼Œæ€§èƒ½ä¼šç•¥ä½äº`ArrayList`ã€‚
- `CopyOnWriteArrayList`åœ¨å¯¹åˆ—è¡¨è¿›è¡Œä¿®æ”¹ï¼ˆå¦‚æ·»åŠ ã€åˆ é™¤å…ƒç´ ï¼‰æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ï¼Œå°†ä¿®æ”¹æ“ä½œåº”ç”¨åˆ°æ–°æ•°ç»„ä¸Šï¼Œè€Œè¯»æ“ä½œä»ç„¶åœ¨åŸæ•°ç»„ä¸Šè¿›è¡Œï¼Œè¿™æ ·å¯ä»¥ä¿è¯è¯»æ“ä½œä¸ä¼šè¢«å†™æ“ä½œé˜»å¡ï¼Œå®ç°äº†è¯»å†™åˆ†ç¦»ï¼Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚é€‚ç”¨äºè¯»æ“ä½œè¿œè¿œå¤šäºå†™æ“ä½œçš„å¹¶å‘åœºæ™¯ï¼Œå¦‚äº‹ä»¶ç›‘å¬åˆ—è¡¨ç­‰ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹å¯ä»¥é¿å…å¤§é‡çš„é”ç«äº‰ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚

### 2.è®²ä¸€ä¸‹javaé‡Œé¢listçš„å‡ ç§å®ç°ï¼Œå‡ ç§å®ç°æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

åœ¨Javaä¸­ï¼Œ`List`æ¥å£æ˜¯æœ€å¸¸ç”¨çš„é›†åˆç±»å‹ä¹‹ä¸€ï¼Œç”¨äºå­˜å‚¨å…ƒç´ çš„æœ‰åºé›†åˆã€‚ä»¥ä¸‹æ˜¯Javaä¸­å¸¸è§çš„`List`å®ç°åŠå…¶ç‰¹ç‚¹ï¼š

 ![img](assets/1750411786453-082493d9-4978-46f1-bd3e-98ad5d66479c.webp)

- Vector æ˜¯ Java æ—©æœŸæä¾›çš„çº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„ï¼Œå¦‚æœä¸éœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸å»ºè®®é€‰æ‹©ï¼Œæ¯•ç«ŸåŒæ­¥æ˜¯æœ‰é¢å¤–å¼€é”€çš„ã€‚Vector å†…éƒ¨æ˜¯ä½¿ç”¨å¯¹è±¡æ•°ç»„æ¥ä¿å­˜æ•°æ®ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨çš„å¢åŠ å®¹é‡ï¼Œå½“æ•°ç»„å·²æ»¡æ—¶ï¼Œä¼šåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œå¹¶æ‹·è´åŸæœ‰æ•°ç»„æ•°æ®ã€‚
- ArrayList æ˜¯åº”ç”¨æ›´åŠ å¹¿æ³›çš„åŠ¨æ€æ•°ç»„å®ç°ï¼Œå®ƒæœ¬èº«ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æ€§èƒ½è¦å¥½å¾ˆå¤šã€‚ä¸ Vector è¿‘ä¼¼ï¼ŒArrayList ä¹Ÿæ˜¯å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´å®¹é‡ï¼Œä¸è¿‡ä¸¤è€…çš„è°ƒæ•´é€»è¾‘æœ‰æ‰€åŒºåˆ«ï¼ŒVector åœ¨æ‰©å®¹æ—¶ä¼šæé«˜ 1 å€ï¼Œè€Œ ArrayList åˆ™æ˜¯å¢åŠ  50%ã€‚
- LinkedList é¡¾åæ€ä¹‰æ˜¯ Java æä¾›çš„åŒå‘é“¾è¡¨ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦åƒä¸Šé¢ä¸¤ç§é‚£æ ·è°ƒæ•´å®¹é‡ï¼Œå®ƒä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚

> è¿™å‡ ç§å®ç°å…·ä½“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥ç”¨å“ªç§ï¼Ÿ

- Vector å’Œ ArrayList ä½œä¸ºåŠ¨æ€æ•°ç»„ï¼Œå…¶å†…éƒ¨å…ƒç´ ä»¥æ•°ç»„å½¢å¼é¡ºåºå­˜å‚¨çš„ï¼Œæ‰€ä»¥éå¸¸é€‚åˆéšæœºè®¿é—®çš„åœºåˆã€‚é™¤äº†å°¾éƒ¨æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå¾€å¾€æ€§èƒ½ä¼šç›¸å¯¹è¾ƒå·®ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ä¸­é—´ä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œéœ€è¦ç§»åŠ¨åç»­æ‰€æœ‰å…ƒç´ ã€‚
- è€Œ LinkedList è¿›è¡ŒèŠ‚ç‚¹æ’å…¥ã€åˆ é™¤å´è¦é«˜æ•ˆå¾—å¤šï¼Œä½†æ˜¯éšæœºè®¿é—®æ€§èƒ½åˆ™è¦æ¯”åŠ¨æ€æ•°ç»„æ…¢ã€‚

### 3.listå¯ä»¥ä¸€è¾¹éå†ä¸€è¾¹ä¿®æ”¹å…ƒç´ å—ï¼Ÿ

æ™®é€šæƒ…å†µä¸‹ï¼Œ**ä¸èƒ½ç›´æ¥åœ¨éå†è¿‡ç¨‹ä¸­ä¿®æ”¹ List çš„ç»“æ„ï¼ˆå¢åˆ å…ƒç´ ï¼‰**ï¼Œå¦åˆ™ä¼šæŠ›å‡º ConcurrentModificationExceptionã€‚

ä½†å¦‚æœåªæ˜¯**ä¿®æ”¹å…ƒç´ å€¼**ï¼ˆä¸æ”¹å˜ç»“æ„ï¼‰ï¼Œæ˜¯å¯ä»¥çš„ã€‚

**è§£å†³æ–¹æ¡ˆæœ‰ä¸‰ç§**ï¼š

1. âœ… ä½¿ç”¨ **ListIterator**ï¼Œæ”¯æŒè¾¹éå†è¾¹ä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤ã€‚
2. âœ… ä½¿ç”¨ **for å¾ªç¯**ï¼ˆé€šè¿‡ç´¢å¼•ï¼‰ï¼Œå¯å®‰å…¨ä¿®æ”¹ã€‚
3. âœ… ä½¿ç”¨ **CopyOnWriteArrayList**ï¼ˆçº¿ç¨‹å®‰å…¨çš„ Listï¼‰ï¼Œæ”¯æŒä¿®æ”¹ä½†æœ‰æ€§èƒ½ä»£ä»·ã€‚

**ğŸ” è¯¦ç»†è§£é‡Šï¼š**

**âŒ é”™è¯¯ç¤ºä¾‹ï¼šä½¿ç”¨å¢å¼º for éå†æ—¶ä¿®æ”¹ç»“æ„**

```
List<String> list = new ArrayList<>(List.of("a", "b", "c"));
for (String s : list) {
    if ("b".equals(s)) {
        list.remove(s); // âŒ æŠ›å¼‚å¸¸
    }
}
```

> æŠ›å‡ºï¼šjava.util.ConcurrentModificationException

**âœ… æ­£ç¡®åšæ³• 1ï¼šä½¿ç”¨ ListIterator**

```
List<String> list = new ArrayList<>(List.of("a", "b", "c"));
ListIterator<String> iter = list.listIterator();
while (iter.hasNext()) {
    String s = iter.next();
    if ("b".equals(s)) {
        iter.remove(); // âœ… å®‰å…¨ç§»é™¤
    }
}
```

**âœ… æ­£ç¡®åšæ³• 2ï¼šä½¿ç”¨ for å¾ªç¯ï¼ˆå€’åºæ›´ç¨³å¦¥ï¼‰**

```java
//æ­£åºï¼šåˆ é™¤å…ƒç´ åï¼Œè¦ä¿®æ­£ä¸‹ä¸‹æ ‡çš„å€¼.å› ä¸ºåˆ é™¤åå…ƒç´ æ•´ä½“å‘å‰ç§»äº†ä¸€æ­¥
for (int i = 0; i < list.size(); i++) {
    if ("b".equals(list.get(i))) {
        list.remove(i);
        i = i - 1;
    }
}

//å€’åº
for (int i = list.size() - 1; i >= 0; i--) {
    if ("b".equals(list.get(i))) {
        list.remove(i);
    }
}
```

**âœ… æ­£ç¡®åšæ³• 3ï¼šCopyOnWriteArrayListï¼ˆé€‚åˆè¯»å¤šå†™å°‘ï¼‰**

```
List<String> list = new CopyOnWriteArrayList<>(List.of("a", "b", "c"));
for (String s : list) {
    if ("b".equals(s)) {
        list.remove(s); // âœ… ä¸æŠ›å¼‚å¸¸ï¼Œä½†æ€§èƒ½ä½
    }
}
```

ğŸ§  æ€»ç»“å£è¯€ï¼š

> éå†ä¸­æ”¹ Listï¼Œå¢å¼º for ä¼šå´©æºƒï¼›ListIterator æœ€å®‰å…¨ï¼ŒCopyOnWrite è¯»å¤šè´µã€‚

### 4.listå¦‚ä½•å¿«é€Ÿåˆ é™¤æŸä¸ªæŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼Ÿ

`ArrayList`æä¾›äº†`remove(int index)`æ–¹æ³•æ¥åˆ é™¤æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼Œè¯¥æ–¹æ³•åœ¨åˆ é™¤å…ƒç´ åï¼Œä¼šå°†åç»­å…ƒç´ å‘å‰ç§»åŠ¨ï¼Œä»¥å¡«è¡¥è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ã€‚å¦‚æœåˆ é™¤çš„æ˜¯åˆ—è¡¨æœ«å°¾çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O (1)ï¼›å¦‚æœåˆ é™¤çš„æ˜¯åˆ—è¡¨ä¸­é—´çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O (n)ï¼Œn ä¸ºåˆ—è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨åç»­çš„å…ƒç´ ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
import java.util.ArrayList;
import java.util.List;

public class ArrayListRemoveExample {
    public static void main(String[] args) {
        List<Integer> list = new ArrayList<>();
        list.add(1);
        list.add(2);
        list.add(3);

        // åˆ é™¤ä¸‹æ ‡ä¸º1çš„å…ƒç´ 
        list.remove(1);

        System.out.println(list);
    }
}
```

`LinkedList`çš„`remove(int index)`æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥åˆ é™¤æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ã€‚å®ƒéœ€è¦å…ˆéå†åˆ°æŒ‡å®šä¸‹æ ‡ä½ç½®ï¼Œç„¶åä¿®æ”¹é“¾è¡¨çš„æŒ‡é’ˆæ¥åˆ é™¤å…ƒç´ ã€‚æ—¶é—´å¤æ‚åº¦ä¸º O (n)ï¼Œn ä¸ºè¦åˆ é™¤å…ƒç´ çš„ä¸‹æ ‡ã€‚ä¸è¿‡ï¼Œå¦‚æœå·²çŸ¥è¦åˆ é™¤çš„å…ƒç´ æ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹æˆ–å°¾èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¿®æ”¹å¤´æŒ‡é’ˆæˆ–å°¾æŒ‡é’ˆæ¥å®ç°åˆ é™¤ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O (1)ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
import java.util.LinkedList;
import java.util.List;

public class LinkedListRemoveExample {
    public static void main(String[] args) {
        List<Integer> list = new LinkedList<>();
        list.add(1);
        list.add(2);
        list.add(3);

        // åˆ é™¤ä¸‹æ ‡ä¸º1çš„å…ƒç´ 
        list.remove(1);

        System.out.println(list);
    }
}
```

`opyOnWriteArrayList`çš„`remove`æ–¹æ³•åŒæ ·å¯ä»¥åˆ é™¤æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ã€‚ç”±äº`CopyOnWriteArrayList`åœ¨å†™æ“ä½œæ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ‰€ä»¥åˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å–å†³äºæ•°ç»„çš„å¤åˆ¶é€Ÿåº¦ï¼Œé€šå¸¸ä¸º O (n)ï¼Œn ä¸ºæ•°ç»„çš„é•¿åº¦ã€‚ä½†åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå®ƒçš„åˆ é™¤æ“ä½œä¸ä¼šå½±å“è¯»æ“ä½œï¼Œå…·æœ‰è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
import java.util.concurrent.CopyOnWriteArrayList;

public class CopyOnWriteArrayListRemoveExample {
    public static void main(String[] args) {
        CopyOnWriteArrayList<Integer> list = new CopyOnWriteArrayList<>();
        list.add(1);
        list.add(2);
        list.add(3);

        // åˆ é™¤ä¸‹æ ‡ä¸º1çš„å…ƒç´ 
        list.remove(1);

        System.out.println(list);
    }
}
```

### 5.Arraylistå’ŒLinkedListçš„åŒºåˆ«ï¼Œå“ªä¸ªé›†åˆæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ

ArrayListå’ŒLinkedListéƒ½æ˜¯Javaä¸­å¸¸è§çš„é›†åˆç±»ï¼Œå®ƒä»¬éƒ½å®ç°äº†Listæ¥å£ã€‚

- **åº•å±‚æ•°æ®ç»“æ„ä¸åŒ**ï¼šArrayListä½¿ç”¨æ•°ç»„å®ç°ï¼Œé€šè¿‡ç´¢å¼•è¿›è¡Œå¿«é€Ÿè®¿é—®å…ƒç´ ã€‚LinkedListä½¿ç”¨é“¾è¡¨å®ç°ï¼Œé€šè¿‡èŠ‚ç‚¹ä¹‹é—´çš„æŒ‡é’ˆè¿›è¡Œå…ƒç´ çš„è®¿é—®å’Œæ“ä½œã€‚
- **æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ•ˆç‡ä¸åŒ**ï¼šArrayListåœ¨å°¾éƒ¨çš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ•ˆç‡è¾ƒé«˜ï¼Œä½†åœ¨ä¸­é—´æˆ–å¼€å¤´çš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ•ˆç‡è¾ƒä½ï¼Œéœ€è¦ç§»åŠ¨å…ƒç´ ã€‚LinkedListåœ¨ä»»æ„ä½ç½®çš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ•ˆç‡éƒ½æ¯”è¾ƒé«˜ï¼Œå› ä¸ºåªéœ€è¦è°ƒæ•´èŠ‚ç‚¹ä¹‹é—´çš„æŒ‡é’ˆï¼Œä½†æ˜¯LinkedListæ˜¯ä¸æ”¯æŒéšæœºè®¿é—®çš„ï¼Œæ‰€ä»¥é™¤äº†å¤´ç»“ç‚¹å¤–æ’å…¥å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯0(n)ï¼Œæ•ˆç‡ä¹Ÿä¸æ˜¯å¾ˆé«˜æ‰€ä»¥LinkedListåŸºæœ¬æ²¡äººç”¨ã€‚
- **éšæœºè®¿é—®çš„æ•ˆç‡ä¸åŒ**ï¼šArrayListæ”¯æŒé€šè¿‡ç´¢å¼•è¿›è¡Œå¿«é€Ÿéšæœºè®¿é—®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚LinkedListéœ€è¦ä»å¤´æˆ–å°¾å¼€å§‹éå†é“¾è¡¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚
- **ç©ºé—´å ç”¨**ï¼šArrayListåœ¨åˆ›å»ºæ—¶éœ€è¦åˆ†é…ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤ä¼šå ç”¨è¾ƒå¤§çš„ç©ºé—´ã€‚LinkedListæ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦å­˜å‚¨å…ƒç´ å’ŒæŒ‡é’ˆï¼Œå› æ­¤ç›¸å¯¹è¾ƒå°ã€‚
- **ä½¿ç”¨åœºæ™¯**ï¼šArrayListé€‚ç”¨äºé¢‘ç¹éšæœºè®¿é—®å’Œå°¾éƒ¨çš„æ’å…¥åˆ é™¤æ“ä½œï¼Œè€ŒLinkedListé€‚ç”¨äºé¢‘ç¹çš„ä¸­é—´æ’å…¥åˆ é™¤æ“ä½œå’Œä¸éœ€è¦éšæœºè®¿é—®çš„åœºæ™¯ã€‚
- **çº¿ç¨‹å®‰å…¨**ï¼šè¿™ä¸¤ä¸ªé›†åˆéƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒVectoræ˜¯çº¿ç¨‹å®‰å…¨çš„

### 6.ArrayListçº¿ç¨‹å®‰å…¨å—ï¼Ÿ

æŠŠArrayListå˜æˆçº¿ç¨‹å®‰å…¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒArrayListå˜æˆçº¿ç¨‹å®‰å…¨çš„æ–¹å¼æœ‰ï¼š

- ä½¿ç”¨Collectionsç±»çš„synchronizedListæ–¹æ³•å°†ArrayListåŒ…è£…æˆçº¿ç¨‹å®‰å…¨çš„Listï¼š

```java
List<String> synchronizedList = Collections.synchronizedList(arrayList);
```

- ä½¿ç”¨CopyOnWriteArrayListç±»ä»£æ›¿ArrayListï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„Listå®ç°ï¼š

```java
CopyOnWriteArrayList<String> copyOnWriteArrayList = new CopyOnWriteArrayList<>(arrayList);
```

- ä½¿ç”¨Vectorç±»ä»£æ›¿ArrayListï¼ŒVectoræ˜¯çº¿ç¨‹å®‰å…¨çš„Listå®ç°ï¼š

```java
Vector<String> vector = new Vector<>(arrayList);
```

### 7.ä¸ºä»€ä¹ˆArrayListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…·ä½“æ¥è¯´æ˜¯å“ªé‡Œä¸å®‰å…¨ï¼Ÿ

> [!important]
>
> ArrayList ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä»»ä½•åŒæ­¥æœºåˆ¶ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åŒæ—¶è¿›è¡Œ add()ã€remove() æˆ– get() æ“ä½œï¼Œä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€æ•°ç»„è¶Šç•Œã€å¹¶å‘ä¿®æ”¹å¼‚å¸¸ç­‰é—®é¢˜ã€‚ä¸»è¦åŸå› æ˜¯å†…éƒ¨æ“ä½œå¦‚ size++ å’Œæ•°ç»„ç§»åŠ¨æ˜¯éåŸå­çš„ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨ Collections.synchronizedList() åŒ…è£…ï¼Œæˆ–ä½¿ç”¨ CopyOnWriteArrayList ç­‰å¹¶å‘é›†åˆç±»ã€‚

åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹é¢‘ç¹å‘ ArrayList æ·»åŠ æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹ä¸‰ç§å¼‚å¸¸é—®é¢˜ï¼š

- **æ•°ç»„ä¸­å‡ºç° null å…ƒç´ **ï¼ˆæ˜æ˜æ²¡æœ‰æ·»åŠ  nullï¼‰
- **IndexOutOfBoundsException ç´¢å¼•è¶Šç•Œå¼‚å¸¸**
- **size ä¸å®é™… add æ¬¡æ•°ä¸ä¸€è‡´**

ä¸ºç†è§£è¿™äº›é—®é¢˜çš„æ ¹æºï¼Œæˆ‘ä»¬å…ˆçœ‹ ArrayList ä¸­æ·»åŠ å…ƒç´ çš„æ ¸å¿ƒå®ç°ï¼š

```
public boolean add(E e) {
    ensureCapacityInternal(size + 1); // æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
    elementData[size++] = e;          // å°†å…ƒç´ æ’å…¥å¹¶æ›´æ–° size
    return true;
}
```

å…¶ä¸­ï¼ŒensureCapacityInternal() çš„ä½œç”¨æ˜¯ç¡®ä¿ elementData æ•°ç»„å®¹é‡æ»¡è¶³æ–°å¢ä¸€ä¸ªå…ƒç´ çš„éœ€æ±‚ï¼Œè‹¥ä¸è¶³ï¼Œåˆ™é€šè¿‡ grow() æ–¹æ³•æ‰©å®¹ã€‚æ•´ä¸ªæµç¨‹å¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š

1. **åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹**ï¼šå¦‚æœ size + 1 > elementData.lengthï¼Œåˆ™æ‰©å®¹ï¼›
2. **æ’å…¥å…ƒç´ **ï¼šå°†å…ƒç´ æ”¾å…¥ elementData[size]ï¼›
3. **æ›´æ–° size**ï¼šé€šè¿‡ size++ å°†å…ƒç´ ä¸ªæ•°åŠ  1ã€‚

---

**ğŸ” ä¸‰ç±»é—®é¢˜çš„äº§ç”ŸåŸå› è¯¦è§£**

**1. â— æ•°ç»„ä¸­å‡ºç° null å…ƒç´ **

**å¹¶å‘æ’å…¥å¯¼è‡´è¦†ç›–å†²çª + size å¼‚å¸¸æ¨è¿›**

ç¤ºä¾‹åœºæ™¯ï¼š

- çº¿ç¨‹ A å’Œçº¿ç¨‹ B å‡ ä¹åŒæ—¶è¿›å…¥ add() æ–¹æ³•ï¼›
- æ­¤æ—¶ size = 9ï¼Œæ•°ç»„å®¹é‡æ˜¯ 10ï¼ŒäºŒè€…éƒ½åˆ¤æ–­æ— éœ€æ‰©å®¹ï¼›
- çº¿ç¨‹ A è®¾ç½®äº† elementData[9] = eï¼Œä½†è¿˜æœªæ‰§è¡Œ size++ï¼›
- çº¿ç¨‹ B æ­¤æ—¶ä¹Ÿæ‰§è¡Œ elementData[9] = e2ï¼Œå†æ¬¡è¦†ç›–åŸå€¼ï¼›
- ç„¶åä¸¤è€…ç›¸ç»§æ‰§è¡Œ size++ï¼Œæœ€ç»ˆ size = 11ï¼›
- ä½†å®é™…ä¸Šåªæ’å…¥äº† 2 ä¸ªå…ƒç´ ï¼ŒelementData[10] è¢«è·³è¿‡ï¼Œä¿æŒ nullã€‚

**2. â— ç´¢å¼•è¶Šç•Œå¼‚å¸¸**

**å¹¶å‘è¯¯åˆ¤æ‰©å®¹æ¡ä»¶ï¼Œå¯¼è‡´è¶Šç•Œå†™å…¥**

ç¤ºä¾‹åœºæ™¯ï¼š

- çº¿ç¨‹ A å’Œ B å‡ ä¹åŒæ—¶åˆ¤æ–­ size = 9ï¼Œå®¹é‡æ˜¯ 10ï¼Œå‡è®¤ä¸ºæ— éœ€æ‰©å®¹ï¼›
- çº¿ç¨‹ A è®¾ç½®å®Œ elementData[9] å¹¶å°† size++ æ”¹ä¸º 10ï¼›
- çº¿ç¨‹ B ç´§éšå…¶åå°è¯•å†™å…¥ elementData[10]ï¼›
- ç„¶è€Œæ•°ç»„æœ€å¤§ä¸‹æ ‡ä¸º 9ï¼ˆå®¹é‡ä¸º 10ï¼‰ï¼Œè§¦å‘ IndexOutOfBoundsExceptionã€‚

**3. â— size ä¸ç­‰äº add æ¬¡æ•°**

**size++ éåŸå­æ“ä½œå¯¼è‡´ä¸¢å¤±æ›´æ–°**

size++ å®é™…ä¸Šç”±ä¸‰æ­¥ç»„æˆï¼š

1. è¯»å– size å½“å‰å€¼ï¼›
2. å¯¹å€¼åŠ  1ï¼›
3. å°†ç»“æœå†™å› sizeï¼›

åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶è¯»å–åˆ°ç›¸åŒçš„æ—§å€¼ï¼Œå¹¶å„è‡ªåŠ  1 åå†™å›ï¼Œå¯¼è‡´å…¶ä¸­ä¸€ä¸ªæ›´æ–°è¢«è¦†ç›–ï¼Œä»è€Œå®é™…å¢é•¿æ¬¡æ•° < å®é™…è°ƒç”¨æ¬¡æ•°ã€‚

**âœ… æ€»ç»“**

| **é—®é¢˜ç±»å‹**  | **äº§ç”ŸåŸå› **                               |
| ------------- | ------------------------------------------ |
| æ•°ç»„å‡ºç° null | å¹¶å‘å†™å…¥åŒä¸€ç´¢å¼•ï¼Œå¯¼è‡´éƒ¨åˆ†ç´¢å¼•æœªè¢«æ­£ç¡®å†™å…¥ |
| ç´¢å¼•è¶Šç•Œå¼‚å¸¸  | å¹¶å‘æ—¶æ‰©å®¹åˆ¤æ–­å¤±æ•ˆï¼Œå†™å…¥è¶…å‡ºæ•°ç»„è¾¹ç•Œ       |
| size ä¸ä¸€è‡´   | éåŸå­æ“ä½œ size++ è¢«å¹¶å‘è¦†ç›–ï¼Œæ›´æ–°ä¸¢å¤±     |

**ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼š**

- ä½¿ç”¨ **çº¿ç¨‹å®‰å…¨é›†åˆ**ï¼šå¦‚ Vectorã€Collections.synchronizedList() æˆ– CopyOnWriteArrayList
- ä½¿ç”¨ **å¹¶å‘æ§åˆ¶æœºåˆ¶**ï¼šå¦‚åŠ é” synchronizedã€ReentrantLock
- æˆ–ä½¿ç”¨ **æ›´é«˜çº§çš„å¹¶å‘å®¹å™¨**ï¼šå¦‚ ConcurrentLinkedQueueã€ConcurrentSkipListMap

### 8.ArrayList å’Œ LinkedList çš„åº”ç”¨åœºæ™¯ï¼Ÿ

- ArrayListé€‚ç”¨äºéœ€è¦é¢‘ç¹è®¿é—®é›†åˆå…ƒç´ çš„åœºæ™¯ã€‚å®ƒåŸºäºæ•°ç»„å®ç°ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•å¿«é€Ÿè®¿é—®å…ƒç´ ï¼Œå› æ­¤åœ¨æŒ‰ç´¢å¼•æŸ¥æ‰¾ã€éå†å’Œéšæœºè®¿é—®å…ƒç´ çš„æ“ä½œä¸Šå…·æœ‰è¾ƒé«˜çš„æ€§èƒ½ã€‚å½“éœ€è¦é¢‘ç¹è®¿é—®å’Œéå†é›†åˆå…ƒç´ ï¼Œå¹¶ä¸”é›†åˆå¤§å°ä¸ç»å¸¸æ”¹å˜æ—¶ï¼Œæ¨èä½¿ç”¨ArrayList
- LinkedListé€‚ç”¨äºé¢‘ç¹è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„åœºæ™¯ã€‚å®ƒåŸºäºé“¾è¡¨å®ç°ï¼Œæ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œåªéœ€è¦è°ƒæ•´èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå› æ­¤åœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œä¸Šå…·æœ‰è¾ƒé«˜çš„æ€§èƒ½ã€‚å½“éœ€è¦é¢‘ç¹è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œæˆ–è€…é›†åˆå¤§å°ç»å¸¸æ”¹å˜æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨LinkedListã€‚

### 9.ArrayListçš„æ‰©å®¹æœºåˆ¶è¯´ä¸€ä¸‹

ArrayListåœ¨æ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœå½“å‰å…ƒç´ ä¸ªæ•°å·²ç»è¾¾åˆ°äº†å†…éƒ¨æ•°ç»„çš„å®¹é‡ä¸Šé™ï¼Œå°±ä¼šè§¦å‘æ‰©å®¹æ“ä½œã€‚

ArrayListçš„æ‰©å®¹æ“ä½œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

- è®¡ç®—æ–°çš„å®¹é‡ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–°çš„å®¹é‡ä¼šæ‰©å¤§ä¸ºåŸå®¹é‡çš„1.5å€ï¼ˆåœ¨JDK 10ä¹‹åï¼Œæ‰©å®¹ç­–ç•¥åšäº†è°ƒæ•´ï¼‰ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦è¶…è¿‡äº†æœ€å¤§å®¹é‡é™åˆ¶ã€‚
- åˆ›å»ºæ–°çš„æ•°ç»„ï¼šæ ¹æ®è®¡ç®—å¾—åˆ°çš„æ–°å®¹é‡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ›´å¤§çš„æ•°ç»„ã€‚
- å°†å…ƒç´ å¤åˆ¶ï¼šå°†åŸæ¥æ•°ç»„ä¸­çš„å…ƒç´ é€ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
- æ›´æ–°å¼•ç”¨ï¼šå°†ArrayListå†…éƒ¨æŒ‡å‘åŸæ•°ç»„çš„å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„ã€‚
- å®Œæˆæ‰©å®¹ï¼šæ‰©å®¹å®Œæˆåï¼Œå¯ä»¥ç»§ç»­æ·»åŠ æ–°å…ƒç´ ã€‚

ArrayListçš„æ‰©å®¹æ“ä½œæ¶‰åŠåˆ°æ•°ç»„çš„å¤åˆ¶å’Œå†…å­˜çš„é‡æ–°åˆ†é…ï¼Œæ‰€ä»¥åœ¨é¢‘ç¹æ·»åŠ å¤§é‡å…ƒç´ æ—¶ï¼Œæ‰©å®¹æ“ä½œå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚ä¸ºäº†å‡å°‘æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–ArrayListæ—¶é¢„åˆ†é…è¶³å¤Ÿå¤§çš„å®¹é‡ï¼Œé¿å…é¢‘ç¹è§¦å‘æ‰©å®¹æ“ä½œã€‚ä¹‹æ‰€ä»¥æ‰©å®¹æ˜¯ 1.5 å€ï¼Œæ˜¯å› ä¸º 1.5 å¯ä»¥å……åˆ†åˆ©ç”¨ç§»ä½æ“ä½œï¼Œå‡å°‘æµ®ç‚¹æ•°æˆ–è€…è¿ç®—æ—¶é—´å’Œè¿ç®—æ¬¡æ•°ã€‚

```java
// æ–°å®¹é‡è®¡ç®— 
int newCapacity = oldCapacity + (oldCapacity >> 1);
```

>[!note]
>
>oldCapacity >> 1 æ˜¯ä¸€ä¸ª ä½è¿ç®—è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºå¯¹ oldCapacity è¿›è¡Œå³ç§»ä¸€ä½ï¼Œç­‰åŒäºï¼šoldCapacity Ã· 2

### 10.çº¿ç¨‹å®‰å…¨çš„ Listï¼Œ CopyonWriteArraylistæ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„

CopyOnWriteArrayListåº•å±‚ä¹Ÿæ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„ä¿å­˜æ•°æ®ï¼Œä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°æ•°ç»„ï¼Œä¿è¯å½“å‰çº¿ç¨‹å¯¹æ•°ç»„å¯¹è±¡é‡æ–°èµ‹å€¼åï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥åŠæ—¶æ„ŸçŸ¥åˆ°ã€‚

```java
private transient volatile Object[] array;
```

åœ¨å†™å…¥æ“ä½œæ—¶ï¼ŒåŠ äº†ä¸€æŠŠäº’æ–¥é”ReentrantLockä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚

```java
public boolean add(E e) {
    //è·å–é”
    final ReentrantLock lock = this.lock;
    //åŠ é”
    lock.lock();
    try {
        //è·å–åˆ°å½“å‰Listé›†åˆä¿å­˜æ•°æ®çš„æ•°ç»„
        Object[] elements = getArray();
        //è·å–è¯¥æ•°ç»„çš„é•¿åº¦ï¼ˆè¿™æ˜¯ä¸€ä¸ªä¼ç¬”ï¼ŒåŒæ—¶lenä¹Ÿæ˜¯æ–°æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•å€¼ï¼‰
        int len = elements.length;
        //å°†å½“å‰æ•°ç»„æ‹·è´ä¸€ä»½çš„åŒæ—¶ï¼Œè®©å…¶é•¿åº¦åŠ 1
        Object[] newElements = Arrays.copyOf(elements, len + 1);
        //å°†åŠ å…¥çš„å…ƒç´ æ”¾åœ¨æ–°æ•°ç»„æœ€åä¸€ä½ï¼Œlenä¸æ˜¯æ—§æ•°ç»„é•¿åº¦å—ï¼Œä¸ºä»€ä¹ˆç°åœ¨ç”¨å®ƒå½“æˆæ–°æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡ï¼Ÿå»ºè®®è‡ªè¡Œç”»å›¾æ¨æ¼”ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ã€‚
        newElements[len] = e;
        //æ›¿æ¢å¼•ç”¨ï¼Œå°†æ•°ç»„çš„å¼•ç”¨æŒ‡å‘ç»™æ–°æ•°ç»„çš„åœ°å€
        setArray(newElements);
        return true;
    } finally {
        //é‡Šæ”¾é”
        lock.unlock();
    }
}
```

çœ‹åˆ°æºç å¯ä»¥çŸ¥é“å†™å…¥æ–°å…ƒç´ æ—¶ï¼Œé¦–å…ˆä¼šå…ˆå°†åŸæ¥çš„æ•°ç»„æ‹·è´ä¸€ä»½å¹¶ä¸”è®©åŸæ¥æ•°ç»„çš„é•¿åº¦+1åå°±å¾—åˆ°äº†ä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ–°æ•°ç»„é‡Œçš„å…ƒç´ å’Œæ—§æ•°ç»„çš„å…ƒç´ ä¸€æ ·å¹¶ä¸”é•¿åº¦æ¯”æ—§æ•°ç»„å¤šä¸€ä¸ªé•¿åº¦ï¼Œç„¶åå°†æ–°åŠ å…¥çš„å…ƒç´ æ”¾ç½®éƒ½åœ¨æ–°æ•°ç»„æœ€åä¸€ä¸ªä½ç½®åï¼Œç”¨æ–°æ•°ç»„çš„åœ°å€æ›¿æ¢æ‰è€æ•°ç»„çš„åœ°å€å°±èƒ½å¾—åˆ°æœ€æ–°çš„æ•°æ®äº†ã€‚åœ¨æˆ‘ä»¬æ‰§è¡Œæ›¿æ¢åœ°å€æ“ä½œä¹‹å‰ï¼Œè¯»å–çš„æ˜¯è€æ•°ç»„çš„æ•°æ®ï¼Œæ•°æ®æ˜¯æœ‰æ•ˆæ•°æ®ï¼›æ‰§è¡Œæ›¿æ¢åœ°å€æ“ä½œä¹‹åï¼Œè¯»å–çš„æ˜¯æ–°æ•°ç»„çš„æ•°æ®ï¼ŒåŒæ ·ä¹Ÿæ˜¯æœ‰æ•ˆæ•°æ®ï¼Œè€Œä¸”ä½¿ç”¨è¯¥æ–¹å¼èƒ½æ¯”è¯»å†™éƒ½åŠ é”è¦æ›´åŠ çš„æ•ˆç‡ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹è¯»æ“ä½œï¼Œè¯»æ˜¯æ²¡æœ‰åŠ é”çš„ï¼Œæ‰€ä»¥è¯»æ˜¯ä¸€ç›´éƒ½èƒ½è¯»

```java
public E get(int index) {
    return get(getArray(), index);
}
```

## Map

### 1.å¦‚ä½•å¯¹mapè¿›è¡Œå¿«é€Ÿéå†ï¼Ÿ

- ä½¿ç”¨for-eachå¾ªç¯å’ŒentrySet()æ–¹æ³•ï¼šè¿™æ˜¯ä¸€ç§è¾ƒä¸ºå¸¸è§å’Œç®€æ´çš„éå†æ–¹å¼ï¼Œå®ƒå¯ä»¥åŒæ—¶è·å–`Map`ä¸­çš„é”®å’Œå€¼

```java
import java.util.HashMap;
import java.util.Map;

public class MapTraversalExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();
        map.put("key1", 1);
        map.put("key2", 2);
        map.put("key3", 3);

        // ä½¿ç”¨for-eachå¾ªç¯å’ŒentrySet()éå†Map
        for (Map.Entry<String, Integer> entry : map.entrySet()) {
            System.out.println("Key: " + entry.getKey() + ", Value: " + entry.getValue());
        }
    }
}
```

- ä½¿ç”¨for-eachå¾ªç¯å’ŒkeySet()æ–¹æ³•ï¼šå¦‚æœåªéœ€è¦éå†`Map`ä¸­çš„é”®ï¼Œå¯ä»¥ä½¿ç”¨`keySet()`æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ€§èƒ½ä¹Ÿè¾ƒå¥½ã€‚

```java
import java.util.HashMap;
import java.util.Map;

public class MapTraversalExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();
        map.put("key1", 1);
        map.put("key2", 2);
        map.put("key3", 3);

        // ä½¿ç”¨for-eachå¾ªç¯å’ŒkeySet()éå†Mapçš„é”®
        for (String key : map.keySet()) {
            System.out.println("Key: " + key + ", Value: " + map.get(key));
        }
    }
}
```

- ä½¿ç”¨è¿­ä»£å™¨ï¼šé€šè¿‡è·å–Mapçš„entrySet()æˆ–keySet()çš„è¿­ä»£å™¨ï¼Œä¹Ÿå¯ä»¥å®ç°å¯¹Mapçš„éå†ï¼Œè¿™ç§æ–¹å¼åœ¨éœ€è¦åˆ é™¤å…ƒç´ ç­‰æ“ä½œæ—¶æ¯”è¾ƒæœ‰ç”¨ã€‚

```java
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.Map.Entry;

public class MapTraversalExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();
        map.put("key1", 1);
        map.put("key2", 2);
        map.put("key3", 3);

        // ä½¿ç”¨è¿­ä»£å™¨éå†Map
        Iterator<Entry<String, Integer>> iterator = map.entrySet().iterator();
        while (iterator.hasNext()) {
            Entry<String, Integer> entry = iterator.next();
            System.out.println("Key: " + entry.getKey() + ", Value: " + entry.getValue());
        }
    }
}
```

- ä½¿ç”¨ Lambda è¡¨è¾¾å¼å’ŒforEach()æ–¹æ³•ï¼šåœ¨ Java 8 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Lambda è¡¨è¾¾å¼å’Œ`forEach()`æ–¹æ³•æ¥éå†`Map`ï¼Œè¿™ç§æ–¹å¼æ›´åŠ ç®€æ´å’Œå‡½æ•°å¼ã€‚

```java
import java.util.HashMap;
import java.util.Map;

public class MapTraversalExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();
        map.put("key1", 1);
        map.put("key2", 2);
        map.put("key3", 3);

        // ä½¿ç”¨Lambdaè¡¨è¾¾å¼å’ŒforEach()æ–¹æ³•éå†Map
        map.forEach((key, value) -> System.out.println("Key: " + key + ", Value: " + value));
    }
}
```

- ä½¿ç”¨Stream APIï¼šJava 8 å¼•å…¥çš„`Stream API`ä¹Ÿå¯ä»¥ç”¨äºéå†`Map`ï¼Œå¯ä»¥å°†`Map`è½¬æ¢ä¸ºæµï¼Œç„¶åè¿›è¡Œå„ç§æ“ä½œã€‚

```java
import java.util.HashMap;
import java.util.Map;
import java.util.stream.Collectors;

public class MapTraversalExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();
        map.put("key1", 1);
        map.put("key2", 2);
        map.put("key3", 3);

        // ä½¿ç”¨Stream APIéå†Map
        map.entrySet().stream()
          .forEach(entry -> System.out.println("Key: " + entry.getKey() + ", Value: " + 								entry.getValue()));

        // è¿˜å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚è¿‡æ»¤ã€æ˜ å°„ç­‰
        Map<String, Integer> filteredMap = map.entrySet().stream()
                                            .filter(entry -> entry.getValue() > 1)
                                            .collect(Collectors.toMap(Map.Entry::getKey, 							Map.Entry::getValue));
        System.out.println(filteredMap);
    }
}
```

### 2.HashMapå®ç°åŸç†ä»‹ç»ä¸€ä¸‹ï¼Ÿ

åœ¨ JDK 1.7 ç‰ˆæœ¬ä¹‹å‰ï¼Œ HashMap æ•°æ®ç»“æ„æ˜¯æ•°ç»„å’Œé“¾è¡¨ï¼ŒHashMapé€šè¿‡å“ˆå¸Œç®—æ³•å°†å…ƒç´ çš„é”®ï¼ˆKeyï¼‰æ˜ å°„åˆ°æ•°ç»„ä¸­çš„æ§½ä½ï¼ˆBucketï¼‰ã€‚å¦‚æœå¤šä¸ªé”®æ˜ å°„åˆ°åŒä¸€ä¸ªæ§½ä½ï¼Œå®ƒä»¬ä¼šä»¥é“¾è¡¨çš„å½¢å¼å­˜å‚¨åœ¨åŒä¸€ä¸ªæ§½ä½ä¸Šï¼Œå› ä¸ºé“¾è¡¨çš„æŸ¥è¯¢æ—¶é—´æ˜¯O(n)ï¼Œæ‰€ä»¥å†²çªå¾ˆä¸¥é‡ï¼Œä¸€ä¸ªç´¢å¼•ä¸Šçš„é“¾è¡¨éå¸¸é•¿ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚ 

![img](assets/1750752905255-87cdbc55-05ee-4cb1-8820-2e5d859cae1b.webp) æ‰€ä»¥åœ¨ **JDK 1.8** ç‰ˆæœ¬çš„æ—¶å€™åšäº†ä¼˜åŒ–ï¼Œå½“ä¸€ä¸ªé“¾è¡¨çš„é•¿åº¦è¶…è¿‡8çš„æ—¶å€™å°±è½¬æ¢æ•°æ®ç»“æ„ï¼Œä¸å†ä½¿ç”¨é“¾è¡¨å­˜å‚¨ï¼Œè€Œæ˜¯ä½¿ç”¨**çº¢é»‘æ ‘**ï¼ŒæŸ¥æ‰¾æ—¶ä½¿ç”¨çº¢é»‘æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦Oï¼ˆlog n)ï¼Œå¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œä½†æ˜¯åœ¨æ•°é‡è¾ƒå°‘æ—¶ï¼Œå³æ•°é‡å°äº6æ—¶ï¼Œä¼šå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨ã€‚é“¾è¡¨åœ¨**å…ƒç´ æ•°é‡ â‰¥ 8 ä¸”æ»¡è¶³æ•°ç»„å®¹é‡ â‰¥ 64**æ—¶ï¼Œä¼šè¿›åŒ–ä¸ºçº¢é»‘æ ‘ï¼ˆTreeNode ç»“æ„)ã€‚ç•™å‡ºä¸€ä¸ªç¼“å†²åŒºï¼Œé¿å…é“¾è¡¨å’Œçº¢é»‘æ ‘é¢‘ç¹åœ¨ 7/8 ä¹‹é—´åå¤åˆ‡æ¢ã€‚

| **æ“ä½œ**      | **æ¡ä»¶**                            | **è¯´æ˜**                         |
| ------------- | ----------------------------------- | -------------------------------- |
| é“¾è¡¨ â†’ çº¢é»‘æ ‘ | é“¾è¡¨å…ƒç´ æ•° â‰¥ 8 ä¸”æ•°ç»„å®¹é‡ â‰¥ 64      | æ»¡è¶³åè§¦å‘ treeifyBin() è½¬æ ‘ç»“æ„ |
| çº¢é»‘æ ‘ â†’ é“¾è¡¨ | å…ƒç´ æ•° â‰¤ 6ï¼Œä¸”è§¦å‘ remove æˆ– resize | ä¼šè‡ªåŠ¨é€€åŒ–ä¸ºé“¾è¡¨ç»“æ„             |

![img](assets/1750752905299-c5d257bf-f0e0-4759-9742-8574f12301b2.webp)

### 3.äº†è§£çš„å“ˆå¸Œå†²çªè§£å†³æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ

- é“¾æ¥æ³•ï¼šä½¿ç”¨é“¾è¡¨æˆ–å…¶ä»–æ•°æ®ç»“æ„æ¥å­˜å‚¨å†²çªçš„é”®å€¼å¯¹ï¼Œå°†å®ƒä»¬é“¾æ¥åœ¨åŒä¸€ä¸ªå“ˆå¸Œæ¡¶ä¸­ã€‚
- å¼€æ”¾å¯»å€æ³•ï¼šåœ¨å“ˆå¸Œè¡¨ä¸­æ‰¾åˆ°å¦ä¸€ä¸ªå¯ç”¨çš„ä½ç½®æ¥å­˜å‚¨å†²çªçš„é”®å€¼å¯¹ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨é“¾è¡¨ä¸­ã€‚å¸¸è§çš„å¼€æ”¾å¯»å€æ–¹æ³•åŒ…æ‹¬çº¿æ€§æ¢æµ‹ã€äºŒæ¬¡æ¢æµ‹å’ŒåŒé‡æ•£åˆ—ã€‚
- å†å“ˆå¸Œæ³•ï¼ˆRehashingï¼‰ï¼šå½“å‘ç”Ÿå†²çªæ—¶ï¼Œä½¿ç”¨å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°å†æ¬¡è®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºæ§½æ¥å­˜å‚¨é”®å€¼å¯¹ã€‚
- å“ˆå¸Œæ¡¶æ‰©å®¹ï¼šå½“å“ˆå¸Œå†²çªè¿‡å¤šæ—¶ï¼Œå¯ä»¥åŠ¨æ€åœ°æ‰©å¤§å“ˆå¸Œæ¡¶çš„æ•°é‡ï¼Œé‡æ–°åˆ†é…é”®å€¼å¯¹ï¼Œä»¥å‡å°‘å†²çªçš„æ¦‚ç‡ã€‚

> å“ˆå¸Œæ¡¶

| **æ¦‚å¿µ**             | **å«ä¹‰**                                       | **æ˜¯å¦æŠ½è±¡** |
| -------------------- | ---------------------------------------------- | ------------ |
| **Bucketï¼ˆå“ˆå¸Œæ¡¶ï¼‰** | å­˜å‚¨å“ˆå¸Œå†²çªå…ƒç´ çš„â€œå•å…ƒâ€ï¼Œå¯èƒ½æ˜¯é“¾è¡¨ã€çº¢é»‘æ ‘ç­‰ | æ˜¯æ¦‚å¿µ       |
| **æ•°ç»„æ§½ä½**         | HashMap ä¸­ Node[] table çš„æ¯ä¸€é¡¹               | æ˜¯å®ç°       |

**âœ… åœ¨ HashMap ä¸­ï¼š**

- table æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆNode[]ï¼‰ï¼Œæ¯ä¸€ä¸ª table[i] æ˜¯ä¸€ä¸ªå“ˆå¸Œæ¡¶ã€‚
- æ‰€ä»¥ **æ•°ç»„æ§½ä½ = å“ˆå¸Œæ¡¶çš„å®ç°å®¹å™¨**ã€‚
- æ¯ä¸ªæ§½ä½ï¼ˆbucketï¼‰å¯ä»¥æ˜¯ï¼š
  - ç©ºï¼ˆnullï¼‰
  - ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼‰
  - ä¸€ä¸ªé“¾è¡¨
  - ä¸€ä¸ªçº¢é»‘æ ‘

### 4.HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ

HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±ã€è¦†ç›–ï¼Œç”šè‡³æ­»å¾ªç¯çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯JDK 1.7ç‰ˆæœ¬æ‰©å®¹æ—¶å®¹æ˜“äº§ç”Ÿç¯å½¢é“¾è¡¨å¯¼è‡´æ­»é”ã€‚è™½ç„¶JDK 1.8ä¼˜åŒ–äº†ç»“æ„ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ï¼Œä½†å¹¶æ²¡æœ‰è§£å†³çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚è¦åœ¨å¤šçº¿ç¨‹ä¸‹å®‰å…¨ä½¿ç”¨HashMapï¼Œå¯ä»¥ç”¨Collections.synchronizedMapåŒ…è£¹ï¼Œæˆ–è€…æ›´æ¨èç”¨ConcurrentHashMapï¼Œå®ƒä¸“é—¨ä¸ºå¹¶å‘è®¾è®¡ï¼Œæ€§èƒ½æ›´å¥½æ›´å®‰å…¨ã€‚ç®€å•æ¥è¯´ï¼ŒHashMapä¸é€‚åˆå¤šçº¿ç¨‹ç¯å¢ƒï¼Œæƒ³å®‰å…¨ç”¨å¾—æ¢çº¿ç¨‹å®‰å…¨çš„ç±»ã€‚

### 5.hashmapçš„putè¿‡ç¨‹ä»‹ç»ä¸€ä¸‹

### ![img](assets/1750756523425-263268db-1e6a-4970-a6e9-035a544e28a4.webp)

HashMapçš„put()æ–¹æ³•ç”¨äºå‘HashMapä¸­æ·»åŠ é”®å€¼å¯¹ï¼Œå½“è°ƒç”¨HashMapçš„put()æ–¹æ³•æ—¶ï¼Œä¼šæŒ‰ç…§ä»¥ä¸‹è¯¦ç»†æµç¨‹æ‰§è¡Œï¼ˆJDK8 1.8ç‰ˆæœ¬ï¼‰ï¼š

> ç¬¬ä¸€æ­¥ï¼šæ ¹æ®è¦æ·»åŠ çš„é”®çš„å“ˆå¸Œç è®¡ç®—åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰ã€‚

> ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥è¯¥ä½ç½®æ˜¯å¦ä¸ºç©ºï¼ˆå³æ²¡æœ‰é”®å€¼å¯¹å­˜åœ¨ï¼‰

- å¦‚æœä¸ºç©ºï¼Œåˆ™ç›´æ¥åœ¨è¯¥ä½ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„Entryå¯¹è±¡æ¥å­˜å‚¨é”®å€¼å¯¹ã€‚å°†è¦æ·»åŠ çš„é”®å€¼å¯¹ä½œä¸ºè¯¥Entryçš„é”®å’Œå€¼ï¼Œå¹¶ä¿å­˜åœ¨æ•°ç»„çš„å¯¹åº”ä½ç½®ã€‚å°†HashMapçš„ä¿®æ”¹æ¬¡æ•°ï¼ˆmodCountï¼‰åŠ 1ï¼Œä»¥ä¾¿åœ¨è¿›è¡Œè¿­ä»£æ—¶å‘ç°å¹¶å‘ä¿®æ”¹ã€‚

> ç¬¬ä¸‰æ­¥ï¼šå¦‚æœè¯¥ä½ç½®å·²ç»å­˜åœ¨å…¶ä»–é”®å€¼å¯¹ï¼Œæ£€æŸ¥è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªé”®å€¼å¯¹çš„å“ˆå¸Œç å’Œé”®æ˜¯å¦ä¸è¦æ·»åŠ çš„é”®å€¼å¯¹ç›¸åŒï¼Ÿ

- å¦‚æœç›¸åŒï¼Œåˆ™è¡¨ç¤ºæ‰¾åˆ°äº†ç›¸åŒçš„é”®ï¼Œç›´æ¥å°†æ–°çš„å€¼æ›¿æ¢æ—§çš„å€¼ï¼Œå®Œæˆæ›´æ–°æ“ä½œã€‚

> ç¬¬å››æ­¥ï¼šå¦‚æœç¬¬ä¸€ä¸ªé”®å€¼å¯¹çš„å“ˆå¸Œç å’Œé”®ä¸ç›¸åŒï¼Œåˆ™éœ€è¦éå†é“¾è¡¨æˆ–çº¢é»‘æ ‘æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰ç›¸åŒçš„é”®ï¼š

å¦‚æœé”®å€¼å¯¹é›†åˆæ˜¯é“¾è¡¨ç»“æ„ï¼Œä»é“¾è¡¨çš„å¤´éƒ¨å¼€å§‹é€ä¸ªæ¯”è¾ƒé”®çš„å“ˆå¸Œç å’Œequals()æ–¹æ³•ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸åŒçš„é”®æˆ–è¾¾åˆ°é“¾è¡¨æœ«å°¾ã€‚

- å¦‚æœæ‰¾åˆ°äº†ç›¸åŒçš„é”®ï¼Œåˆ™ä½¿ç”¨æ–°çš„å€¼å–ä»£æ—§çš„å€¼ï¼Œå³æ›´æ–°é”®å¯¹åº”çš„å€¼ã€‚
- å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åŒçš„é”®ï¼Œåˆ™å°†æ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨ã€‚

å¦‚æœé”®å€¼å¯¹é›†åˆæ˜¯çº¢é»‘æ ‘ç»“æ„ï¼Œåœ¨çº¢é»‘æ ‘ä¸­ä½¿ç”¨å“ˆå¸Œç å’Œequals()æ–¹æ³•è¿›è¡ŒæŸ¥æ‰¾ã€‚æ ¹æ®é”®çš„å“ˆå¸Œç ï¼Œå®šä½åˆ°çº¢é»‘æ ‘ä¸­çš„æŸä¸ªèŠ‚ç‚¹ï¼Œç„¶åé€ä¸ªæ¯”è¾ƒé”®ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸åŒçš„é”®æˆ–è¾¾åˆ°çº¢é»‘æ ‘æœ«å°¾ã€‚

- å¦‚æœæ‰¾åˆ°äº†ç›¸åŒçš„é”®ï¼Œåˆ™ä½¿ç”¨æ–°çš„å€¼å–ä»£æ—§çš„å€¼ï¼Œå³æ›´æ–°é”®å¯¹åº”çš„å€¼ã€‚
- å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åŒçš„é”®ï¼Œåˆ™å°†æ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°çº¢é»‘æ ‘ä¸­ã€‚

> ç¬¬äº”æ­¥ï¼šæ£€æŸ¥é“¾è¡¨é•¿åº¦æ˜¯å¦è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º8ï¼‰ï¼š

- å¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ï¼Œä¸”HashMapçš„æ•°ç»„é•¿åº¦å¤§äºç­‰äº64ï¼Œåˆ™ä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚

> ç¬¬å…­æ­¥ï¼šæ£€æŸ¥è´Ÿè½½å› å­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º0.75ï¼‰ï¼š

- å¦‚æœé”®å€¼å¯¹çš„æ•°é‡ï¼ˆsizeï¼‰ä¸æ•°ç»„çš„é•¿åº¦çš„æ¯”å€¼å¤§äºé˜ˆå€¼ï¼Œåˆ™éœ€è¦è¿›è¡Œæ‰©å®¹æ“ä½œã€‚

> ç¬¬ä¸ƒæ­¥ï¼šæ‰©å®¹æ“ä½œï¼š

- åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸¤å€å¤§å°çš„æ•°ç»„ã€‚
- å°†æ—§æ•°ç»„ä¸­çš„é”®å€¼å¯¹é‡æ–°è®¡ç®—å“ˆå¸Œç å¹¶åˆ†é…åˆ°æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚
- æ›´æ–°HashMapçš„æ•°ç»„å¼•ç”¨å’Œé˜ˆå€¼å‚æ•°ã€‚

> ç¬¬å…«æ­¥ï¼šå®Œæˆæ·»åŠ æ“ä½œã€‚

æ­¤å¤–ï¼ŒHashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œéœ€è¦é‡‡å–é¢å¤–çš„åŒæ­¥æªæ–½æˆ–ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ConcurrentHashMapã€‚

### 6.HashMapçš„put(key,val)å’Œget(key)è¿‡ç¨‹

- ä½ å¾€ HashMap é‡Œæ”¾æ•°æ®çš„æ—¶å€™ï¼Œä¼šå…ˆç”¨ key çš„ hashCode() ç®—å‡ºå®ƒåº”è¯¥æ”¾åœ¨å“ªä¸ªâ€œæ¡¶â€é‡Œã€‚
- å¦‚æœé‚£ä¸ªæ¡¶ç©ºç€ï¼Œç›´æ¥æ”¾è¿›å»ï¼›å¦‚æœå·²ç»æœ‰åˆ«çš„å…ƒç´ äº†ï¼Œå°±ä¼šæŠŠå®ƒä»¬ä¸²æˆé“¾è¡¨ã€‚
- ä½†æ˜¯ä» Java 8 å¼€å§‹ï¼Œå¦‚æœé“¾è¡¨å¤ªé•¿äº†ï¼ˆè¶…è¿‡8ä¸ªå…ƒç´ ï¼‰ï¼Œå®ƒä¼šæŠŠé“¾è¡¨æ¢æˆçº¢é»‘æ ‘ï¼Œè¿™æ ·æŸ¥æ‰¾å’Œæ’å…¥å°±æ›´å¿«äº†ã€‚
- å¦å¤–ï¼Œå½“å­˜çš„å…ƒç´ è¶Šæ¥è¶Šå¤šï¼Œè¶…è¿‡äº†é»˜è®¤çš„è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰ï¼ŒHashMap ä¼šè‡ªåŠ¨æ‰©å®¹ï¼Œå®¹é‡ç¿»å€ï¼Œé‡æ–°ç»™å…ƒç´ åˆ†æ¡¶ã€‚
- å–æ•°æ®æ—¶ï¼ŒHashMap è¿˜æ˜¯å…ˆç”¨ hashCode() æ‰¾åˆ°å¯¹åº”çš„æ¡¶ï¼Œç„¶ååœ¨é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘é‡Œç”¨ equals() æ‰¾åˆ°å¯¹åº”çš„ keyï¼Œæ‹¿åˆ°å¯¹åº”çš„ valueã€‚

### 7.hashmap è°ƒç”¨getæ–¹æ³•ä¸€å®šå®‰å…¨å—ï¼Ÿ

ä¸æ˜¯ï¼Œè°ƒç”¨ get æ–¹æ³•æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š

- **ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆNullPointerExceptionï¼‰**ï¼šå¦‚æœä½ å°è¯•ç”¨ `null` ä½œä¸ºé”®è°ƒç”¨ `get` æ–¹æ³•ï¼Œè€Œ `HashMap` æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼ˆå³ä¸º `null`ï¼‰ï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ä¸è¿‡ï¼Œå¦‚æœ `HashMap` å·²ç»åˆå§‹åŒ–ï¼Œä½¿ç”¨ `null` ä½œä¸ºé”®æ˜¯å…è®¸çš„ï¼Œå› ä¸º `HashMap` æ”¯æŒ `null` é”®ã€‚
- **çº¿ç¨‹å®‰å…¨**ï¼š`HashMap` æœ¬èº«ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæ²¡æœ‰é€‚å½“çš„åŒæ­¥æªæ–½ï¼ŒåŒæ—¶å¯¹ `HashMap` è¿›è¡Œè¯»å†™æ“ä½œå¯èƒ½ä¼šå¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨ `get` æ–¹æ³•è¯»å–æ•°æ®ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹äº†ç»“æ„ï¼ˆå¦‚å¢åŠ æˆ–åˆ é™¤å…ƒç´ ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯»å–æ“ä½œå¾—åˆ°é”™è¯¯çš„ç»“æœæˆ–æŠ›å‡º `ConcurrentModificationException`ã€‚å¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨ç±»ä¼¼ `HashMap` çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ `ConcurrentHashMap`ã€‚

### 8.HashMapä¸€èˆ¬ç”¨ä»€ä¹ˆåšKeyï¼Ÿ

- **Keyæœ€å¥½æ˜¯ä¸å¯å˜å¯¹è±¡**ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡çš„å†…å®¹ä¸èƒ½å˜ï¼Œæ¯”å¦‚å¸¸ç”¨çš„ Stringã€Integer è¿™äº›ä¸å¯å˜ç±»å‹ç‰¹åˆ«é€‚åˆåšKeyã€‚
- è¿™æ ·åšæ˜¯ä¸ºäº†ä¿è¯hashCode()å’Œequals()çš„å€¼ä¸ä¼šå˜ï¼Œå¦åˆ™å¦‚æœKeyå¯¹è±¡å†…å®¹å˜äº†ï¼ŒHashMapå°±æ‰¾ä¸åˆ°å¯¹åº”çš„æ¡¶äº†ï¼Œä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–æŸ¥æ‰¾å¤±è´¥ã€‚
- ä½ ä¹Ÿå¯ä»¥ç”¨è‡ªå®šä¹‰ç±»åšKeyï¼Œä½†ä¸€å®šè¦é‡å†™hashCode()å’Œequals()æ–¹æ³•ï¼Œä¿è¯ä¸¤ä¸ªç›¸ç­‰çš„å¯¹è±¡è¿”å›ç›¸åŒçš„hashå€¼ï¼Œä¸”åˆ¤æ–­ç›¸ç­‰çš„é€»è¾‘æ­£ç¡®ã€‚
- æ€»ç»“ä¸€å¥è¯å°±æ˜¯ï¼š**Keyè¦ä¿è¯å“ˆå¸Œå€¼ç¨³å®šä¸”equalsåˆ¤ç­‰æ­£ç¡®ï¼Œé€šå¸¸ç”¨ä¸å¯å˜ç±»å‹æˆ–é‡å†™äº†hashCode/equalsçš„è‡ªå®šä¹‰å¯¹è±¡ã€‚**

### 9.ä¸ºä»€ä¹ˆHashMapè¦ç”¨çº¢é»‘æ ‘è€Œä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Ÿ

- å¹³è¡¡äºŒå‰æ ‘è¿½æ±‚çš„æ˜¯ä¸€ç§ **â€œå®Œå…¨å¹³è¡¡â€** çŠ¶æ€ï¼šä»»ä½•ç»“ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸ä¼šè¶…è¿‡ 1ï¼Œä¼˜åŠ¿æ˜¯æ ‘çš„ç»“ç‚¹æ˜¯å¾ˆå¹³å‡åˆ†é…çš„ã€‚è¿™ä¸ªè¦æ±‚å®åœ¨æ˜¯å¤ªä¸¥äº†ï¼Œå¯¼è‡´æ¯æ¬¡è¿›è¡Œæ’å…¥/åˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå‡ ä¹éƒ½ä¼šç ´åå¹³è¡¡æ ‘çš„ç¬¬äºŒä¸ªè§„åˆ™ï¼Œè¿›è€Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡**å·¦æ—‹**å’Œ**å³æ—‹**æ¥è¿›è¡Œè°ƒæ•´ï¼Œä½¿ä¹‹å†æ¬¡æˆä¸ºä¸€é¢—ç¬¦åˆè¦æ±‚çš„å¹³è¡¡æ ‘ã€‚
- çº¢é»‘æ ‘ä¸è¿½æ±‚è¿™ç§å®Œå…¨å¹³è¡¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿½æ±‚ä¸€ç§ **â€œå¼±å¹³è¡¡â€** çŠ¶æ€ï¼šæ•´ä¸ªæ ‘æœ€é•¿è·¯å¾„ä¸ä¼šè¶…è¿‡æœ€çŸ­è·¯å¾„çš„ 2 å€ã€‚ä¼˜åŠ¿æ˜¯è™½ç„¶ç‰ºç‰²äº†ä¸€éƒ¨åˆ†æŸ¥æ‰¾çš„æ€§èƒ½æ•ˆç‡ï¼Œä½†æ˜¯èƒ½å¤Ÿæ¢å–ä¸€éƒ¨åˆ†ç»´æŒæ ‘å¹³è¡¡çŠ¶æ€çš„æˆæœ¬ã€‚ä¸å¹³è¡¡æ ‘ä¸åŒçš„æ˜¯ï¼Œçº¢é»‘æ ‘åœ¨æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œï¼Œ**ä¸ä¼šåƒå¹³è¡¡æ ‘é‚£æ ·ï¼Œé¢‘ç¹ç€ç ´åçº¢é»‘æ ‘çš„è§„åˆ™ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢‘ç¹ç€è°ƒæ•´**ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆå¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨çº¢é»‘æ ‘çš„åŸå› ã€‚

### 10.hashmap keyå¯ä»¥ä¸ºnullå—ï¼Ÿ

å¯ä»¥ä¸º nullã€‚

- hashMapä¸­ä½¿ç”¨hash()æ–¹æ³•æ¥è®¡ç®—keyçš„å“ˆå¸Œå€¼ï¼Œå½“keyä¸ºç©ºæ—¶ï¼Œç›´æ¥ä»¤keyçš„å“ˆå¸Œå€¼ä¸º0ï¼Œä¸èµ°key.hashCode()æ–¹æ³•ï¼›

![img](assets\1750770735659-9215dd87-252c-46c4-b227-52581c8c54a1.webp)

- hashMapè™½ç„¶æ”¯æŒkeyå’Œvalueä¸ºnullï¼Œä½†æ˜¯nullä½œä¸ºkeyåªèƒ½æœ‰ä¸€ä¸ªï¼Œnullä½œä¸ºvalueå¯ä»¥æœ‰å¤šä¸ªï¼›
- å› ä¸ºhashMapä¸­ï¼Œå¦‚æœkeyå€¼ä¸€æ ·ï¼Œé‚£ä¹ˆä¼šè¦†ç›–ç›¸åŒkeyå€¼çš„valueä¸ºæœ€æ–°ï¼Œæ‰€ä»¥keyä¸ºnullåªèƒ½æœ‰ä¸€ä¸ª

### 11.é‡å†™HashMapçš„equalå’Œhashcodeæ–¹æ³•éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ

åœ¨ `HashMap` ä¸­ï¼Œ`hashCode()` ç”¨äºç¡®å®š key çš„å­˜å‚¨ä½ç½®ï¼ˆå³æ¡¶ç´¢å¼•ï¼‰ï¼Œ`equals()` ç”¨äºåˆ¤æ–­ key æ˜¯å¦ç›¸åŒã€‚

å½“æˆ‘ä»¬å‘ `HashMap` ä¸­å­˜æ”¾å…ƒç´ æ—¶ï¼š

1. ä¼šå…ˆè°ƒç”¨ `hashCode()` è®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼›
2. å†ç”¨å“ˆå¸Œå€¼å®šä½æ¡¶ï¼›
3. å¦‚æœæ¡¶ä¸­å·²æœ‰å…ƒç´ ï¼Œåˆ™ç”¨ `equals()` æ¯”è¾ƒæ˜¯å¦æ˜¯ç›¸åŒçš„ keyã€‚

å¦‚æœè¿™ä¸¤ä¸ªæ–¹æ³•æ²¡æœ‰æ­£ç¡®é‡å†™ï¼š

- ä¸åŒçš„ key å¯èƒ½è¢«è¯¯åˆ¤ä¸ºç›¸åŒï¼Œå¯¼è‡´å€¼è¢«è¦†ç›–ï¼›
- ç›¸åŒçš„ key å¯èƒ½è¢«åˆ¤æ–­ä¸ºä¸åŒï¼Œå¯¼è‡´æ— æ³•è¦†ç›–æˆ–æŸ¥æ‰¾å¤±è´¥ã€‚

å› æ­¤ï¼Œ**å¿…é¡»åŒæ—¶é‡å†™ `hashCode()` å’Œ `equals()` æ–¹æ³•ï¼Œå¹¶ç¡®ä¿é€»è¾‘ä¸€è‡´**ã€‚

æ ¹æ®è§„èŒƒï¼š

- å¦‚æœä¸¤ä¸ªå¯¹è±¡ `equals()` ç›¸ç­‰ï¼Œåˆ™å®ƒä»¬çš„ `hashCode()` å¿…é¡»ç›¸ç­‰ï¼›
- åä¹‹ä¸æˆç«‹ã€‚

è¿™å¯¹ä¿è¯ `HashMap`ã€`HashSet` ç­‰å“ˆå¸Œç»“æ„çš„æ­£ç¡®æ€§éå¸¸é‡è¦ã€‚

### 12.é‡å†™HashMapçš„equalæ–¹æ³•ä¸å½“ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ

HashMapåœ¨æ¯”è¾ƒå…ƒç´ æ—¶ï¼Œä¼šå…ˆé€šè¿‡hashCodeè¿›è¡Œæ¯”è¾ƒï¼Œç›¸åŒçš„æƒ…å†µä¸‹å†é€šè¿‡equalsè¿›è¡Œæ¯”è¾ƒã€‚æ‰€ä»¥ equalsç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼ŒhashCodeä¸€å®šç›¸ç­‰ã€‚hashCodeç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œequalsä¸ä¸€å®šç›¸ç­‰ï¼ˆæ¯”å¦‚å“ˆå¸Œå†²çªçš„æƒ…å†µï¼‰é‡å†™äº†equalsæ–¹æ³•ï¼Œä¸é‡å†™hashCodeæ–¹æ³•æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°equalsæ–¹æ³•è¿”å›ä¸ºtrueï¼Œè€ŒhashCodeæ–¹æ³•å´è¿”å›falseï¼Œè¿™æ ·çš„ä¸€ä¸ªåæœä¼šå¯¼è‡´åœ¨hashmapç­‰ç±»ä¸­å­˜å‚¨å¤šä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ï¼Œå¯¼è‡´å‡ºç°è¦†ç›–å­˜å‚¨çš„æ•°æ®çš„é—®é¢˜ï¼Œè¿™ä¸hashmapåªèƒ½æœ‰å”¯ä¸€çš„keyçš„è§„èŒƒä¸ç¬¦åˆã€‚

### 13.åˆ—ä¸¾HashMapåœ¨å¤šçº¿ç¨‹ä¸‹å¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ

- JDK1.7ä¸­çš„ HashMap ä½¿ç”¨å¤´æ’æ³•æ’å…¥å…ƒç´ ï¼Œåœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ‰©å®¹çš„æ—¶å€™æœ‰å¯èƒ½å¯¼è‡´ç¯å½¢é“¾è¡¨çš„å‡ºç°ï¼Œå½¢æˆæ­»å¾ªç¯ã€‚å› æ­¤ï¼ŒJDK1.8ä½¿ç”¨å°¾æ’æ³•æ’å…¥å…ƒç´ ï¼Œåœ¨æ‰©å®¹æ—¶ä¼šä¿æŒé“¾è¡¨å…ƒç´ åŸæœ¬çš„é¡ºåºï¼Œä¸ä¼šå‡ºç°ç¯å½¢é“¾è¡¨çš„é—®é¢˜ã€‚
- å¤šçº¿ç¨‹åŒæ—¶æ‰§è¡Œ put æ“ä½œï¼Œå¦‚æœè®¡ç®—å‡ºæ¥çš„ç´¢å¼•ä½ç½®æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¼šé€ æˆå‰ä¸€ä¸ª key è¢«åä¸€ä¸ª key è¦†ç›–ï¼Œä»è€Œå¯¼è‡´å…ƒç´ çš„ä¸¢å¤±ã€‚æ­¤é—®é¢˜åœ¨JDK 1.7å’Œ JDK 1.8 ä¸­éƒ½å­˜åœ¨ã€‚

### 14.HashMapçš„æ‰©å®¹æœºåˆ¶ä»‹ç»ä¸€ä¸‹

hashMapé»˜è®¤çš„è´Ÿè½½å› å­æ˜¯0.75ï¼Œå³å¦‚æœhashmapä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡äº†æ€»å®¹é‡75%ï¼Œåˆ™ä¼šè§¦å‘æ‰©å®¹ï¼Œæ‰©å®¹åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š

- **ç¬¬1æ­¥**æ˜¯å¯¹å“ˆå¸Œè¡¨é•¿åº¦çš„æ‰©å±•ï¼ˆ2å€ï¼‰
- **ç¬¬2æ­¥**æ˜¯å°†æ—§å“ˆå¸Œè¡¨ä¸­çš„æ•°æ®æ”¾åˆ°æ–°çš„å“ˆå¸Œè¡¨ä¸­ã€‚

ç”±äºæ•°ç»„çš„å®¹é‡æ˜¯ä»¥2çš„å¹‚æ¬¡æ–¹æ‰©å®¹çš„ï¼Œé‚£ä¹ˆä¸€ä¸ªEntityåœ¨æ‰©å®¹æ—¶ï¼Œæ–°çš„ä½ç½®è¦ä¹ˆåœ¨**åŸä½ç½®**ï¼Œè¦ä¹ˆåœ¨**åŸé•¿åº¦+åŸä½ç½®**çš„ä½ç½®ã€‚åŸå› å¦‚ä¸‹å›¾ï¼š

![img](assets\1750771215968-ada6c5ce-61cd-4306-b907-30d8ca419f4d.webp)æ•°ç»„é•¿åº¦å˜ä¸ºåŸæ¥çš„2å€ï¼Œè¡¨ç°åœ¨äºŒè¿›åˆ¶ä¸Šå°±æ˜¯**å¤šäº†ä¸€ä¸ªé«˜ä½å‚ä¸æ•°ç»„ä¸‹æ ‡ç¡®å®š**ã€‚æ­¤æ—¶ï¼Œä¸€ä¸ªå…ƒç´ é€šè¿‡hashè½¬æ¢åæ ‡çš„æ–¹æ³•è®¡ç®—åï¼Œæ°å¥½å‡ºç°ä¸€ä¸ªç°è±¡ï¼šæœ€é«˜ä½æ˜¯0åˆ™åæ ‡ä¸å˜ï¼Œæœ€é«˜ä½æ˜¯1åˆ™åæ ‡å˜ä¸ºâ€œ10000+åŸåæ ‡â€ï¼Œå³â€œåŸé•¿åº¦+åŸåæ ‡â€ã€‚å¦‚ä¸‹å›¾ï¼š

![img](assets\1750771216988-b2e9692a-ad69-4425-a9de-7fc613080753.webp)

å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å……HashMapçš„æ—¶å€™ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¥½äº†ï¼Œæ˜¯0çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯1çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCapâ€ã€‚

>[!important]
>
>å½“æˆ‘ä»¬ç”¨ `hash & (table.length - 1)` æ¥è®¡ç®—æ¡¶ç´¢å¼•æ—¶ï¼Œå…¶å®å°±æ˜¯å– hash å€¼çš„ä½å‡ ä½ã€‚å¦‚æœå®¹é‡æ˜¯ 32ï¼ˆ2^5ï¼‰ï¼Œæ©ç æ˜¯ 31ï¼ˆäºŒè¿›åˆ¶ 11111ï¼‰ï¼Œè¡¨ç¤ºåªå– hash çš„**ä½ 5 ä½**ï¼Œè¿™å°±å®ç°äº†**å¿«é€Ÿçš„æ¨¡è¿ç®—**ï¼ˆæ¯” `hash % capacity` å¿«ï¼‰ã€‚æ©ç äºŒè¿›åˆ¶è¶Šå¤šï¼Œå–hashçš„ä½æ•°è¶Šå¤šã€‚

### 15.HashMapçš„å¤§å°ä¸ºä»€ä¹ˆæ˜¯2çš„næ¬¡æ–¹å¤§å°å‘¢ï¼Ÿ

å› ä¸ºè¿™æ ·èƒ½ç”¨ä½è¿ç®—ä»£æ›¿æ¨¡è¿ç®—ï¼Œæé«˜æ€§èƒ½ã€‚å…·ä½“æ¥è¯´ï¼ŒHashMap é€šè¿‡ `hash & (capacity - 1)` æ¥è®¡ç®—å…ƒç´ æ”¾åœ¨å“ªä¸ªæ¡¶é‡Œã€‚å¦‚æœå®¹é‡æ˜¯ 2 çš„å¹‚æ¬¡æ–¹ï¼Œæ¯”å¦‚ 16 æˆ– 32ï¼Œé‚£ä¹ˆ `capacity - 1` åœ¨äºŒè¿›åˆ¶ä¸­å°±æ˜¯ä¸€ä¸²è¿ç»­çš„ 1ï¼Œè¿™æ ·ä½è¿ç®—èƒ½å¿«é€Ÿå®šä½æ¡¶çš„ä½ç½®ï¼Œæ•ˆç‡è¿œé«˜äºå–æ¨¡è¿ç®—ã€‚å¦‚æœå®¹é‡ä¸æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Œä½è¿ç®—å°±æ²¡æ³•å‡†ç¡®å®šä½ï¼Œå¯èƒ½å¯¼è‡´å…ƒç´ åˆ†å¸ƒä¸å‡æˆ–è€…å“ˆå¸Œå†²çªæ›´å¤šã€‚æ‰€ä»¥ï¼Œè®¾è®¡æˆ2çš„å¹‚æ¬¡æ–¹æ˜¯ä¸ºäº†ä¿è¯å¿«é€Ÿä¸”å‡åŒ€çš„å…ƒç´ å®šä½ã€‚

### 16.å¾€hashmapå­˜20ä¸ªå…ƒç´ ï¼Œä¼šæ‰©å®¹å‡ æ¬¡ï¼Ÿ

å½“æ’å…¥ 20 ä¸ªå…ƒç´ æ—¶ï¼ŒHashMap çš„æ‰©å®¹è¿‡ç¨‹å¦‚ä¸‹ï¼š**åˆå§‹å®¹é‡**ï¼š16

- æ’å…¥ç¬¬ 1 åˆ°ç¬¬ 12 ä¸ªå…ƒç´ æ—¶ï¼Œä¸éœ€è¦æ‰©å®¹ã€‚
- æ’å…¥ç¬¬ 13 ä¸ªå…ƒç´ æ—¶ï¼Œè¾¾åˆ°è´Ÿè½½å› å­é™åˆ¶ï¼Œéœ€è¦æ‰©å®¹ã€‚æ­¤æ—¶ï¼ŒHashMap çš„å®¹é‡ä» 16 æ‰©å®¹åˆ° 32ã€‚

**æ‰©å®¹åçš„å®¹é‡**ï¼š32

- æ’å…¥ç¬¬ 14 åˆ°ç¬¬ 24 ä¸ªå…ƒç´ æ—¶ï¼Œä¸éœ€è¦æ‰©å®¹ã€‚

å› æ­¤ï¼Œæ€»å…±ä¼šè¿›è¡Œä¸€æ¬¡æ‰©å®¹ã€‚

### 17.è¯´è¯´hashmapçš„è´Ÿè½½å› å­HashMap è´Ÿè½½å› å­ 

loadFactor çš„é»˜è®¤å€¼æ˜¯ 0.75ï¼Œå½“ HashMap ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡äº†å®¹é‡çš„ 75% æ—¶ï¼Œå°±ä¼šè¿›è¡Œæ‰©å®¹ã€‚é»˜è®¤è´Ÿè½½å› å­ä¸º 0.75ï¼Œæ˜¯å› ä¸ºå®ƒæä¾›äº†ç©ºé—´å’Œæ—¶é—´å¤æ‚åº¦ä¹‹é—´çš„è‰¯å¥½å¹³è¡¡ã€‚è´Ÿè½½å› å­å¤ªä½ä¼šå¯¼è‡´å¤§é‡çš„ç©ºæ¡¶æµªè´¹ç©ºé—´ï¼Œè´Ÿè½½å› å­å¤ªé«˜ä¼šå¯¼è‡´å¤§é‡çš„ç¢°æ’ï¼Œé™ä½æ€§èƒ½ã€‚0.75 çš„è´Ÿè½½å› å­åœ¨è¿™ä¸¤ä¸ªå› ç´ ä¹‹é—´å–å¾—äº†è‰¯å¥½çš„å¹³è¡¡ã€‚

### 18.Hashmapå’ŒHashtableæœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„ï¼ŸHashmapä¸€èˆ¬æ€ä¹ˆç”¨ï¼Ÿ

- **HashMapçº¿ç¨‹ä¸å®‰å…¨**ï¼Œæ•ˆç‡é«˜ä¸€ç‚¹ï¼Œå¯ä»¥å­˜å‚¨nullçš„keyå’Œvalueï¼Œnullçš„keyåªèƒ½æœ‰ä¸€ä¸ªï¼Œnullçš„valueå¯ä»¥æœ‰å¤šä¸ªã€‚**é»˜è®¤åˆå§‹å®¹é‡ä¸º16**ï¼Œæ¯æ¬¡æ‰©å……å˜ä¸ºåŸæ¥2å€ã€‚åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†åˆå§‹å®¹é‡ï¼Œåˆ™æ‰©å……ä¸º2çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚åº•å±‚æ•°æ®ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨ï¼Œæ’å…¥å…ƒç´ åå¦‚æœé“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º8ï¼‰ï¼Œå…ˆåˆ¤æ–­æ•°ç»„é•¿åº¦æ˜¯å¦å°äº64ï¼Œå¦‚æœå°äºï¼Œåˆ™æ‰©å……æ•°ç»„ï¼Œåä¹‹å°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚
- **HashTableçº¿ç¨‹å®‰å…¨**ï¼Œæ•ˆç‡ä½ä¸€ç‚¹ï¼Œå…¶å†…éƒ¨æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡synchronizedä¿®é¥°ï¼Œä¸å¯ä»¥æœ‰nullçš„keyå’Œvalueã€‚é»˜è®¤åˆå§‹å®¹é‡ä¸º11ï¼Œæ¯æ¬¡æ‰©å®¹å˜ä¸ºåŸæ¥çš„2n+1ã€‚åˆ›å»ºæ—¶ç»™å®šäº†åˆå§‹å®¹é‡ï¼Œä¼šç›´æ¥ç”¨ç»™å®šçš„å¤§å°ã€‚åº•å±‚æ•°æ®ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨ã€‚å®ƒåŸºæœ¬è¢«æ·˜æ±°äº†ï¼Œè¦ä¿è¯çº¿ç¨‹å®‰å…¨å¯ä»¥ç”¨ConcurrentHashMapã€‚
- **æ€ä¹ˆç”¨**ï¼šHashMapä¸»è¦ç”¨æ¥å­˜å‚¨é”®å€¼å¯¹ï¼Œå¯ä»¥è°ƒç”¨putæ–¹æ³•å‘å…¶ä¸­åŠ å…¥å…ƒç´ ï¼Œè°ƒç”¨getæ–¹æ³•è·å–æŸä¸ªé”®å¯¹åº”çš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡containsKeyæ–¹æ³•æŸ¥çœ‹æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ç­‰

### 19.ConcurrentHashMapæ€ä¹ˆå®ç°çš„ï¼Ÿ

JDK 1.7 ConcurrentHashMap

åœ¨ JDK 1.7 ä¸­å®ƒä½¿ç”¨çš„æ˜¯æ•°ç»„åŠ é“¾è¡¨çš„å½¢å¼å®ç°çš„ï¼Œè€Œæ•°ç»„åˆåˆ†ä¸ºï¼šå¤§æ•°ç»„ Segment å’Œå°æ•°ç»„ HashEntryã€‚ Segment æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼ˆReentrantLockï¼‰ï¼Œåœ¨ ConcurrentHashMap é‡Œæ‰®æ¼”é”çš„è§’è‰²ï¼›HashEntry åˆ™ç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚ä¸€ä¸ª ConcurrentHashMap é‡ŒåŒ…å«ä¸€ä¸ª Segment æ•°ç»„ï¼Œä¸€ä¸ª Segment é‡ŒåŒ…å«ä¸€ä¸ª HashEntry æ•°ç»„ï¼Œæ¯ä¸ª HashEntry æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ã€‚

![img](assets\1750773483487-c23808fc-ace6-49f3-8fbd-e4b9823636d9.webp)

JDK 1.7 ConcurrentHashMap åˆ†æ®µé”æŠ€æœ¯å°†æ•°æ®åˆ†æˆä¸€æ®µä¸€æ®µçš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®çš„æ—¶å€™ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œèƒ½å¤Ÿå®ç°çœŸæ­£çš„å¹¶å‘è®¿é—®ã€‚

JDK 1.8 ConcurrentHashMap

åœ¨ JDK 1.7 ä¸­ï¼ŒConcurrentHashMap è™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å› ä¸ºå®ƒçš„åº•å±‚å®ç°æ˜¯æ•°ç»„ + é“¾è¡¨çš„å½¢å¼ï¼Œæ‰€ä»¥åœ¨æ•°æ®æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹è®¿é—®æ˜¯å¾ˆæ…¢çš„ï¼Œå› ä¸ºè¦éå†æ•´ä¸ªé“¾è¡¨ï¼Œè€Œ JDK 1.8 åˆ™ä½¿ç”¨äº†æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘çš„æ–¹å¼ä¼˜åŒ–äº† ConcurrentHashMap çš„å®ç°ï¼Œå…·ä½“å®ç°ç»“æ„å¦‚ä¸‹ï¼š

![img](assets\1750773483550-e3e7450b-d2d8-4dc7-b791-35a24d17fc3a.webp)

JDK 1.8 ConcurrentHashMap JDK 1.8 ConcurrentHashMap ä¸»è¦é€šè¿‡ volatile + CAS æˆ–è€… synchronized æ¥å®ç°çš„çº¿ç¨‹å®‰å…¨çš„ã€‚æ·»åŠ å…ƒç´ æ—¶é¦–å…ˆä¼šåˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©ºï¼š

- å¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨ volatile åŠ  CAS æ¥åˆå§‹åŒ–
- å¦‚æœå®¹å™¨ä¸ä¸ºç©ºï¼Œåˆ™æ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—è¯¥ä½ç½®æ˜¯å¦ä¸ºç©ºã€‚ 
- å¦‚æœæ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—ç»“æœä¸ºç©ºï¼Œåˆ™åˆ©ç”¨ CAS è®¾ç½®è¯¥èŠ‚ç‚¹ï¼›
- å¦‚æœæ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—ç»“æœä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨ synchronized ï¼Œç„¶åï¼Œéå†æ¡¶ä¸­çš„æ•°æ®ï¼Œå¹¶æ›¿æ¢æˆ–æ–°å¢èŠ‚ç‚¹åˆ°æ¡¶ä¸­ï¼Œæœ€åå†åˆ¤æ–­æ˜¯å¦éœ€è¦è½¬ä¸ºçº¢é»‘æ ‘ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å¹¶å‘è®¿é—®æ—¶çš„çº¿ç¨‹å®‰å…¨äº†ã€‚

å¦‚æœæŠŠä¸Šé¢çš„æ‰§è¡Œç”¨ä¸€å¥è¯å½’çº³çš„è¯ï¼Œå°±ç›¸å½“äºæ˜¯ConcurrentHashMapé€šè¿‡å¯¹å¤´ç»“ç‚¹åŠ é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ï¼Œé”çš„ç²’åº¦ç›¸æ¯” Segment æ¥è¯´æ›´å°äº†ï¼Œå‘ç”Ÿå†²çªå’ŒåŠ é”çš„é¢‘ç‡é™ä½äº†ï¼Œå¹¶å‘æ“ä½œçš„æ€§èƒ½å°±æé«˜äº†ã€‚è€Œä¸” JDK 1.8 ä½¿ç”¨çš„æ˜¯çº¢é»‘æ ‘ä¼˜åŒ–äº†ä¹‹å‰çš„å›ºå®šé“¾è¡¨ï¼Œé‚£ä¹ˆå½“æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¹Ÿå¾—åˆ°äº†å¾ˆå¤§çš„æå‡ï¼Œä»ä¹‹å‰çš„ O(n) ä¼˜åŒ–åˆ°äº† O(logn) çš„æ—¶é—´å¤æ‚åº¦ã€‚

>CAS å°±æ˜¯åˆ©ç”¨ CPU åŸå­æ“ä½œï¼Œ**æ— é”åœ°æ¯”è¾ƒå’Œæ›´æ–°å˜é‡çš„å€¼**ï¼Œæ˜¯Java 8ä¸­é«˜å¹¶å‘è®¾è®¡çš„é‡è¦åŸºç¡€ã€‚

### 20.åˆ†æ®µé”æ€ä¹ˆåŠ é”çš„ï¼Ÿ

åœ¨ ConcurrentHashMap ä¸­ï¼Œå°†æ•´ä¸ªæ•°æ®ç»“æ„åˆ†ä¸ºå¤šä¸ª Segmentï¼Œæ¯ä¸ª Segment éƒ½ç±»ä¼¼äºä¸€ä¸ªå°çš„ HashMapï¼Œæ¯ä¸ª Segment éƒ½æœ‰è‡ªå·±çš„é”ï¼Œä¸åŒ Segment ä¹‹é—´çš„æ“ä½œäº’ä¸å½±å“ï¼Œä»è€Œæé«˜å¹¶å‘æ€§èƒ½ã€‚åœ¨ ConcurrentHashMap ä¸­ï¼Œå¯¹äºæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œéœ€è¦å…ˆå®šä½åˆ°å…·ä½“çš„ Segmentï¼Œç„¶åå†åœ¨è¯¥ Segment ä¸ŠåŠ é”ï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿçš„ HashMap ä¸€æ ·å¯¹æ•´ä¸ªæ•°æ®ç»“æ„åŠ é”ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—ä¸åŒ Segment ä¹‹é—´çš„æ“ä½œå¹¶è¡Œè¿›è¡Œï¼Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚

### 21.åˆ†æ®µé”æ˜¯å¯é‡å…¥çš„å—ï¼Ÿ

- JDK 1.7 ä¹‹å‰çš„ ConcurrentHashMap æ˜¯åŸºäºåˆ†æ®µé”ï¼ˆReentrantLockï¼Œå¯é‡å…¥ï¼‰å®ç°çš„ã€‚

- JDK 1.8 ä¹‹åæ”¹ä¸ºåŸºäº CAS + synchronized çš„ç»†ç²’åº¦èŠ‚ç‚¹é”ï¼Œå…¶ä¸­çš„ `synchronized` æ˜¯å¯é‡å…¥é”ã€‚

### 22.å·²ç»ç”¨äº†synchronizedï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨CASå‘¢ï¼Ÿ

Java 8 çš„ ConcurrentHashMap å…ˆç”¨ CAS å°è¯•æ— é”æ›´æ–°ï¼ŒæˆåŠŸäº†æ€§èƒ½ç‰¹åˆ«é«˜ã€‚å¦‚æœ CAS å¤±è´¥å¤ªå¤šäº†ï¼Œå†ç”¨ synchronized åŠ é”ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚CAS å’Œ synchronized æ­é…ç”¨ï¼Œæ˜¯ä¸ºäº†æ—¢ä¿è¯å®‰å…¨åˆæå‡æ€§èƒ½ã€‚

> [!note]
>
> CAS çš„ä½œç”¨ï¼š**ä¹è§‚æ— é”æ›´æ–°**
>
> - CAS æ˜¯ä¸€ç§è½»é‡çº§çš„**åŸå­æ“ä½œ**ï¼Œç”¨æ¥å°è¯•å¿«é€Ÿåœ°æ›´æ–°æŸä¸ªå˜é‡ï¼ˆæ¯”å¦‚æ¡¶é‡Œçš„èŠ‚ç‚¹å¼•ç”¨ï¼‰ã€‚
> - å®ƒä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œå¦‚æœç«äº‰å¤±è´¥ï¼Œçº¿ç¨‹å¯ä»¥é‡è¯•æˆ–è€…é€€åŒ–ä¸ºåŠ é”ã€‚
> - é€‚åˆ**ä½å†²çªåœºæ™¯**ï¼Œé¿å…äº†åŠ é”çš„å¼€é”€ï¼Œæå‡æ€§èƒ½ã€‚
>
> synchronized çš„ä½œç”¨ï¼š**ä¿è¯å…³é”®ä»£ç å—çš„æ’ä»–æ€§**
>
> - å½“ CAS å¤šæ¬¡å°è¯•å¤±è´¥ï¼ˆå³ç«äº‰éå¸¸æ¿€çƒˆï¼‰æ—¶ï¼Œä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰ä½¿ç”¨ `synchronized` æ¥ä¸²è¡Œè®¿é—®ã€‚
> - è¿™æ˜¯**ä¸€ç§â€œä¹è§‚é”+æ‚²è§‚é”â€ç»“åˆçš„ç­–ç•¥**ï¼Œä¿è¯æ•°æ®æ­£ç¡®åŒæ—¶å°½å¯èƒ½æé«˜å¹¶å‘ã€‚
>
>  ä¸ºä»€ä¹ˆä¸¤è€…éƒ½ç”¨ï¼Ÿ
>
> - **CAS å…ˆè¯•å›¾æ— é”å¿«é€Ÿæ›´æ–°ï¼Œå‡å°‘é”ç«äº‰å’Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚**
> - **å¦‚æœ CAS ä¸æˆåŠŸï¼Œè¡¨æ˜ç«äº‰æ¿€çƒˆï¼Œå†ç”¨ synchronized æ¥ä¿è¯å®‰å…¨ã€‚**
> - è¿™æ ·åšæ—¢å……åˆ†åˆ©ç”¨äº†æ— é”çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œåˆä¿è¯äº†å¹¶å‘å®‰å…¨ã€‚

### 23.ConcurrentHashMapç”¨äº†æ‚²è§‚é”è¿˜æ˜¯ä¹è§‚é”?

æ‚²è§‚é”å’Œä¹è§‚é”éƒ½æœ‰ç”¨åˆ°ã€‚æ·»åŠ å…ƒç´ æ—¶é¦–å…ˆä¼šåˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©ºï¼š

- å¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨ volatile åŠ  **CAS ï¼ˆä¹è§‚é”ï¼‰** æ¥åˆå§‹åŒ–ã€‚
- å¦‚æœå®¹å™¨ä¸ä¸ºç©ºï¼Œåˆ™æ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—è¯¥ä½ç½®æ˜¯å¦ä¸ºç©ºã€‚
- å¦‚æœæ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—ç»“æœä¸ºç©ºï¼Œåˆ™åˆ©ç”¨ **CASï¼ˆä¹è§‚é”ï¼‰** è®¾ç½®è¯¥èŠ‚ç‚¹ï¼›
- å¦‚æœæ ¹æ®å­˜å‚¨çš„å…ƒç´ è®¡ç®—ç»“æœä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨ **synchronizedï¼ˆæ‚²è§‚é”ï¼‰** ï¼Œç„¶åï¼Œéå†æ¡¶ä¸­çš„æ•°æ®ï¼Œå¹¶æ›¿æ¢æˆ–æ–°å¢èŠ‚ç‚¹åˆ°æ¡¶ä¸­ï¼Œæœ€åå†åˆ¤æ–­æ˜¯å¦éœ€è¦è½¬ä¸ºçº¢é»‘æ ‘ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å¹¶å‘è®¿é—®æ—¶çš„çº¿ç¨‹å®‰å…¨äº†ã€‚

### 24.HashTable åº•å±‚å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

![img](assets\1750774852776-c0f78472-44fc-487c-982d-f5e4684ff3c1.webp)

- Hashtableçš„åº•å±‚æ•°æ®ç»“æ„ä¸»è¦æ˜¯**æ•°ç»„åŠ ä¸Šé“¾è¡¨**ï¼Œæ•°ç»„æ˜¯ä¸»ä½“ï¼Œé“¾è¡¨æ˜¯è§£å†³hashå†²çªå­˜åœ¨çš„ã€‚
- HashTableæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ç°æ–¹å¼æ˜¯**Hashtableçš„æ‰€æœ‰å…¬å…±æ–¹æ³•å‡é‡‡ç”¨synchronizedå…³é”®å­—**ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿè®¿é—®çš„æ—¶å€™ï¼Œå°±ä¼šé™·å…¥é˜»å¡æˆ–è€…è½®è¯¢çš„çŠ¶æ€ã€‚

### 25.HashTableçº¿ç¨‹å®‰å…¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ

å› ä¸ºå®ƒçš„putï¼Œgetåšæˆäº†åŒæ­¥æ–¹æ³•ï¼Œä¿è¯äº†Hashtableçš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œæ¯ä¸ªæ“ä½œæ•°æ®çš„æ–¹æ³•éƒ½è¿›è¡ŒåŒæ­¥æ§åˆ¶ä¹‹åï¼Œç”±æ­¤å¸¦æ¥çš„é—®é¢˜ä»»ä½•ä¸€ä¸ªæ—¶åˆ»**åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ“çºµHashtableï¼Œæ‰€ä»¥å…¶æ•ˆç‡æ¯”è¾ƒä½**ã€‚Hashtable çš„ put(K key, V value) å’Œ get(Object key) æ–¹æ³•çš„æºç ï¼š

```java
public synchronized V put(K key, V value) {
// Make sure the value is not null
if (value == null) {
    throw new NullPointerException();
}
 // Makes sure the key is not already in the hashtable.
Entry<?,?> tab[] = table;
int hash = key.hashCode();
int index = (hash & 0x7FFFFFFF) % tab.length;
@SuppressWarnings("unchecked")
Entry<K,V> entry = (Entry<K,V>)tab[index];
for(; entry != null ; entry = entry.next) {
    if ((entry.hash == hash) && entry.key.equals(key)) {
        V old = entry.value;
        entry.value = value;
        return old;
    }
}
 addEntry(hash, key, value, index);
return null;
}

public synchronized V get(Object key) {
Entry<?,?> tab[] = table;
int hash = key.hashCode();
int index = (hash & 0x7FFFFFFF) % tab.length;
for (Entry<?,?> e = tab[index] ; e != null ; e = e.next) {
    if ((e.hash == hash) && e.key.equals(key)) {
        return (V)e.value;
    }
}
return null;
}
```

å¯ä»¥çœ‹åˆ°ï¼Œ**Hashtableæ˜¯é€šè¿‡ä½¿ç”¨äº† synchronized å…³é”®å­—æ¥ä¿è¯å…¶çº¿ç¨‹å®‰å…¨**ã€‚åœ¨Javaä¸­ï¼Œå¯ä»¥ä½¿ç”¨synchronizedå…³é”®å­—æ¥æ ‡è®°ä¸€ä¸ªæ–¹æ³•æˆ–è€…ä»£ç å—ï¼Œå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨è¯¥å¯¹è±¡çš„synchronizedæ–¹æ³•æˆ–è€…è®¿é—®synchronizedä»£ç å—æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹ä¾¿è·å¾—äº†è¯¥å¯¹è±¡çš„é”ï¼Œå…¶ä»–çº¿ç¨‹æš‚æ—¶æ— æ³•è®¿é—®è¿™ä¸ªæ–¹æ³•ï¼Œåªæœ‰ç­‰å¾…è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå®Œæ¯•æˆ–è€…ä»£ç å—æ‰§è¡Œå®Œæ¯•ï¼Œè¿™ä¸ªçº¿ç¨‹æ‰ä¼šé‡Šæ”¾è¯¥å¯¹è±¡çš„é”ï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½æ‰§è¡Œè¿™ä¸ªæ–¹æ³•æˆ–è€…ä»£ç å—ã€‚

### 26.hashtable å’ŒconcurrentHashMapæœ‰ä»€ä¹ˆåŒºåˆ«

**åº•å±‚æ•°æ®ç»“æ„ï¼š**

- jdk7ä¹‹å‰çš„ConcurrentHashMapåº•å±‚é‡‡ç”¨çš„æ˜¯**åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨**å®ç°ï¼Œjdk8ä¹‹åé‡‡ç”¨çš„æ˜¯**æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ï¼›**
- HashTableé‡‡ç”¨çš„æ˜¯**æ•°ç»„+é“¾è¡¨**ï¼Œæ•°ç»„æ˜¯ä¸»ä½“ï¼Œé“¾è¡¨æ˜¯è§£å†³hashå†²çªå­˜åœ¨çš„ã€‚

**å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼š**

- jdk8ä»¥å‰ï¼ŒConcurrentHashMapé‡‡ç”¨åˆ†æ®µé”ï¼Œå¯¹æ•´ä¸ªæ•°ç»„è¿›è¡Œäº†åˆ†æ®µåˆ†å‰²ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨é‡Œçš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®ä¸åŒæ•°æ®æ®µé‡Œçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜äº†å¹¶å‘è®¿é—®ï¼›
- jdk8ä»¥åï¼ŒConcurrentHashMapç›´æ¥é‡‡ç”¨æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨CASå’Œsynchronizedæ“ä½œï¼Œæ›´åŠ æé«˜äº†é€Ÿåº¦ã€‚
- HashTableï¼šæ‰€æœ‰çš„æ–¹æ³•éƒ½åŠ äº†é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯æ•ˆç‡éå¸¸çš„ä½ä¸‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿè®¿é—®çš„æ—¶å€™ï¼Œå°±ä¼šé™·å…¥é˜»å¡æˆ–è€…è½®è¯¢çš„çŠ¶æ€ã€‚

### 27.è¯´ä¸€ä¸‹HashMapå’ŒHashtableã€ConcurrentMapçš„åŒºåˆ«

>HashMap å¿«ä½†ä¸å®‰å…¨ï¼ŒHashtable å®‰å…¨ä½†æ…¢ï¼›ConcurrentHashMap åˆå¿«åˆå®‰å…¨ï¼Œæ¨èä½¿ç”¨ï¼

- HashMapçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ä¸€ç‚¹ï¼Œå¯ä»¥å­˜å‚¨nullçš„keyå’Œvalueï¼Œnullçš„keyåªèƒ½æœ‰ä¸€ä¸ªï¼Œnullçš„valueå¯ä»¥æœ‰å¤šä¸ªã€‚é»˜è®¤åˆå§‹å®¹é‡ä¸º16ï¼Œæ¯æ¬¡æ‰©å……å˜ä¸ºåŸæ¥2å€ã€‚åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†åˆå§‹å®¹é‡ï¼Œåˆ™æ‰©å……ä¸º2çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚åº•å±‚æ•°æ®ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨ï¼Œæ’å…¥å…ƒç´ åå¦‚æœé“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º8ï¼‰ï¼Œå…ˆåˆ¤æ–­æ•°ç»„é•¿åº¦æ˜¯å¦å°äº64ï¼Œå¦‚æœå°äºï¼Œåˆ™æ‰©å……æ•°ç»„ï¼Œåä¹‹å°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚
- HashTableçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½ä¸€ç‚¹ï¼Œå…¶å†…éƒ¨æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡synchronizedä¿®é¥°ï¼Œä¸å¯ä»¥æœ‰nullçš„keyå’Œvalueã€‚é»˜è®¤åˆå§‹å®¹é‡ä¸º11ï¼Œæ¯æ¬¡æ‰©å®¹å˜ä¸ºåŸæ¥çš„2n+1ã€‚åˆ›å»ºæ—¶ç»™å®šäº†åˆå§‹å®¹é‡ï¼Œä¼šç›´æ¥ç”¨ç»™å®šçš„å¤§å°ã€‚åº•å±‚æ•°æ®ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨ã€‚å®ƒåŸºæœ¬è¢«æ·˜æ±°äº†ï¼Œè¦ä¿è¯çº¿ç¨‹å®‰å…¨å¯ä»¥ç”¨ConcurrentHashMapã€‚
- ConcurrentHashMapæ˜¯Javaä¸­çš„ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨å®ç°ï¼Œå®ƒå¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¹¶å‘åœ°è¿›è¡Œè¯»å†™æ“ä½œï¼Œè€Œä¸éœ€è¦åƒä¼ ç»Ÿçš„HashTableé‚£æ ·åœ¨è¯»å†™æ—¶åŠ é”ã€‚ConcurrentHashMapçš„å®ç°åŸç†ä¸»è¦åŸºäºåˆ†æ®µé”å’ŒCASæ“ä½œã€‚å®ƒå°†æ•´ä¸ªå“ˆå¸Œè¡¨åˆ†æˆäº†å¤šSegmentï¼ˆæ®µï¼‰ï¼Œæ¯ä¸ªSegmentéƒ½ç±»ä¼¼äºä¸€ä¸ªå°çš„HashMapï¼Œå®ƒæ‹¥æœ‰è‡ªå·±çš„æ•°ç»„å’Œä¸€ä¸ªç‹¬ç«‹çš„é”ã€‚åœ¨ConcurrentHashMapä¸­ï¼Œè¯»æ“ä½œä¸éœ€è¦é”ï¼Œå¯ä»¥ç›´æ¥å¯¹Segmentè¿›è¡Œè¯»å–ï¼Œè€Œå†™æ“ä½œåˆ™åªéœ€è¦é”å®šå¯¹åº”çš„Segmentï¼Œè€Œä¸æ˜¯æ•´ä¸ªå“ˆå¸Œè¡¨ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜å¹¶å‘æ€§èƒ½ã€‚

| ç‰¹æ€§/å¯¹æ¯”ç‚¹         | HashMap                          | Hashtable                     | ConcurrentHashMapï¼ˆConcurrentMapï¼‰          |
| ------------------- | -------------------------------- | ----------------------------- | ------------------------------------------- |
| **æ˜¯å¦çº¿ç¨‹å®‰å…¨**    | âŒ å¦                             | âœ… æ˜¯ï¼ˆå…¨æ–¹æ³• `synchronized`ï¼‰ | âœ… æ˜¯ï¼ˆåˆ†æ®µé”æˆ– CAS æœºåˆ¶ï¼‰                   |
| **æ€§èƒ½è¡¨ç°**        | å¿«ï¼Œéçº¿ç¨‹å®‰å…¨                   | æ…¢ï¼Œçº¿ç¨‹å®‰å…¨ï¼ˆä½†å…¨é”æ•ˆç‡ä½ï¼‰  | é«˜æ€§èƒ½çº¿ç¨‹å®‰å…¨ï¼ˆæ”¯æŒé«˜å¹¶å‘ï¼‰                |
| **å‡ºç°æ—¶é—´**        | JDK 1.2                          | JDK 1.0                       | JDK 1.5+                                    |
| **å…è®¸ null é”®/å€¼** | âœ… å…è®¸ä¸€ä¸ª null é”®ï¼Œå¤šä¸ª null å€¼ | âŒ ä¸å…è®¸ null é”®æˆ– null å€¼    | âŒ ä¸å…è®¸ null é”®æˆ– null å€¼ï¼ˆä¸ºäº†å¹¶å‘å®‰å…¨ï¼‰  |
| **åº•å±‚æ•°æ®ç»“æ„**    | æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘ï¼ˆJDK 8+ï¼‰     | åŒä¸Š                          | åŒä¸Šï¼ˆåŠ äº†åˆ†æ®µæœºåˆ¶æˆ–æ¡¶çº§é”/CASï¼‰            |
| **åŠ é”æœºåˆ¶**        | æ— é”                             | æ–¹æ³•çº§åŒæ­¥é”ï¼ˆæ•´è¡¨é”ï¼‰        | åˆ†æ®µé”ï¼ˆJDK 7 ä»¥å‰ï¼‰â†’ æ¡¶çº§é” + CASï¼ˆJDK 8ï¼‰ |

## Set

### 1.Seté›†åˆæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿå¦‚ä½•å®ç°keyæ— é‡å¤çš„ï¼Ÿ

- **seté›†åˆç‰¹ç‚¹**ï¼šSeté›†åˆä¸­çš„å…ƒç´ æ˜¯å”¯ä¸€çš„ï¼Œä¸ä¼šå‡ºç°é‡å¤çš„å…ƒç´ ã€‚
- **setå®ç°åŸç†**ï¼šSeté›†åˆé€šè¿‡å†…éƒ¨çš„æ•°æ®ç»“æ„ï¼ˆå¦‚å“ˆå¸Œè¡¨ã€çº¢é»‘æ ‘ç­‰ï¼‰æ¥å®ç°keyçš„æ— é‡å¤ã€‚å½“å‘Seté›†åˆä¸­æ’å…¥å…ƒç´ æ—¶ï¼Œä¼šå…ˆæ ¹æ®å…ƒç´ çš„hashCodeå€¼æ¥ç¡®å®šå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼Œç„¶åå†é€šè¿‡equalsæ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨ç›¸åŒçš„å…ƒç´ ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸ä¼šå†æ¬¡æ’å…¥ï¼Œä¿è¯äº†å…ƒç´ çš„å”¯ä¸€æ€§ã€‚

### 2.æœ‰åºçš„Setæ˜¯ä»€ä¹ˆï¼Ÿè®°å½•æ’å…¥é¡ºåºçš„é›†åˆæ˜¯ä»€ä¹ˆï¼Ÿ

- **æœ‰åºçš„ Set åŒ…æ‹¬ `TreeSet` å’Œ `LinkedHashSet`**ã€‚
  - `TreeSet` åŸºäºçº¢é»‘æ ‘å®ç°ï¼ŒæŒ‰ç…§å…ƒç´ çš„**è‡ªç„¶é¡ºåº**æˆ–è‡ªå®šä¹‰æ’åºè§„åˆ™è¿›è¡Œæ’åˆ—ã€‚
  - `LinkedHashSet` åŸºäºå“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨ï¼ŒæŒ‰ç…§å…ƒç´ çš„**æ’å…¥é¡ºåº**è¿›è¡Œå­˜å‚¨ã€‚
- **è®°å½•æ’å…¥é¡ºåºçš„ Set é€šå¸¸æŒ‡ `LinkedHashSet`**ã€‚
   å®ƒä¸ä»…ç¡®ä¿å…ƒç´ å”¯ä¸€æ€§ï¼Œè¿˜ä¿ç•™å…ƒç´ çš„æ’å…¥é¡ºåºï¼Œæ˜¯åœ¨éœ€è¦é¡ºåºè®¿é—®çš„ Set åœºæ™¯ä¸‹çš„é¦–é€‰å®ç°ã€‚