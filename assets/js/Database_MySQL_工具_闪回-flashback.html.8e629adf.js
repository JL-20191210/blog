"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[35174],{66262:(a,e)=>{e.A=(a,e)=>{const l=a.__vccOpts||a;for(const[a,n]of e)l[a]=n;return l}},77111:(a,e,l)=>{l.r(e),l.d(e,{comp:()=>t,data:()=>i});var n=l(20641);const s={},t=(0,l(66262).A)(s,[["render",function(a,e){return(0,n.uX)(),(0,n.CE)("div",null,e[0]||(e[0]=[(0,n.Fv)('<h1 id="闪回-flashback" tabindex="-1"><a class="header-anchor" href="#闪回-flashback"><span>闪回-flashback</span></a></h1><h3 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介"><span><strong>1. 简介</strong></span></a></h3><p>mysqlbinlog flashback（闪回）用于快速恢复由于误操作丢失的数据。在DBA误操作时，可以把数据库恢复到以前某个时间点（或者说某个binlog的某个pos）。比如忘了带where条件的update、delete操作，传统的恢复方式是利用全备+二进制日志前滚进行恢复，相比于传统的全备+增备，flashback显然更为快速、简单。</p><p>目前MySQL的flashback功能是利用binlog完成的，第一个实现该功能的是阿里云的<strong>彭立勋</strong>， 他在MySQL 5.5版本上就已实现，并将其提交给MariaDB。</p><h3 id="_2-闪回原理" tabindex="-1"><a class="header-anchor" href="#_2-闪回原理"><span>2. 闪回原理</span></a></h3><p>原理：flashback工具（-B 参数）可对rows格式的binlog可以进行逆向操作，delete反向生成insert、update生成反向的update、insert反向生成delete。</p><p>MySQL的binlog以event的形式，记录了MySQL中所有的变更情况，利用binlog我们就能够重现所记录的所有操作。</p><p>MySQL引入binlog主要有两个用途/目的：一是为了主从复制；二是用于备份恢复后需要重新应用部分binlog，从而达到全备+增备的效果。</p><p>MySQL的binlog有三种格式：</p><ul><li>statement，基于SQL语句的模式，一般来说生成的binlog尺寸较小，但是某些不确定性SQL语句或函数在复制过程可能导致数据不一致甚至出错；</li><li>row，基于数据行的模式，记录的是数据行的完整变化。相对更安全，推荐使用（但通常生成的binlog会比其他两种模式大很多）；</li><li>mixed，混合模式，可以根据情况自动选用statement抑或row模式；这个模式下也可能造成主从数据不一致。它属于MySQL 5.1版本时期的过渡方案，已不推荐使用了。</li></ul><p>🔥注意：使用mysqlbinlog flashback 工具必须设置：binlog_format = row</p>',11)]))}]]),i=JSON.parse('{"path":"/Database/MySQL/%E5%B7%A5%E5%85%B7/%E9%97%AA%E5%9B%9E-flashback.html","title":"闪回-flashback","lang":"zh-CN","frontmatter":{"gitInclude":[]},"headers":[{"level":3,"title":"1. 简介","slug":"_1-简介","link":"#_1-简介","children":[]},{"level":3,"title":"2. 闪回原理","slug":"_2-闪回原理","link":"#_2-闪回原理","children":[]}],"readingTime":{"minutes":1.6,"words":481},"filePathRelative":"Database/MySQL/工具/闪回-flashback.md","excerpt":"\\n<h3><strong>1. 简介</strong></h3>\\n<p>mysqlbinlog flashback（闪回）用于快速恢复由于误操作丢失的数据。在DBA误操作时，可以把数据库恢复到以前某个时间点（或者说某个binlog的某个pos）。比如忘了带where条件的update、delete操作，传统的恢复方式是利用全备+二进制日志前滚进行恢复，相比于传统的全备+增备，flashback显然更为快速、简单。</p>\\n<p>目前MySQL的flashback功能是利用binlog完成的，第一个实现该功能的是阿里云的<strong>彭立勋</strong>， 他在MySQL 5.5版本上就已实现，并将其提交给MariaDB。</p>"}')}}]);