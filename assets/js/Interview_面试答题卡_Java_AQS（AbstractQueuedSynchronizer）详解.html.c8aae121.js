"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[94108],{66262:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,e]of i)a[s]=e;return a}},53636:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>n,data:()=>d});var e=a(20641);const t={},n=(0,a(66262).A)(t,[["render",function(s,i){return(0,e.uX)(),(0,e.CE)("div",null,i[0]||(i[0]=[(0,e.Fv)('<h1 id="â˜•-java-é¢è¯•ç­”é¢˜å¡-aqs-abstractqueuedsynchronizer-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#â˜•-java-é¢è¯•ç­”é¢˜å¡-aqs-abstractqueuedsynchronizer-è¯¦è§£"><span>â˜• Java é¢è¯•ç­”é¢˜å¡ï¼šAQSï¼ˆAbstractQueuedSynchronizerï¼‰è¯¦è§£</span></a></h1><hr><h2 id="âœ…-ä¸€å¥è¯æ¦‚æ‹¬" tabindex="-1"><a class="header-anchor" href="#âœ…-ä¸€å¥è¯æ¦‚æ‹¬"><span>âœ… ä¸€å¥è¯æ¦‚æ‹¬</span></a></h2><blockquote><p>AQS æ˜¯ Java å¹¶å‘åŒ… <code>java.util.concurrent.locks</code> çš„æ ¸å¿ƒæŠ½è±¡ç±»ï¼Œç”¨äºæ„å»ºå„ç§åŒæ­¥å™¨ï¼Œå¦‚ï¼š<code>ReentrantLock</code>ã€<code>CountDownLatch</code>ã€<code>Semaphore</code> ç­‰ï¼Œå…¶é€šè¿‡ä¸€ä¸ªå…±äº«çš„ <code>state</code> çŠ¶æ€å­—æ®µ + FIFO ç­‰å¾…é˜Ÿåˆ—ï¼Œå®ç°çº¿ç¨‹é—´çš„åŒæ­¥æ§åˆ¶ã€‚</p></blockquote><hr><h2 id="âœ…-1-æ ¸å¿ƒè§’è‰²ä¸ç»“æ„" tabindex="-1"><a class="header-anchor" href="#âœ…-1-æ ¸å¿ƒè§’è‰²ä¸ç»“æ„"><span>âœ… 1. æ ¸å¿ƒè§’è‰²ä¸ç»“æ„</span></a></h2><h2 id="ğŸ“¦-ç±»å" tabindex="-1"><a class="header-anchor" href="#ğŸ“¦-ç±»å"><span>ğŸ“¦ ç±»åï¼š</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> abstract</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AbstractQueuedSynchronizer</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AbstractOwnableSynchronizer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="ğŸ“Œ-è®¾è®¡ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-è®¾è®¡ç›®æ ‡"><span>ğŸ“Œ è®¾è®¡ç›®æ ‡ï¼š</span></a></h2><p>å°è£…åŒæ­¥çŠ¶æ€ç®¡ç†ï¼ˆstateï¼‰+ é˜»å¡çº¿ç¨‹é˜Ÿåˆ—ï¼ˆFIFOï¼‰ï¼Œ<strong>ç»Ÿä¸€æ§åˆ¶å¹¶å‘èµ„æºçš„è®¿é—®</strong>ã€‚</p><h2 id="ğŸ“-å†…éƒ¨ç»“æ„å›¾" tabindex="-1"><a class="header-anchor" href="#ğŸ“-å†…éƒ¨ç»“æ„å›¾"><span>ğŸ“ å†…éƒ¨ç»“æ„å›¾ï¼š</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>      +------------------------+</span></span>\n<span class="line"><span>      |     AQS (æ ¸å¿ƒ)         |</span></span>\n<span class="line"><span>      |  - state               |</span></span>\n<span class="line"><span>      |  - head, tail (é˜Ÿåˆ—)   |</span></span>\n<span class="line"><span>      +------------------------+</span></span>\n<span class="line"><span>        â†‘      â†‘</span></span>\n<span class="line"><span>  çº¿ç¨‹ A  çº¿ç¨‹ B  ...</span></span>\n<span class="line"><span>  å¤±è´¥åˆ™å…¥é˜Ÿæ’é˜Ÿç­‰å¾…</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="âœ…-2-æ ¸å¿ƒç»„ä»¶è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#âœ…-2-æ ¸å¿ƒç»„ä»¶è¯¦è§£"><span>âœ… 2. æ ¸å¿ƒç»„ä»¶è¯¦è§£</span></a></h2><table><thead><tr><th>ç»„ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>state</code></td><td>å…±äº«å˜é‡ï¼Œè¡¨ç¤ºå½“å‰åŒæ­¥çŠ¶æ€ï¼Œé€šå¸¸ä¸ºé”çš„æŒæœ‰æƒ…å†µ</td></tr><tr><td><code>Node</code></td><td>å†…éƒ¨ç±»ï¼Œä»£è¡¨ç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªçº¿ç¨‹</td></tr><tr><td><code>head</code>, <code>tail</code></td><td>ç­‰å¾…é˜Ÿåˆ—çš„å¤´å°¾æŒ‡é’ˆ</td></tr><tr><td><code>exclusiveOwnerThread</code></td><td>ç‹¬å æ¨¡å¼ä¸‹è®°å½•å½“å‰æŒé”çº¿ç¨‹ï¼ˆReentrantLock ç”¨ï¼‰</td></tr></tbody></table><hr><h2 id="âœ…-3-ä¸¤ç§æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#âœ…-3-ä¸¤ç§æ¨¡å¼"><span>âœ… 3. ä¸¤ç§æ¨¡å¼</span></a></h2><table><thead><tr><th>æ¨¡å¼</th><th>è¯´æ˜</th><th>å…¸å‹å®ç°</th></tr></thead><tbody><tr><td>ç‹¬å æ¨¡å¼</td><td>åŒä¸€æ—¶é—´åªèƒ½ä¸€ä¸ªçº¿ç¨‹è·å–åŒæ­¥èµ„æº</td><td><code>ReentrantLock</code></td></tr><tr><td>å…±äº«æ¨¡å¼</td><td>å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®èµ„æº</td><td><code>Semaphore</code>ã€<code>CountDownLatch</code></td></tr></tbody></table><hr><h2 id="âœ…-4-å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•-æ¨¡æ¿æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#âœ…-4-å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•-æ¨¡æ¿æ–¹æ³•"><span>âœ… 4. å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•ï¼ˆæ¨¡æ¿æ–¹æ³•ï¼‰</span></a></h2><table><thead><tr><th>æ–¹æ³•å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>tryAcquire(int arg)</code></td><td>ç‹¬å å¼è·å–èµ„æº</td></tr><tr><td><code>tryRelease(int arg)</code></td><td>ç‹¬å å¼é‡Šæ”¾èµ„æº</td></tr><tr><td><code>tryAcquireShared(int)</code></td><td>å…±äº«å¼è·å–èµ„æºï¼ˆè¿”å›å€¼ &gt;= 0 è¡¨ç¤ºæˆåŠŸï¼‰</td></tr><tr><td><code>tryReleaseShared(int)</code></td><td>å…±äº«å¼é‡Šæ”¾èµ„æº</td></tr><tr><td><code>isHeldExclusively()</code></td><td>å½“å‰çº¿ç¨‹æ˜¯å¦ç‹¬å èµ„æºï¼ˆå¯é€‰ï¼‰</td></tr></tbody></table><hr><h2 id="âœ…-5-æä¾›çš„æ ¸å¿ƒæ–¹æ³•-ç”±å­ç±»è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#âœ…-5-æä¾›çš„æ ¸å¿ƒæ–¹æ³•-ç”±å­ç±»è°ƒç”¨"><span>âœ… 5. æä¾›çš„æ ¸å¿ƒæ–¹æ³•ï¼ˆç”±å­ç±»è°ƒç”¨ï¼‰</span></a></h2><table><thead><tr><th>æ–¹æ³•å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>acquire(int)</code></td><td>è·å–ç‹¬å èµ„æºï¼Œå¤±è´¥åˆ™åŠ å…¥é˜Ÿåˆ—ç­‰å¾…</td></tr><tr><td><code>release(int)</code></td><td>é‡Šæ”¾ç‹¬å èµ„æºï¼Œå¹¶å”¤é†’åç»§èŠ‚ç‚¹</td></tr><tr><td><code>acquireShared(int)</code></td><td>è·å–å…±äº«èµ„æºï¼Œå¤±è´¥åˆ™åŠ å…¥é˜Ÿåˆ—</td></tr><tr><td><code>releaseShared(int)</code></td><td>é‡Šæ”¾å…±äº«èµ„æºï¼Œå”¤é†’æ‰€æœ‰å…±äº«èŠ‚ç‚¹</td></tr><tr><td><code>hasQueuedThreads()</code></td><td>æ˜¯å¦å­˜åœ¨ç­‰å¾…çº¿ç¨‹</td></tr></tbody></table><hr><h2 id="âœ…-6-æ ¸å¿ƒå·¥ä½œæµç¨‹-ç‹¬å æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#âœ…-6-æ ¸å¿ƒå·¥ä½œæµç¨‹-ç‹¬å æ¨¡å¼"><span>âœ… 6. æ ¸å¿ƒå·¥ä½œæµç¨‹ï¼ˆç‹¬å æ¨¡å¼ï¼‰</span></a></h2><h2 id="ç¤ºä¾‹-acquire-è·å–é”æµç¨‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-acquire-è·å–é”æµç¨‹"><span>ç¤ºä¾‹ï¼š<code>acquire()</code> è·å–é”æµç¨‹</span></a></h2><ol><li>è°ƒç”¨å­ç±»å®ç°çš„ <code>tryAcquire()</code> å°è¯•æŠ¢é”</li><li>å¦‚æœå¤±è´¥ï¼Œåˆ™å°è£…å½“å‰çº¿ç¨‹ä¸º <code>Node</code> å…¥é˜Ÿ</li><li>è‡ªæ—‹åˆ¤æ–­è‡ªå·±æ˜¯å¦æ˜¯é˜Ÿå¤´èŠ‚ç‚¹ä¸”å¯è·å–é”ï¼ˆå‰é©±é‡Šæ”¾æ—¶å”¤é†’ï¼‰</li><li>è·å–æˆåŠŸ â†’ æ‰§è¡Œé€»è¾‘ â†’ è°ƒç”¨ <code>release()</code> é‡Šæ”¾é”</li></ol><hr><h2 id="âœ…-7-è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹-ç‹¬å é”" tabindex="-1"><a class="header-anchor" href="#âœ…-7-è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹-ç‹¬å é”"><span>âœ… 7. è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹ï¼ˆç‹¬å é”ï¼‰</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyLock</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AbstractQueuedSynchronizer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Override</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    protected</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> tryAcquire</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> arg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> compareAndSetState</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æŠ¢å é”</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Override</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    protected</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> tryRelease</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> arg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        setState</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// é‡Šæ”¾é”</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> lock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        acquire</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> unlock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        release</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="âœ…-8-aqs-å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶-fifo" tabindex="-1"><a class="header-anchor" href="#âœ…-8-aqs-å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶-fifo"><span>âœ… 8. AQS å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶ï¼ˆFIFOï¼‰</span></a></h2><ul><li>åº•å±‚ä½¿ç”¨ CLHï¼ˆè™šæ‹ŸåŒå‘é˜Ÿåˆ—ï¼‰</li><li>æ¯ä¸ªèŠ‚ç‚¹ <code>Node</code> ä»£è¡¨ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</li><li>èŠ‚ç‚¹æœ‰çŠ¶æ€ï¼ˆå¦‚ï¼šSIGNALã€CANCELLEDï¼‰</li><li>ä½¿ç”¨ <code>LockSupport.park()</code> å’Œ <code>unpark()</code> å®ç°é˜»å¡/å”¤é†’</li></ul><hr><h2 id="âœ…-9-aqs-çš„å¥½å¤„" tabindex="-1"><a class="header-anchor" href="#âœ…-9-aqs-çš„å¥½å¤„"><span>âœ… 9. AQS çš„å¥½å¤„</span></a></h2><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ¨¡æ¿æ–¹æ³•è®¾è®¡</td><td>å­ç±»åªéœ€å…³æ³¨ <code>tryAcquire</code> ç­‰å°‘æ•°æ–¹æ³•</td></tr><tr><td>çŠ¶æ€ç®¡ç†ç»Ÿä¸€</td><td><code>state</code> æ§åˆ¶å¹¶å‘èµ„æºï¼Œç»Ÿä¸€ç®¡ç†</td></tr><tr><td>é˜»å¡é˜Ÿåˆ—å°è£…è‰¯å¥½</td><td>è‡ªåŠ¨å®ç°é˜»å¡ã€æ’é˜Ÿã€å…¬å¹³æ€§ç­‰æœºåˆ¶</td></tr><tr><td>å¯æ„å»ºå¤šç§å¹¶å‘ç»„ä»¶</td><td>æ”¯æŒé”ã€ä¿¡å·é‡ã€æ …æ ç­‰å„ç§åŒæ­¥å·¥å…·</td></tr></tbody></table><hr><h2 id="âœ…-10-å¸¸è§åŸºäº-aqs-çš„å¹¶å‘ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#âœ…-10-å¸¸è§åŸºäº-aqs-çš„å¹¶å‘ç»„ä»¶"><span>âœ… 10. å¸¸è§åŸºäº AQS çš„å¹¶å‘ç»„ä»¶</span></a></h2><table><thead><tr><th>ç±»å</th><th>æ¨¡å¼</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>ReentrantLock</code></td><td>ç‹¬å </td><td>å¯é‡å…¥äº’æ–¥é”</td></tr><tr><td><code>Semaphore</code></td><td>å…±äº«</td><td>æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°</td></tr><tr><td><code>CountDownLatch</code></td><td>å…±äº«</td><td>ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆ</td></tr><tr><td><code>ReentrantReadWriteLock</code></td><td>ç‹¬å +å…±äº«</td><td>æ”¯æŒè¯»å†™é”åˆ†ç¦»</td></tr><tr><td><code>FutureTask</code></td><td>ç‹¬å </td><td>ç”¨äºçº¿ç¨‹æ± ä»»åŠ¡è¿”å›å€¼çš„åŒæ­¥</td></tr></tbody></table><hr><h2 id="âœ…-11-é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿-å»ºè®®èƒŒè¯µ" tabindex="-1"><a class="header-anchor" href="#âœ…-11-é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿-å»ºè®®èƒŒè¯µ"><span>âœ… 11. é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿ï¼ˆå»ºè®®èƒŒè¯µï¼‰</span></a></h2><blockquote><p>AQS æ˜¯ Java å¹¶å‘åŒ…çš„åŸºç¡€æŠ½è±¡ç±»ï¼Œç”¨äºæ„å»ºé”å’ŒåŒæ­¥å™¨ã€‚å®ƒé€šè¿‡ä¸€ä¸ª <code>volatile</code> çš„ state çŠ¶æ€å˜é‡æ§åˆ¶èµ„æºè®¿é—®ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ª FIFO çš„é˜»å¡ç­‰å¾…é˜Ÿåˆ—ã€‚å½“çº¿ç¨‹è·å–å¤±è´¥æ—¶ï¼Œä¼šåŠ å…¥é˜Ÿåˆ—ç­‰å¾…ï¼Œé€šè¿‡ <code>LockSupport.park()</code> æŒ‚èµ·ï¼Œè¢«å”¤é†’åå†æ¬¡å°è¯•ã€‚AQS çš„è®¾è®¡éå¸¸ç»å…¸ï¼ŒåŸºäºæ¨¡æ¿æ–¹æ³•ï¼Œç®€åŒ–äº†åŒæ­¥å™¨çš„å¼€å‘ã€‚</p></blockquote>',43)]))}]]),d=JSON.parse('{"path":"/Interview/%E9%9D%A2%E8%AF%95%E7%AD%94%E9%A2%98%E5%8D%A1/Java/AQS%EF%BC%88AbstractQueuedSynchronizer%EF%BC%89%E8%AF%A6%E8%A7%A3.html","title":"â˜• Java é¢è¯•ç­”é¢˜å¡ï¼šAQSï¼ˆAbstractQueuedSynchronizerï¼‰è¯¦è§£","lang":"zh-CN","frontmatter":{"gitInclude":[]},"headers":[{"level":2,"title":"âœ… ä¸€å¥è¯æ¦‚æ‹¬","slug":"âœ…-ä¸€å¥è¯æ¦‚æ‹¬","link":"#âœ…-ä¸€å¥è¯æ¦‚æ‹¬","children":[]},{"level":2,"title":"âœ… 1. æ ¸å¿ƒè§’è‰²ä¸ç»“æ„","slug":"âœ…-1-æ ¸å¿ƒè§’è‰²ä¸ç»“æ„","link":"#âœ…-1-æ ¸å¿ƒè§’è‰²ä¸ç»“æ„","children":[]},{"level":2,"title":"ğŸ“¦ ç±»åï¼š","slug":"ğŸ“¦-ç±»å","link":"#ğŸ“¦-ç±»å","children":[]},{"level":2,"title":"ğŸ“Œ è®¾è®¡ç›®æ ‡ï¼š","slug":"ğŸ“Œ-è®¾è®¡ç›®æ ‡","link":"#ğŸ“Œ-è®¾è®¡ç›®æ ‡","children":[]},{"level":2,"title":"ğŸ“ å†…éƒ¨ç»“æ„å›¾ï¼š","slug":"ğŸ“-å†…éƒ¨ç»“æ„å›¾","link":"#ğŸ“-å†…éƒ¨ç»“æ„å›¾","children":[]},{"level":2,"title":"âœ… 2. æ ¸å¿ƒç»„ä»¶è¯¦è§£","slug":"âœ…-2-æ ¸å¿ƒç»„ä»¶è¯¦è§£","link":"#âœ…-2-æ ¸å¿ƒç»„ä»¶è¯¦è§£","children":[]},{"level":2,"title":"âœ… 3. ä¸¤ç§æ¨¡å¼","slug":"âœ…-3-ä¸¤ç§æ¨¡å¼","link":"#âœ…-3-ä¸¤ç§æ¨¡å¼","children":[]},{"level":2,"title":"âœ… 4. å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•ï¼ˆæ¨¡æ¿æ–¹æ³•ï¼‰","slug":"âœ…-4-å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•-æ¨¡æ¿æ–¹æ³•","link":"#âœ…-4-å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•-æ¨¡æ¿æ–¹æ³•","children":[]},{"level":2,"title":"âœ… 5. æä¾›çš„æ ¸å¿ƒæ–¹æ³•ï¼ˆç”±å­ç±»è°ƒç”¨ï¼‰","slug":"âœ…-5-æä¾›çš„æ ¸å¿ƒæ–¹æ³•-ç”±å­ç±»è°ƒç”¨","link":"#âœ…-5-æä¾›çš„æ ¸å¿ƒæ–¹æ³•-ç”±å­ç±»è°ƒç”¨","children":[]},{"level":2,"title":"âœ… 6. æ ¸å¿ƒå·¥ä½œæµç¨‹ï¼ˆç‹¬å æ¨¡å¼ï¼‰","slug":"âœ…-6-æ ¸å¿ƒå·¥ä½œæµç¨‹-ç‹¬å æ¨¡å¼","link":"#âœ…-6-æ ¸å¿ƒå·¥ä½œæµç¨‹-ç‹¬å æ¨¡å¼","children":[]},{"level":2,"title":"ç¤ºä¾‹ï¼šacquire() è·å–é”æµç¨‹","slug":"ç¤ºä¾‹-acquire-è·å–é”æµç¨‹","link":"#ç¤ºä¾‹-acquire-è·å–é”æµç¨‹","children":[]},{"level":2,"title":"âœ… 7. è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹ï¼ˆç‹¬å é”ï¼‰","slug":"âœ…-7-è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹-ç‹¬å é”","link":"#âœ…-7-è‡ªå®šä¹‰åŒæ­¥å™¨ç¤ºä¾‹-ç‹¬å é”","children":[]},{"level":2,"title":"âœ… 8. AQS å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶ï¼ˆFIFOï¼‰","slug":"âœ…-8-aqs-å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶-fifo","link":"#âœ…-8-aqs-å†…éƒ¨é˜Ÿåˆ—æœºåˆ¶-fifo","children":[]},{"level":2,"title":"âœ… 9. AQS çš„å¥½å¤„","slug":"âœ…-9-aqs-çš„å¥½å¤„","link":"#âœ…-9-aqs-çš„å¥½å¤„","children":[]},{"level":2,"title":"âœ… 10. å¸¸è§åŸºäº AQS çš„å¹¶å‘ç»„ä»¶","slug":"âœ…-10-å¸¸è§åŸºäº-aqs-çš„å¹¶å‘ç»„ä»¶","link":"#âœ…-10-å¸¸è§åŸºäº-aqs-çš„å¹¶å‘ç»„ä»¶","children":[]},{"level":2,"title":"âœ… 11. é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿ï¼ˆå»ºè®®èƒŒè¯µï¼‰","slug":"âœ…-11-é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿-å»ºè®®èƒŒè¯µ","link":"#âœ…-11-é¢è¯•å¸¸é—®é—®é¢˜ä¸ç­”é¢˜æ¨¡æ¿-å»ºè®®èƒŒè¯µ","children":[]}],"readingTime":{"minutes":3.08,"words":925},"filePathRelative":"Interview/é¢è¯•ç­”é¢˜å¡/Java/AQSï¼ˆAbstractQueuedSynchronizerï¼‰è¯¦è§£.md","excerpt":"\\n<hr>\\n<h2>âœ… ä¸€å¥è¯æ¦‚æ‹¬</h2>\\n<blockquote>\\n<p>AQS æ˜¯ Java å¹¶å‘åŒ… <code>java.util.concurrent.locks</code> çš„æ ¸å¿ƒæŠ½è±¡ç±»ï¼Œç”¨äºæ„å»ºå„ç§åŒæ­¥å™¨ï¼Œå¦‚ï¼š<code>ReentrantLock</code>ã€<code>CountDownLatch</code>ã€<code>Semaphore</code> ç­‰ï¼Œå…¶é€šè¿‡ä¸€ä¸ªå…±äº«çš„ <code>state</code> çŠ¶æ€å­—æ®µ + FIFO ç­‰å¾…é˜Ÿåˆ—ï¼Œå®ç°çº¿ç¨‹é—´çš„åŒæ­¥æ§åˆ¶ã€‚</p>\\n</blockquote>\\n<hr>\\n<h2>âœ… 1. æ ¸å¿ƒè§’è‰²ä¸ç»“æ„</h2>\\n<h2>ğŸ“¦ ç±»åï¼š</h2>"}')}}]);