"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[90590],{66262:(e,a)=>{a.A=(e,a)=>{const i=e.__vccOpts||e;for(const[e,l]of a)i[e]=l;return i}},65222:(e,a,i)=>{i.r(a),i.d(a,{comp:()=>h,data:()=>s});var l=i(20641);const t={},h=(0,i(66262).A)(t,[["render",function(e,a){const i=(0,l.g2)("RouteLink");return(0,l.uX)(),(0,l.CE)("div",null,[a[2]||(a[2]=(0,l.Lk)("h1",{id:"ğŸ§ª-4-2-å¦‚ä½•åˆ†æ-java-å †è½¬å‚¨æ–‡ä»¶-hprof",tabindex:"-1"},[(0,l.Lk)("a",{class:"header-anchor",href:"#ğŸ§ª-4-2-å¦‚ä½•åˆ†æ-java-å †è½¬å‚¨æ–‡ä»¶-hprof"},[(0,l.Lk)("span",null,"ğŸ§ª 4.2 å¦‚ä½•åˆ†æ Java å †è½¬å‚¨æ–‡ä»¶ï¼ˆhprofï¼‰")])],-1)),a[3]||(a[3]=(0,l.Lk)("p",null,[(0,l.eW)("åœ¨é¢å¯¹ OOMã€å†…å­˜æ³„æ¼ã€å¯¹è±¡æ¿€å¢ç­‰é—®é¢˜æ—¶ï¼Œåˆ†æå †è½¬å‚¨ï¼ˆheap dumpï¼‰æ–‡ä»¶æ˜¯æœ€ç›´æ¥æœ‰æ•ˆçš„æ–¹å¼ä¹‹ä¸€ã€‚æœ¬èŠ‚ä»‹ç»å¦‚ä½•ç”Ÿæˆã€åŠ è½½ä¸åˆ†æ "),(0,l.Lk)("code",null,".hprof"),(0,l.eW)(" æ–‡ä»¶ã€‚")],-1)),a[4]||(a[4]=(0,l.Lk)("hr",null,null,-1)),(0,l.Q3)(" more "),a[5]||(a[5]=(0,l.Fv)('<h2 id="ğŸ“¦-ä»€ä¹ˆæ˜¯-heap-dump" tabindex="-1"><a class="header-anchor" href="#ğŸ“¦-ä»€ä¹ˆæ˜¯-heap-dump"><span>ğŸ“¦ ä»€ä¹ˆæ˜¯ Heap Dumpï¼Ÿ</span></a></h2><p>Heap Dump æ˜¯ JVM åœ¨æŸä¸€æ—¶é—´ç‚¹å†…å­˜å¿«ç…§ï¼Œè®°å½•äº†æ‰€æœ‰å¯¹è±¡å®ä¾‹åŠå…¶å¼•ç”¨å…³ç³»ã€‚é€šè¿‡åˆ†æå¯è¯†åˆ«ï¼š</p><ul><li>å†…å­˜æ³„æ¼æ¥æº</li><li>å¯¹è±¡ä¿ç•™é“¾ï¼ˆGC Root â†’ ... â†’ å¯¹è±¡ï¼‰</li><li>è°æŒæœ‰äº†æœ€å¤šå†…å­˜</li><li>å“ªäº›ç±»å®ä¾‹å¢é•¿å¼‚å¸¸</li></ul><hr><h2 id="ğŸ› ï¸-å¦‚ä½•ç”Ÿæˆ-heap-dump-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ğŸ› ï¸-å¦‚ä½•ç”Ÿæˆ-heap-dump-æ–‡ä»¶"><span>ğŸ› ï¸ å¦‚ä½•ç”Ÿæˆ Heap Dump æ–‡ä»¶ï¼Ÿ</span></a></h2><h3 id="âœ…-è‡ªåŠ¨ç”Ÿæˆ-æ¨è" tabindex="-1"><a class="header-anchor" href="#âœ…-è‡ªåŠ¨ç”Ÿæˆ-æ¨è"><span>âœ… è‡ªåŠ¨ç”Ÿæˆï¼ˆæ¨èï¼‰</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-XX:+HeapDumpOnOutOfMemoryError</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-XX:HeapDumpPath</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=/path/to/dump.hprof</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="âœ…-æ‰‹åŠ¨ç”Ÿæˆ" tabindex="-1"><a class="header-anchor" href="#âœ…-æ‰‹åŠ¨ç”Ÿæˆ"><span>âœ… æ‰‹åŠ¨ç”Ÿæˆ</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jmap</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -dump:format=b,file=heap.hprof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="âœ…-jdk-å…¶ä»–å·¥å…·" tabindex="-1"><a class="header-anchor" href="#âœ…-jdk-å…¶ä»–å·¥å…·"><span>âœ… JDK å…¶ä»–å·¥å…·</span></a></h3><ul><li><code>jcmd &lt;pid&gt; GC.heap_dump /path/to/heap.hprof</code></li><li>JVisualVM å›¾å½¢ç•Œé¢ï¼šå³é”® â†’ Dump Heap</li></ul><hr><h2 id="ğŸ”-å¸¸è§åˆ†æå·¥å…·" tabindex="-1"><a class="header-anchor" href="#ğŸ”-å¸¸è§åˆ†æå·¥å…·"><span>ğŸ” å¸¸è§åˆ†æå·¥å…·</span></a></h2><table><thead><tr><th>å·¥å…·</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Eclipse MAT</strong></td><td>æœ€ä¸»æµçš„å †åˆ†æå·¥å…·ï¼Œæ”¯æŒ dominator treeã€æ³„æ¼æŠ¥å‘Š</td></tr><tr><td>VisualVM</td><td>ç®€æ´ç›´è§‚ï¼Œé€‚åˆè½»é‡åˆ†æ</td></tr><tr><td>GCeasy.io</td><td>åœ¨çº¿ä¸Šä¼ åˆ†æï¼Œç”Ÿæˆç»“æ„åŒ–å›¾è¡¨å’ŒæŠ¥å‘Š</td></tr><tr><td>IBM HeapAnalyzer</td><td>è€ç‰Œå·¥å…·ï¼Œç•Œé¢è€æ—§ä½†æœ‰ç”¨</td></tr></tbody></table><hr><h2 id="ğŸ§­-eclipse-mat-åˆ†ææ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ğŸ§­-eclipse-mat-åˆ†ææ­¥éª¤"><span>ğŸ§­ Eclipse MAT åˆ†ææ­¥éª¤</span></a></h2><h3 id="_1-æ‰“å¼€-hprof-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-æ‰“å¼€-hprof-æ–‡ä»¶"><span>1. æ‰“å¼€ <code>.hprof</code> æ–‡ä»¶</span></a></h3><ul><li>å¯é…ç½®æœ€å¤§å†…å­˜ï¼š<code>eclipse.ini</code> ä¸­æ·»åŠ  <code>-Xmx4g</code></li></ul><h3 id="_2-æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_2-æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡"><span>2. æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡</span></a></h3><ul><li><code>Histogram</code> æŸ¥çœ‹æŒ‰ç±»åˆ†ç»„çš„å¯¹è±¡æ•°é‡ä¸å ç”¨å†…å­˜</li></ul><h3 id="_3-æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹" tabindex="-1"><a class="header-anchor" href="#_3-æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹"><span>3. æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹</span></a></h3><ul><li><code>Leak Suspects Report</code> è‡ªåŠ¨åˆ†ææ½œåœ¨å†…å­˜æ³„æ¼ç‚¹</li></ul><h3 id="_4-æŸ¥çœ‹ä¿ç•™è·¯å¾„-retained-set" tabindex="-1"><a class="header-anchor" href="#_4-æŸ¥çœ‹ä¿ç•™è·¯å¾„-retained-set"><span>4. æŸ¥çœ‹ä¿ç•™è·¯å¾„ï¼ˆRetained Setï¼‰</span></a></h3><ul><li><code>Dominator Tree</code>ï¼šçœ‹æ˜¯å“ªä¸ª GC Root é˜»æ­¢å¯¹è±¡å›æ”¶</li></ul><h3 id="_5-åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡" tabindex="-1"><a class="header-anchor" href="#_5-åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡"><span>5. åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡</span></a></h3><ul><li>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ <code>static</code>ã€<code>ThreadLocalMap</code> å ç”¨è¿‡å¤§</li></ul><hr><h2 id="ğŸ“Œ-æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š"><span>ğŸ“Œ æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š</span></a></h2><table><thead><tr><th>æ¦‚å¿µ</th><th>å«ä¹‰è¯´æ˜</th></tr></thead><tbody><tr><td>Shallow Size</td><td>å¯¹è±¡æœ¬èº«å ç”¨å†…å­˜å¤§å°ï¼Œä¸å«å¼•ç”¨å¯¹è±¡</td></tr><tr><td>Retained Size</td><td>å›æ”¶è¯¥å¯¹è±¡åï¼Œå¯é‡Šæ”¾çš„æ€»å†…å­˜å¤§å°</td></tr><tr><td>Dominator Tree</td><td>ä¸»å¯¼å¼•ç”¨é“¾ï¼Œæ‰¾å‡ºæœ€â€œéœ¸å â€å†…å­˜çš„å¯¹è±¡</td></tr><tr><td>GC Roots</td><td>åƒåœ¾å›æ”¶èµ·ç‚¹å¯¹è±¡é›†</td></tr></tbody></table><hr><h2 id="ğŸ“-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ“-å°ç»“"><span>ğŸ“ å°ç»“</span></a></h2><ul><li>HeapDump æ˜¯åˆ†æ OOMã€å†…å­˜æ³„æ¼ç­‰é—®é¢˜çš„æ ¸å¿ƒåˆ©å™¨</li><li>å»ºè®®ç”Ÿäº§ç¯å¢ƒå¼€å¯ <code>HeapDumpOnOutOfMemoryError</code></li><li>Eclipse MAT æä¾›ä¸°å¯Œçš„åˆ†æè§†è§’ä¸å›¾å½¢å·¥å…·</li><li>å…³æ³¨ Retained Sizeã€Dominator Tree å’Œ GC Roots</li></ul><hr>',33)),(0,l.Lk)("p",null,[a[1]||(a[1]=(0,l.eW)("ğŸ‘‰ ä¸‹ä¸€ç¯‡æ¨èï¼š")),(0,l.bF)(i,{to:"/JVM/%E4%B8%80%E5%91%BD%E9%80%9F%E9%80%9A/4.%20JVM%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B8%8E%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/4.3%E5%B8%B8%E8%A7%81%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%AE%9A%E4%BD%8D%E6%8A%80%E5%B7%A7.html"},{default:(0,l.k6)((()=>a[0]||(a[0]=[(0,l.eW)("4.3 å¸¸è§å†…å­˜æ³„æ¼æ¨¡å¼ä¸å®šä½æŠ€å·§")]))),_:1})])])}]]),s=JSON.parse('{"path":"/JVM/%E4%B8%80%E5%91%BD%E9%80%9F%E9%80%9A/4.%20JVM%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B8%8E%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/4.2%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%20Java%20%E5%A0%86%E8%BD%AC%E5%82%A8%E6%96%87%E4%BB%B6%EF%BC%88hprof%EF%BC%89.html","title":"4.2 å¦‚ä½•åˆ†æ Java å †è½¬å‚¨æ–‡ä»¶ï¼ˆhprofï¼‰","lang":"zh-CN","frontmatter":{"title":"4.2 å¦‚ä½•åˆ†æ Java å †è½¬å‚¨æ–‡ä»¶ï¼ˆhprofï¼‰","icon":"fa-solid fa-dumpster-fire","date":"2025-07-10T00:00:00.000Z","author":"JeanHu","category":["JVM"],"tag":["JVM","hprof","å †åˆ†æ","å†…å­˜æ’æŸ¥","MAT"],"summary":"æœ¬æ–‡è®²è§£å¦‚ä½•ç”Ÿæˆä¸åˆ†æ Java å †è½¬å‚¨æ–‡ä»¶ï¼ˆhprofï¼‰ï¼Œæ¶µç›–å·¥å…·é€‰æ‹©ã€åˆ†ææµç¨‹ã€å†…å­˜æ³„æ¼è¯†åˆ«æŠ€å·§ä»¥åŠå¸¸è§é—®é¢˜æ’æŸ¥å®æˆ˜ï¼Œå¸®åŠ©å¼€å‘è€…æŒæ¡å†…å­˜é—®é¢˜å®šä½çš„æ ¸å¿ƒèƒ½åŠ›ã€‚","gitInclude":[]},"headers":[{"level":2,"title":"ğŸ“¦ ä»€ä¹ˆæ˜¯ Heap Dumpï¼Ÿ","slug":"ğŸ“¦-ä»€ä¹ˆæ˜¯-heap-dump","link":"#ğŸ“¦-ä»€ä¹ˆæ˜¯-heap-dump","children":[]},{"level":2,"title":"ğŸ› ï¸ å¦‚ä½•ç”Ÿæˆ Heap Dump æ–‡ä»¶ï¼Ÿ","slug":"ğŸ› ï¸-å¦‚ä½•ç”Ÿæˆ-heap-dump-æ–‡ä»¶","link":"#ğŸ› ï¸-å¦‚ä½•ç”Ÿæˆ-heap-dump-æ–‡ä»¶","children":[{"level":3,"title":"âœ… è‡ªåŠ¨ç”Ÿæˆï¼ˆæ¨èï¼‰","slug":"âœ…-è‡ªåŠ¨ç”Ÿæˆ-æ¨è","link":"#âœ…-è‡ªåŠ¨ç”Ÿæˆ-æ¨è","children":[]},{"level":3,"title":"âœ… æ‰‹åŠ¨ç”Ÿæˆ","slug":"âœ…-æ‰‹åŠ¨ç”Ÿæˆ","link":"#âœ…-æ‰‹åŠ¨ç”Ÿæˆ","children":[]},{"level":3,"title":"âœ… JDK å…¶ä»–å·¥å…·","slug":"âœ…-jdk-å…¶ä»–å·¥å…·","link":"#âœ…-jdk-å…¶ä»–å·¥å…·","children":[]}]},{"level":2,"title":"ğŸ” å¸¸è§åˆ†æå·¥å…·","slug":"ğŸ”-å¸¸è§åˆ†æå·¥å…·","link":"#ğŸ”-å¸¸è§åˆ†æå·¥å…·","children":[]},{"level":2,"title":"ğŸ§­ Eclipse MAT åˆ†ææ­¥éª¤","slug":"ğŸ§­-eclipse-mat-åˆ†ææ­¥éª¤","link":"#ğŸ§­-eclipse-mat-åˆ†ææ­¥éª¤","children":[{"level":3,"title":"1. æ‰“å¼€ .hprof æ–‡ä»¶","slug":"_1-æ‰“å¼€-hprof-æ–‡ä»¶","link":"#_1-æ‰“å¼€-hprof-æ–‡ä»¶","children":[]},{"level":3,"title":"2. æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡","slug":"_2-æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡","link":"#_2-æŸ¥æ‰¾å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡","children":[]},{"level":3,"title":"3. æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹","slug":"_3-æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹","link":"#_3-æŸ¥æ‰¾æ³„æ¼ç–‘ç‚¹","children":[]},{"level":3,"title":"4. æŸ¥çœ‹ä¿ç•™è·¯å¾„ï¼ˆRetained Setï¼‰","slug":"_4-æŸ¥çœ‹ä¿ç•™è·¯å¾„-retained-set","link":"#_4-æŸ¥çœ‹ä¿ç•™è·¯å¾„-retained-set","children":[]},{"level":3,"title":"5. åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡","slug":"_5-åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡","link":"#_5-åˆ†æé™æ€å­—æ®µã€çº¿ç¨‹å±€éƒ¨å˜é‡","children":[]}]},{"level":2,"title":"ğŸ“Œ æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š","slug":"ğŸ“Œ-æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š","link":"#ğŸ“Œ-æ¡ˆä¾‹å…³é”®æœ¯è¯­è§£é‡Š","children":[]},{"level":2,"title":"ğŸ“ å°ç»“","slug":"ğŸ“-å°ç»“","link":"#ğŸ“-å°ç»“","children":[]}],"readingTime":{"minutes":2.17,"words":650},"filePathRelative":"JVM/ä¸€å‘½é€Ÿé€š/4. JVMæ€§èƒ½è°ƒä¼˜ä¸ç›‘æ§å·¥å…·/4.2å¦‚ä½•åˆ†æ Java å †è½¬å‚¨æ–‡ä»¶ï¼ˆhprofï¼‰.md","localizedDate":"2025å¹´7æœˆ10æ—¥","excerpt":"\\n<p>åœ¨é¢å¯¹ OOMã€å†…å­˜æ³„æ¼ã€å¯¹è±¡æ¿€å¢ç­‰é—®é¢˜æ—¶ï¼Œåˆ†æå †è½¬å‚¨ï¼ˆheap dumpï¼‰æ–‡ä»¶æ˜¯æœ€ç›´æ¥æœ‰æ•ˆçš„æ–¹å¼ä¹‹ä¸€ã€‚æœ¬èŠ‚ä»‹ç»å¦‚ä½•ç”Ÿæˆã€åŠ è½½ä¸åˆ†æ <code>.hprof</code> æ–‡ä»¶ã€‚</p>\\n<hr>\\n"}')}}]);