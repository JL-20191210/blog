"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[90913],{66262:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,n]of s)a[i]=n;return a}},34878:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>e,data:()=>t});var n=a(20641);const l={},e=(0,a(66262).A)(l,[["render",function(i,s){return(0,n.uX)(),(0,n.CE)("div",null,[s[0]||(s[0]=(0,n.Lk)("h1",{id:"enabletransactionmanagement-ä½¿ç”¨æŒ‡å—",tabindex:"-1"},[(0,n.Lk)("a",{class:"header-anchor",href:"#enabletransactionmanagement-ä½¿ç”¨æŒ‡å—"},[(0,n.Lk)("span",null,"@EnableTransactionManagement ä½¿ç”¨æŒ‡å—")])],-1)),s[1]||(s[1]=(0,n.Lk)("p",null,[(0,n.Lk)("code",null,"@EnableTransactionManagement"),(0,n.eW)(" æ˜¯ Spring æä¾›çš„æ³¨è§£ï¼Œç”¨äºå¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ç®¡ç†åŠŸèƒ½ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å…¶ä½¿ç”¨æ–¹æ³•ã€æœ€ä½³å®è·µä»¥åŠæ¨èçš„é…ç½®ä½ç½®ã€‚")],-1)),s[2]||(s[2]=(0,n.Lk)("hr",null,null,-1)),(0,n.Q3)(" more "),s[3]||(s[3]=(0,n.Fv)('<h2 id="_1-ä»€ä¹ˆæ˜¯-enabletransactionmanagement" tabindex="-1"><a class="header-anchor" href="#_1-ä»€ä¹ˆæ˜¯-enabletransactionmanagement"><span>1. ä»€ä¹ˆæ˜¯ @EnableTransactionManagement</span></a></h2><p><code>@EnableTransactionManagement</code> æ˜¯ä¸€ä¸ªå…³é”®æ³¨è§£ï¼Œç”¨äºå¯ç”¨ Spring çš„æ³¨è§£é©±åŠ¨äº‹åŠ¡ç®¡ç†åŠŸèƒ½ã€‚ç»“åˆ <code>@Transactional</code> æ³¨è§£ï¼Œå¯ä»¥è®© Spring åœ¨æ–¹æ³•æ‰§è¡ŒæœŸé—´è‡ªåŠ¨ç®¡ç†äº‹åŠ¡çš„å¼€å¯ã€æäº¤æˆ–å›æ»šã€‚</p><hr><h2 id="_2-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#_2-åŸºæœ¬ç”¨æ³•"><span>2. åŸºæœ¬ç”¨æ³•</span></a></h2><h3 id="_2-1-æ·»åŠ ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_2-1-æ·»åŠ ä¾èµ–"><span>2.1 æ·»åŠ ä¾èµ–</span></a></h3><p>åœ¨é¡¹ç›®ä¸­å¼•å…¥ä¸äº‹åŠ¡ç®¡ç†ç›¸å…³çš„ä¾èµ–ï¼Œä¾‹å¦‚ Spring JDBC æˆ– Spring Data JPAã€‚</p><p><strong>Maven ç¤ºä¾‹</strong>ï¼š</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.springframework.boot&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;spring-boot-starter-data-jpa&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸ“—Spring JDBCä¾èµ–å·²ç»é›†æˆåœ¨mybatiså¯åŠ¨å™¨ä¸­</p><h3 id="_2-2-é…ç½®-enabletransactionmanagement" tabindex="-1"><a class="header-anchor" href="#_2-2-é…ç½®-enabletransactionmanagement"><span>2.2 é…ç½® @EnableTransactionManagement</span></a></h3><p>åœ¨é…ç½®ç±»ä¸­æ·»åŠ  <code>@EnableTransactionManagement</code> æ³¨è§£ï¼ŒåŒæ—¶é…ç½®æ•°æ®æºå’Œäº‹åŠ¡ç®¡ç†å™¨ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Configuration</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">EnableTransactionManagement</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> TransactionConfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DataSource</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> dataSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> HikariDataSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> PlatformTransactionManager</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> transactionManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">DataSource</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> dataSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> DataSourceTransactionManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(dataSource);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-ä½¿ç”¨-transactional" tabindex="-1"><a class="header-anchor" href="#_2-3-ä½¿ç”¨-transactional"><span>2.3 ä½¿ç”¨ @Transactional</span></a></h3><p>åœ¨éœ€è¦äº‹åŠ¡æ”¯æŒçš„ç±»æˆ–æ–¹æ³•ä¸Šæ·»åŠ  <code>@Transactional</code> æ³¨è§£ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Service</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Autowired</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyRepository</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> myRepository</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Transactional</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> performTransaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        myRepository</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Entity</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (someCondition) {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Trigger rollback&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_3-enabletransactionmanagement-çš„æ”¾ç½®ä½ç½®" tabindex="-1"><a class="header-anchor" href="#_3-enabletransactionmanagement-çš„æ”¾ç½®ä½ç½®"><span>3. @EnableTransactionManagement çš„æ”¾ç½®ä½ç½®</span></a></h2><h3 id="_3-1-ä¸»é…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#_3-1-ä¸»é…ç½®ç±»"><span>3.1 ä¸»é…ç½®ç±»</span></a></h3><p>é€‚ç”¨äºå°å‹é¡¹ç›®æˆ–ç®€å•é…ç½®åœºæ™¯ï¼Œå¯ç›´æ¥å°† <code>@EnableTransactionManagement</code> æ”¾åœ¨ä¸»é…ç½®ç±»ï¼ˆå¦‚æ ‡æ³¨äº† <code>@SpringBootApplication</code> çš„ç±»ï¼‰ä¸­ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">SpringBootApplication</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">EnableTransactionManagement</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        SpringApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Application</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, args);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#_3-2-å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»"><span>3.2 å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»</span></a></h3><p>å¯¹äºä¸­å¤§å‹é¡¹ç›®ï¼Œå»ºè®®å°†äº‹åŠ¡é…ç½®ä¸å…¶ä»–é…ç½®åˆ†ç¦»ï¼Œåˆ›å»ºä¸“é—¨çš„äº‹åŠ¡ç®¡ç†é…ç½®ç±»ï¼Œä¾¿äºç»´æŠ¤ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Configuration</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">EnableTransactionManagement</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> TransactionConfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> PlatformTransactionManager</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> transactionManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">DataSource</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> dataSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> DataSourceTransactionManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(dataSource);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-æ¨¡å—åŒ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-3-æ¨¡å—åŒ–é…ç½®"><span>3.3 æ¨¡å—åŒ–é…ç½®</span></a></h3><p>åœ¨æ¨¡å—åŒ–é¡¹ç›®ä¸­ï¼Œå¯ä»¥å°† <code>@EnableTransactionManagement</code> æ”¾ç½®åœ¨ä¸æ•°æ®åº“æˆ–æ•°æ®è®¿é—®ç›¸å…³çš„æ¨¡å—é…ç½®ç±»ä¸­ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Configuration</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">ComponentScan</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">basePackages</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;com.example.repository&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">EnableTransactionManagement</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> RepositoryConfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // æ•°æ®åº“å’Œäº‹åŠ¡ç›¸å…³çš„é…ç½®</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_4-å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#_4-å·¥ä½œåŸç†"><span>4. å·¥ä½œåŸç†</span></a></h2><ol><li><strong>äº‹åŠ¡æ‹¦æˆªå™¨</strong>ï¼šSpring ä¼šé€šè¿‡ <code>TransactionInterceptor</code> æ‹¦æˆªè¢« <code>@Transactional</code> æ ‡æ³¨çš„æ–¹æ³•ã€‚</li><li><strong>äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæˆåæäº¤äº‹åŠ¡ï¼›è‹¥æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡ã€‚</li><li><strong>ä»£ç†æœºåˆ¶</strong>ï¼šSpring ä½¿ç”¨ AOP æˆ– CGLIB åŠ¨æ€ä»£ç†æ¥å®ç°äº‹åŠ¡ç®¡ç†ã€‚</li></ol><hr><h2 id="_5-æ¨èå®è·µ" tabindex="-1"><a class="header-anchor" href="#_5-æ¨èå®è·µ"><span>5. æ¨èå®è·µ</span></a></h2><ul><li><strong>å°å‹é¡¹ç›®</strong>ï¼šåœ¨ä¸»é…ç½®ç±»ä¸­ç›´æ¥ä½¿ç”¨ <code>@EnableTransactionManagement</code>ã€‚</li><li><strong>ä¸­å¤§å‹é¡¹ç›®</strong>ï¼šå°†äº‹åŠ¡ç®¡ç†é…ç½®å•ç‹¬æŠ½ç¦»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„é…ç½®ç±»ï¼Œæå‡ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</li><li><strong>æ¨¡å—åŒ–é¡¹ç›®</strong>ï¼šæ ¹æ®æ¨¡å—åŒ–è®¾è®¡éœ€æ±‚ï¼Œå°†äº‹åŠ¡ç®¡ç†é…ç½®æ”¾åœ¨å¯¹åº”æ¨¡å—çš„é…ç½®ç±»ä¸­ã€‚</li></ul><hr><h2 id="_6-æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#_6-æ³¨æ„äº‹é¡¹"><span>6. æ³¨æ„äº‹é¡¹</span></a></h2><ol><li><p><strong>ä»£ç†æœºåˆ¶</strong>ï¼š<br><code>@Transactional</code> ä»…å¯¹ç”± Spring å®¹å™¨ç®¡ç†çš„ Bean ç”Ÿæ•ˆï¼Œä¸”åŒä¸€ç±»å†…çš„æ–¹æ³•è°ƒç”¨ä¸ä¼šè§¦å‘äº‹åŠ¡æ‹¦æˆªã€‚</p></li><li><p><strong>å¼‚å¸¸ç±»å‹</strong>ï¼š<br> é»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ä»…å¯¹ <code>RuntimeException</code> å’Œ <code>Error</code> å›æ»šã€‚è‹¥éœ€æ”¯æŒå…¶ä»–å¼‚å¸¸ç±»å‹ï¼Œå¯é€šè¿‡ <code>rollbackFor</code> å±æ€§æ˜¾å¼æŒ‡å®šã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Transactional</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">rollbackFor</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> performTransaction</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // äº‹åŠ¡é€»è¾‘</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åªè¯»äº‹åŠ¡</strong>ï¼š<br> å¯¹ä»…æ‰§è¡ŒæŸ¥è¯¢æ“ä½œçš„æ–¹æ³•æ ‡æ³¨ <code>@Transactional(readOnly = true)</code>ï¼Œå¯ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Transactional</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">readOnly</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">Entity</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> fetchEntities</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> repository</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">findAll</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h2 id="_7-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_7-æ€»ç»“"><span>7. æ€»ç»“</span></a></h2><ul><li><code>@EnableTransactionManagement</code> æ˜¯å¼€å¯æ³¨è§£é©±åŠ¨äº‹åŠ¡ç®¡ç†çš„æ ¸å¿ƒæ³¨è§£ã€‚</li><li>æ¨èå°†äº‹åŠ¡ç®¡ç†é…ç½®ä¸å…¶ä»–é…ç½®åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li><li>åœ¨å¤æ‚é¡¹ç›®ä¸­ï¼Œæ ¹æ®æ¨¡å—éœ€æ±‚çµæ´»æ”¾ç½® <code>@EnableTransactionManagement</code>ï¼Œç¡®ä¿äº‹åŠ¡ç®¡ç†çš„çµæ´»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</li></ul><hr><p>é€šè¿‡åˆç†ä½¿ç”¨ <code>@EnableTransactionManagement</code>ï¼Œå¯ä»¥æœ‰æ•ˆç®€åŒ–äº‹åŠ¡ç®¡ç†ï¼Œå¢å¼ºä»£ç çš„å¯é æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œä»è€Œæ»¡è¶³ä¸åŒè§„æ¨¡é¡¹ç›®çš„äº‹åŠ¡éœ€æ±‚ã€‚</p>',45))])}]]),t=JSON.parse('{"path":"/Spring/%E6%B3%A8%E8%A7%A3/@EnableTransactionManagement.html","title":"@EnableTransactionManagement ä½¿ç”¨æŒ‡å—","lang":"zh-CN","frontmatter":{"icon":"fa-solid fa-hashtag","date":"2024-11-18T00:00:00.000Z","category":["Spring"],"tag":["æ³¨è§£"],"gitInclude":[]},"headers":[{"level":2,"title":"1. ä»€ä¹ˆæ˜¯ @EnableTransactionManagement","slug":"_1-ä»€ä¹ˆæ˜¯-enabletransactionmanagement","link":"#_1-ä»€ä¹ˆæ˜¯-enabletransactionmanagement","children":[]},{"level":2,"title":"2. åŸºæœ¬ç”¨æ³•","slug":"_2-åŸºæœ¬ç”¨æ³•","link":"#_2-åŸºæœ¬ç”¨æ³•","children":[{"level":3,"title":"2.1 æ·»åŠ ä¾èµ–","slug":"_2-1-æ·»åŠ ä¾èµ–","link":"#_2-1-æ·»åŠ ä¾èµ–","children":[]},{"level":3,"title":"2.2 é…ç½® @EnableTransactionManagement","slug":"_2-2-é…ç½®-enabletransactionmanagement","link":"#_2-2-é…ç½®-enabletransactionmanagement","children":[]},{"level":3,"title":"2.3 ä½¿ç”¨ @Transactional","slug":"_2-3-ä½¿ç”¨-transactional","link":"#_2-3-ä½¿ç”¨-transactional","children":[]}]},{"level":2,"title":"3. @EnableTransactionManagement çš„æ”¾ç½®ä½ç½®","slug":"_3-enabletransactionmanagement-çš„æ”¾ç½®ä½ç½®","link":"#_3-enabletransactionmanagement-çš„æ”¾ç½®ä½ç½®","children":[{"level":3,"title":"3.1 ä¸»é…ç½®ç±»","slug":"_3-1-ä¸»é…ç½®ç±»","link":"#_3-1-ä¸»é…ç½®ç±»","children":[]},{"level":3,"title":"3.2 å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»","slug":"_3-2-å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»","link":"#_3-2-å•ç‹¬çš„äº‹åŠ¡é…ç½®ç±»","children":[]},{"level":3,"title":"3.3 æ¨¡å—åŒ–é…ç½®","slug":"_3-3-æ¨¡å—åŒ–é…ç½®","link":"#_3-3-æ¨¡å—åŒ–é…ç½®","children":[]}]},{"level":2,"title":"4. å·¥ä½œåŸç†","slug":"_4-å·¥ä½œåŸç†","link":"#_4-å·¥ä½œåŸç†","children":[]},{"level":2,"title":"5. æ¨èå®è·µ","slug":"_5-æ¨èå®è·µ","link":"#_5-æ¨èå®è·µ","children":[]},{"level":2,"title":"6. æ³¨æ„äº‹é¡¹","slug":"_6-æ³¨æ„äº‹é¡¹","link":"#_6-æ³¨æ„äº‹é¡¹","children":[]},{"level":2,"title":"7. æ€»ç»“","slug":"_7-æ€»ç»“","link":"#_7-æ€»ç»“","children":[]}],"readingTime":{"minutes":3.02,"words":905},"filePathRelative":"Spring/æ³¨è§£/@EnableTransactionManagement.md","localizedDate":"2024å¹´11æœˆ18æ—¥","excerpt":"\\n<p><code>@EnableTransactionManagement</code> æ˜¯ Spring æä¾›çš„æ³¨è§£ï¼Œç”¨äºå¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ç®¡ç†åŠŸèƒ½ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å…¶ä½¿ç”¨æ–¹æ³•ã€æœ€ä½³å®è·µä»¥åŠæ¨èçš„é…ç½®ä½ç½®ã€‚</p>\\n<hr>\\n"}')}}]);