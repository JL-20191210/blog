"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[56015],{66262:(s,a)=>{a.A=(s,a)=>{const n=s.__vccOpts||s;for(const[s,i]of a)n[s]=i;return n}},60924:(s,a,n)=>{n.r(a),n.d(a,{comp:()=>u,data:()=>v});var i=n(20641);const e=n.p+"assets/img/1757073092190-319aa1ce-17ba-440c-9507-d07f3e44b592.5598f026.png",l=n.p+"assets/img/1757073092379-a47ab5f2-d065-4357-a4a1-22c17866c73d.641735e5.png",p=n.p+"assets/img/1757073092114-359fab6a-de63-4706-bbba-55ea61acc370.a4d7b742.png",c=n.p+"assets/img/1757073092071-6fa76013-ecee-491f-a3dd-3b53ae3f44c2.3f54bb48.png",d=n.p+"assets/img/1757073092070-27244313-5c79-4d4e-8a4f-94d037e3e2a5.6b7a00d6.png",r=n.p+"assets/img/1757073092279-c5b1ceaa-d90c-42b0-ad98-9fb5d1554015.2c66466d.png",t=n.p+"assets/img/1757073092236-2016cb07-d622-4244-8386-ec954a902cfb.45784584.png",o=n.p+"assets/img/1757073092364-cea61cd8-56fe-4e77-9972-b685d71fccb7.bf82eb9d.png",h=n.p+"assets/img/1757073092706-fef51ad4-5abe-4124-8218-e6e80d6708f7.b936efb6.png",g=n.p+"assets/img/1757073092526-7faa5860-f6e9-4ec4-945f-45a34b82f4c9.854ac314.png",b={},u=(0,n(66262).A)(b,[["render",function(s,a){return(0,i.uX)(),(0,i.CE)("div",null,a[0]||(a[0]=[(0,i.Fv)('<h1 id="nacos多节点部署" tabindex="-1"><a class="header-anchor" href="#nacos多节点部署"><span>Nacos多节点部署</span></a></h1><p>Nacos集群安装一，在每台服务器上安装nacos</p><h3 id="_1-准备安装包github下载点" tabindex="-1"><a class="header-anchor" href="#_1-准备安装包github下载点"><span>1.准备安装包<a href="https://github.com/alibaba/nacos/releases" target="_blank" rel="noopener noreferrer">github下载点</a></span></a></h3><h3 id="_2-在-usr-local-目录下创建一个文件夹用于上传和解压nacos" tabindex="-1"><a class="header-anchor" href="#_2-在-usr-local-目录下创建一个文件夹用于上传和解压nacos"><span>2.在/usr/local/目录下创建一个文件夹用于上传和解压Nacos</span></a></h3><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /usr/local/</span></span>\n<span class="line"><span>#这里创建文件夹名字可随意，解压后会生成一个名为nacos的文件夹，后续会移动至/usr/local/</span></span>\n<span class="line"><span>mkdir nacosall</span></span>\n<span class="line"><span>#解压之前cd进安装包根目录</span></span>\n<span class="line"><span>cd /usr/local/nacosall/</span></span>\n<span class="line"><span>#这边选择的Nacos版本为2.1.0</span></span>\n<span class="line"><span>tar -zxxvf nacos-server-2.1.0.tar.gz</span></span>\n<span class="line"><span>#把该文件移动至/usr/local/目录下</span></span>\n<span class="line"><span>mv nacos /usr/local/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-以单机模式运行nacos" tabindex="-1"><a class="header-anchor" href="#_3-以单机模式运行nacos"><span>3.以单机模式运行Nacos</span></a></h3><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#首先进入nacos的bin目录下</span></span>\n<span class="line"><span>cd /usr/local/nacos/</span></span>\n<span class="line"><span>#以单机模式启动</span></span>\n<span class="line"><span>sh ./bin/startup.sh -m standalone</span></span>\n<span class="line"><span>which: no javac in (/opt/rh/devtoolset-9/root/usr/bin:/usr/local/sbin:/usr/local/bin:                                              /usr/sbin:/usr/bin:/root/bin)</span></span>\n<span class="line"><span>readlink: 缺少操作数</span></span>\n<span class="line"><span>yum install -y java-1.8.0-openjdk*</span></span>\n<span class="line"><span>#再次启动</span></span>\n<span class="line"><span>sh ./bin/startup.sh -m standalone</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+e+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#根据提示查看log，看是否成功启动</span></span>\n<span class="line"><span>cat /usr/local/nacos/logs/start.out</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+l+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>开放8848端口号，然后登录nacos，登陆方式，主机Ip:8848/nacos,默认账户密码都为nacos</strong></p><figure><img src="'+p+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="_4-配置mysql数据库-因为是集群-所以三台服务器的nacos数据库地址为同一个" tabindex="-1"><a class="header-anchor" href="#_4-配置mysql数据库-因为是集群-所以三台服务器的nacos数据库地址为同一个"><span><strong>4.配置Mysql数据库</strong>（因为是集群，所以三台服务器的Nacos数据库地址为同一个)</span></a></h3><ul><li><a href="https://www.cnblogs.com/blogof-fusu/p/16710871.html" target="_blank" rel="noopener noreferrer">安装数据库</a>，版本要求：5.6.5+，安装教程为8.0.20</li><li>初始化mysql数据库，数据库初始化文件：nacos-mysql.sql</li></ul><p>数据库初始化文件一般在nacos的安装目录下：</p><p><img src="'+c+'" alt="img" loading="lazy">打开DBeaver或者Navicat，先执行如下语句：</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>CREATE database if NOT EXISTS `nacos` default character set utf8mb4 collate utf8mb4_unicode_ci;</span></span>\n<span class="line"><span>use `nacos`;</span></span>\n<span class="line"><span>SET NAMES utf8mb4;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后复制数据库初始化文件，nacos-mysql.sql中的文件内容执行。</p><ul><li>在Nacos配置文件中绑定Mysql数据库</li></ul><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#进入Nacos配置文件目录</span></span>\n<span class="line"><span>cd /usr/local/nacos/conf/</span></span>\n<span class="line"><span>ls</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+d+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi application.properties</span></span>\n<span class="line"><span>#修改如下配置</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+r+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#查看Nacos是否运行</span></span>\n<span class="line"><span>ps -ef | grep nacos</span></span>\n<span class="line"><span>#如果有</span></span>\n<span class="line"><span>kill -9 &lt;id&gt;</span></span>\n<span class="line"><span>#进入安装目录</span></span>\n<span class="line"><span>cd /usr/local/nacos/</span></span>\n<span class="line"><span>#单机启动Nacos</span></span>\n<span class="line"><span>sh ./bin/startup.sh -m standalone</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动成功后，再次执行</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#查看Nacos是否运行</span></span>\n<span class="line"><span>ps -ef | grep nacos</span></span>\n<span class="line"><span>#杀掉进程</span></span>\n<span class="line"><span>kill -9 &lt;id&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到这里三台服务器的nacos就已经安装配置好了，下一步配置集群二，配置nacos集群1,在每台服务器上都配置cluster.conf文件cluster.conf文件一般都在nacos安装目录的conf文件夹下</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /usr/local/nacos/conf</span></span>\n<span class="line"><span>ls</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+t+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#复制一份配置文件</span></span>\n<span class="line"><span>cp cluster.conf.example cluster.conf</span></span>\n<span class="line"><span>vi cluster.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+o+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>在配置文件中添加Nacos服务节点，配置格式如下(注意每台服务器的防火墙必须开放对应端口：</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>192.168.1.101:8848</span></span>\n<span class="line"><span>192.168.1.102:8848</span></span>\n<span class="line"><span>192.168.1.103:8848</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2，在每台服务器上启动Nacos</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#进入安装目录</span></span>\n<span class="line"><span>cd /usr/local/nacos/</span></span>\n<span class="line"><span>#以集群模式启动</span></span>\n<span class="line"><span>sh ./bin/startup.sh -m cluster</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+h+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>启动成功后会有提示，此时无论从任何一台服务器都能够访问nacos，而且所有变更同时作用在三个nacos节点上。三，配置nginx负载均衡1,在nginx中添加一个upstream块，用于配置nacos集群节点，如下所示：</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#nacos集群负载均衡</span></span>\n<span class="line"><span>    upstream nacos-cluster {</span></span>\n<span class="line"><span>        server 192.168.5.216:8848;</span></span>\n<span class="line"><span>        server 192.168.5.85:8848;</span></span>\n<span class="line"><span>        server 192.168.5.86:8848;</span></span>\n<span class="line"><span>    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此处修改的nginx的，nginx,conf配置文件2,在nginx中配置一个location块，用于将客户端请求代理到上面配置的nacos集群节点，如下所示：</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>location /nacos {</span></span>\n<span class="line"><span>        proxy_pass http://nacos-cluster;</span></span>\n<span class="line"><span>    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="'+g+'" alt="img" loading="lazy">最后重启nginx，通过代理后的地址访问nacos即可。</p>',41)]))}]]),v=JSON.parse('{"path":"/SpringCloud/%E5%AE%9E%E7%94%A8/Nacos/5.Nacos%E5%A4%9A%E8%8A%82%E7%82%B9%E9%83%A8%E7%BD%B2.html","title":"Nacos多节点部署","lang":"zh-CN","frontmatter":{"gitInclude":[]},"headers":[{"level":3,"title":"1.准备安装包github下载点","slug":"_1-准备安装包github下载点","link":"#_1-准备安装包github下载点","children":[]},{"level":3,"title":"2.在/usr/local/目录下创建一个文件夹用于上传和解压Nacos","slug":"_2-在-usr-local-目录下创建一个文件夹用于上传和解压nacos","link":"#_2-在-usr-local-目录下创建一个文件夹用于上传和解压nacos","children":[]},{"level":3,"title":"3.以单机模式运行Nacos","slug":"_3-以单机模式运行nacos","link":"#_3-以单机模式运行nacos","children":[]},{"level":3,"title":"4.配置Mysql数据库（因为是集群，所以三台服务器的Nacos数据库地址为同一个)","slug":"_4-配置mysql数据库-因为是集群-所以三台服务器的nacos数据库地址为同一个","link":"#_4-配置mysql数据库-因为是集群-所以三台服务器的nacos数据库地址为同一个","children":[]}],"readingTime":{"minutes":2.92,"words":877},"filePathRelative":"SpringCloud/实用/Nacos/5.Nacos多节点部署.md","excerpt":"\\n<p>Nacos集群安装一，在每台服务器上安装nacos</p>\\n<h3><a class=\\"header-anchor\\" href=\\"#_1-准备安装包github下载点\\"><span>1.准备安装包</span></a><a href=\\"https://github.com/alibaba/nacos/releases\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">github下载点</a></h3>\\n<h3>2.在/usr/local/目录下创建一个文件夹用于上传和解压Nacos</h3>\\n<div class=\\"language-plain line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"plain\\" data-title=\\"plain\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>cd /usr/local/</span></span>\\n<span class=\\"line\\"><span>#这里创建文件夹名字可随意，解压后会生成一个名为nacos的文件夹，后续会移动至/usr/local/</span></span>\\n<span class=\\"line\\"><span>mkdir nacosall</span></span>\\n<span class=\\"line\\"><span>#解压之前cd进安装包根目录</span></span>\\n<span class=\\"line\\"><span>cd /usr/local/nacosall/</span></span>\\n<span class=\\"line\\"><span>#这边选择的Nacos版本为2.1.0</span></span>\\n<span class=\\"line\\"><span>tar -zxxvf nacos-server-2.1.0.tar.gz</span></span>\\n<span class=\\"line\\"><span>#把该文件移动至/usr/local/目录下</span></span>\\n<span class=\\"line\\"><span>mv nacos /usr/local/</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}')}}]);