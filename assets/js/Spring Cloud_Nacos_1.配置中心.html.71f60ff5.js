"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6202],{6262:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,n]of i)a[s]=n;return a}},7998:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>r,data:()=>k});var n=a(641);const e=a.p+"assets/img/image-20241027214801643.bf74762d.png",l=a.p+"assets/img/image-20241027221436904.4c42cd23.png",t=a.p+"assets/img/image-20241027221952283.5e68a40f.png",p=a.p+"assets/img/image-20241027222735401.a29d2468.png",h={},r=(0,a(6262).A)(h,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<h2 id="如何使用nacos作为配置中心统一管理配置" tabindex="-1"><a class="header-anchor" href="#如何使用nacos作为配置中心统一管理配置"><span>如何使用Nacos作为配置中心统一管理配置</span></a></h2><h3 id="_1-引入依赖" tabindex="-1"><a class="header-anchor" href="#_1-引入依赖"><span>1.引入依赖</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">\t\t&lt;!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">作为配置中心</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">\t\t&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">\t\t\t&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">alibaba</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">cloud</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">\t\t\t&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">spring</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">cloud</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">starter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">alibaba</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">nacos</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">config</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">\t\t&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-创建一个bootstrap-properties" tabindex="-1"><a class="header-anchor" href="#_2-创建一个bootstrap-properties"><span>2.创建一个bootstrap.properties</span></a></h3><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.application.name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">coupon</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.cloud.nacos.config.server-addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">192.168.68.86:8848</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-创建配置" tabindex="-1"><a class="header-anchor" href="#_3-创建配置"><span>3.创建配置</span></a></h3><blockquote><p>需要给配置中心默认添加一个数据集（Data Id）coupon.properties。</p><p>默认规则：应用名.properties（应用启动时控制台会输出，是Nacos上注册的应用名）</p></blockquote><h3 id="_4-给coupon-properties添加配置" tabindex="-1"><a class="header-anchor" href="#_4-给coupon-properties添加配置"><span>4.给coupon.properties添加配置</span></a></h3><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">coupon.user.name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">wangmazi</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">coupon.user.age</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">29</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-动态获取配置" tabindex="-1"><a class="header-anchor" href="#_5-动态获取配置"><span>5.动态获取配置</span></a></h3><blockquote><p><code>@RefreshScope</code>:动态获取并刷新配置</p><p><code>@Value(&quot;${coupon.user.name}&quot;)</code>：获取到配置</p><p>配置中心优先：如果配置中心和当前应用的配置文件中都配置了相同的项，优先使用配置中心的配置</p></blockquote><h3 id="_6-命名空间" tabindex="-1"><a class="header-anchor" href="#_6-命名空间"><span>6.命名空间</span></a></h3><blockquote><p>🌟配置隔离</p><p>默认：public（保留空间）；默认新增的配置都在public空间</p><ol><li><p>开发，测试，生产：利用命名空间来做环境隔离</p><p>⚠️在<code>bootstrap.properties</code>配置上，需要指明使用哪个命名空间下的配置</p><p><code>spring.cloud.nacos.config.namespace=b729ba7b-9f1b-4a3f-87b4-d41906ac6c44</code></p></li><li><p>每一个微服务之间互相隔离配置，每一个微服务都创建自己的命名空间，只加载自己命名空间下的所有配置</p></li></ol></blockquote><figure><img src="'+e+'" alt="image-20241027214801643" tabindex="0" loading="lazy"><figcaption>image-20241027214801643</figcaption></figure><h3 id="_7-配置" tabindex="-1"><a class="header-anchor" href="#_7-配置"><span>7.配置</span></a></h3><h4 id="配置集" tabindex="-1"><a class="header-anchor" href="#配置集"><span>配置集</span></a></h4><p>🌟所有配置的集合</p><p>🚀关于数据库连接的配置集</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  datasource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">jdbc:mysql://192.168.68.86:3306/gulimall_sms?useSSL=false&amp;serverTimezone=UTC</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">felix</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">123456a!</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    driver-class-name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">com.mysql.cj.jdbc.Driver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="配置集id" tabindex="-1"><a class="header-anchor" href="#配置集id"><span>配置集ID</span></a></h4><p>🌟类似于文件名</p><p>📁 Data ID：类似于文件名</p><figure><img src="'+l+'" alt="image-20241027221436904" tabindex="0" loading="lazy"><figcaption>image-20241027221436904</figcaption></figure><h4 id="配置分组" tabindex="-1"><a class="header-anchor" href="#配置分组"><span>配置分组</span></a></h4><p>默认所有的配置集都属于：Default_Group</p><blockquote><p>项目中的使用：每个微服务创建自己的命名空间，使用配置分组来区分环境 dev test prod</p></blockquote><figure><img src="'+t+'" alt="image-20241027221952283" tabindex="0" loading="lazy"><figcaption>image-20241027221952283</figcaption></figure><h3 id="_8-同时加载多个配置集" tabindex="-1"><a class="header-anchor" href="#_8-同时加载多个配置集"><span>8.同时加载多个配置集</span></a></h3><blockquote><ol><li>微服务中任何配置信息，任何配置文件都可以放在配置中心中</li><li>使用时需要在bootstrap.properties中说明加载哪些配置文件即可</li><li>@value，@ConfigurationProperties 以前springboot任何从配置文件获取值的方法都能使用</li><li>配置中心有的优先使用配置中心的，没有则从本地yml中获取</li></ol></blockquote><div class="language-bootstrap.properties line-numbers-mode" data-highlighter="shiki" data-ext="bootstrap.properties" data-title="bootstrap.properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 指定加载配置集</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[0].data-id=datasource.yml</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[0].group=dev</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[0].refresh=true</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[1].data-id=mybatis.yml</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[1].group=dev</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[1].refresh=true</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[2].data-id=other.yml</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[2].group=dev</span></span>\n<span class="line"><span>spring.cloud.nacos.config.ext-config[2].refresh=true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>🚓注意名称与Nacos中心配置集名称对应</p><figure><img src="'+p+'" alt="image-20241027222735401" tabindex="0" loading="lazy"><figcaption>image-20241027222735401</figcaption></figure>',32)]))}]]),k=JSON.parse('{"path":"/Spring%20Cloud/Nacos/1.%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83.html","title":"","lang":"zh-CN","frontmatter":{"gitInclude":[]},"headers":[{"level":2,"title":"如何使用Nacos作为配置中心统一管理配置","slug":"如何使用nacos作为配置中心统一管理配置","link":"#如何使用nacos作为配置中心统一管理配置","children":[{"level":3,"title":"1.引入依赖","slug":"_1-引入依赖","link":"#_1-引入依赖","children":[]},{"level":3,"title":"2.创建一个bootstrap.properties","slug":"_2-创建一个bootstrap-properties","link":"#_2-创建一个bootstrap-properties","children":[]},{"level":3,"title":"3.创建配置","slug":"_3-创建配置","link":"#_3-创建配置","children":[]},{"level":3,"title":"4.给coupon.properties添加配置","slug":"_4-给coupon-properties添加配置","link":"#_4-给coupon-properties添加配置","children":[]},{"level":3,"title":"5.动态获取配置","slug":"_5-动态获取配置","link":"#_5-动态获取配置","children":[]},{"level":3,"title":"6.命名空间","slug":"_6-命名空间","link":"#_6-命名空间","children":[]},{"level":3,"title":"7.配置","slug":"_7-配置","link":"#_7-配置","children":[]},{"level":3,"title":"8.同时加载多个配置集","slug":"_8-同时加载多个配置集","link":"#_8-同时加载多个配置集","children":[]}]}],"readingTime":{"minutes":2.14,"words":642},"filePathRelative":"Spring Cloud/Nacos/1.配置中心.md","excerpt":"<h2>如何使用Nacos作为配置中心统一管理配置</h2>\\n<h3>1.引入依赖</h3>\\n<div class=\\"language-java line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"java\\" data-title=\\"java\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">\\t\\t&lt;!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">--</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">作为配置中心</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">--</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">\\t\\t&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">dependency</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">\\t\\t\\t&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">groupId</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E5C07B\\">com</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E5C07B\\">alibaba</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E5C07B\\">cloud</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">groupId</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">\\t\\t\\t&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">artifactId</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">spring</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">cloud</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">starter</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">alibaba</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">nacos</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">config</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">artifactId</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">\\t\\t&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\">dependency</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}')}}]);