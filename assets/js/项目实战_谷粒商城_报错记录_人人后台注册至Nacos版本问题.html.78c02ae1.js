"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7395],{6262:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,e]of i)a[s]=e;return a}},99:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>n,data:()=>l});var e=a(641);const t={},n=(0,a(6262).A)(t,[["render",function(s,i){return(0,e.uX)(),(0,e.CE)("div",null,[i[0]||(i[0]=(0,e.Lk)("h1",{id:"人人fast后台注册nacos失败问题",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#人人fast后台注册nacos失败问题"},[(0,e.Lk)("span",null,"人人fast后台注册nacos失败问题")])],-1)),i[1]||(i[1]=(0,e.Lk)("h2",{id:"问题描述",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#问题描述"},[(0,e.Lk)("span",null,"问题描述")])],-1)),i[2]||(i[2]=(0,e.Lk)("blockquote",null,[(0,e.Lk)("p",null,"spring boot与spring cloud版本不匹配导致nacos注册失败")],-1)),(0,e.Q3)(" more "),i[3]||(i[3]=(0,e.Fv)('<h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h2><blockquote><p><code>renren-fast</code>当前使用的<code>spring boot</code>版本为<code>2.6.6</code>，对应spring cloud版本应高于2021.0.x</p><p>其余模块中使用的<code>spring boot</code>版本为<code>2.1.8 RELEASE</code>，<code>spring cloud </code>版本为<code>Greenwich.SR3</code></p></blockquote><p>🌱降低renren-fast的spring boot版本至<code>2.1.8 RELEASE</code></p><div class="language-pom.xml line-numbers-mode" data-highlighter="shiki" data-ext="pom.xml" data-title="pom.xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>    &lt;parent&gt;</span></span>\n<span class="line"><span>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span></span>\n<span class="line"><span>        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span></span>\n<span class="line"><span>        &lt;version&gt;2.1.8.RELEASE&lt;/version&gt;</span></span>\n<span class="line"><span>        &lt;relativePath/&gt; &lt;!-- 直接从库里找而不是依赖项目中的 --&gt;</span></span>\n<span class="line"><span>    &lt;/parent&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>⚠️注意修改跨域配置文件中的allowedOriginPatterns为allowedOrigins</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Configuration</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> CorsConfig</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> WebMvcConfigurer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Override</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> addCorsMappings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CorsRegistry</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> registry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        registry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">addMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/**&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowedOrigins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowCredentials</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowedMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;GET&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;POST&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;PUT&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DELETE&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;OPTIONS&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">maxAge</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3600</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="版本问题" tabindex="-1"><a class="header-anchor" href="#版本问题"><span>版本问题</span></a></h2><p><a href="https://spring.io/projects/spring-cloud" target="_blank" rel="noopener noreferrer">spring boot 与 spring cloud版本对应</a></p><table><thead><tr><th style="text-align:left;">Release Train</th><th style="text-align:left;">Spring Boot Generation</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-2023.0-Release-Notes" target="_blank" rel="noopener noreferrer">2023.0.x</a> aka Leyton</td><td style="text-align:left;">3.3.x, 3.2.x</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-2022.0-Release-Notes" target="_blank" rel="noopener noreferrer">2022.0.x</a> aka Kilburn</td><td style="text-align:left;">3.0.x, 3.1.x (Starting with 2022.0.3)</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-2021.0-Release-Notes" target="_blank" rel="noopener noreferrer">2021.0.x</a> aka Jubilee</td><td style="text-align:left;">2.6.x, 2.7.x (Starting with 2021.0.3)</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-2020.0-Release-Notes" target="_blank" rel="noopener noreferrer">2020.0.x</a> aka Ilford</td><td style="text-align:left;">2.4.x, 2.5.x (Starting with 2020.0.3)</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-Hoxton-Release-Notes" target="_blank" rel="noopener noreferrer">Hoxton</a></td><td style="text-align:left;">2.2.x, 2.3.x (Starting with SR5)</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Greenwich-Release-Notes" target="_blank" rel="noopener noreferrer">Greenwich</a></td><td style="text-align:left;">2.1.x</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Finchley-Release-Notes" target="_blank" rel="noopener noreferrer">Finchley</a></td><td style="text-align:left;">2.0.x</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Edgware-Release-Notes" target="_blank" rel="noopener noreferrer">Edgware</a></td><td style="text-align:left;">1.5.x</td></tr><tr><td style="text-align:left;"><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Dalston-Release-Notes" target="_blank" rel="noopener noreferrer">Dalston</a></td><td style="text-align:left;">1.5.x</td></tr></tbody></table><p><a href="">CorsConfig.java</a></p><p>🍺<code>allowedOriginPatterns</code> 方法是在 <strong>Spring Framework 5.3</strong> 中引入的，具体来说是在 <strong>Spring Boot 2.4</strong> 开始支持的。该方法允许使用模式匹配配置 CORS 的允许来源，与 <code>allowedOrigins</code> 不同，它支持通配符来匹配子域或更灵活的 URL 结构。</p><p>例如，在 Spring Boot 2.4+ 项目中，可以在 CORS 配置中使用 <code>allowedOriginPatterns</code> 来允许特定的模式：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Override</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> addCorsMappings</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CorsRegistry</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> registry) {</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    registry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">addMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/**&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowedOriginPatterns</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://*.example.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // 支持子域名</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowedMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;GET&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;POST&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allowedHeaders</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>确保项目使用的是 Spring Framework 5.3 或更高版本，以便正常使用 <code>allowedOriginPatterns</code>。</p>',14))])}]]),l=JSON.parse('{"path":"/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E/%E6%8A%A5%E9%94%99%E8%AE%B0%E5%BD%95/%E4%BA%BA%E4%BA%BA%E5%90%8E%E5%8F%B0%E6%B3%A8%E5%86%8C%E8%87%B3Nacos%E7%89%88%E6%9C%AC%E9%97%AE%E9%A2%98.html","title":"人人fast后台注册nacos失败问题","lang":"zh-CN","frontmatter":{"icon":"fa-solid fa-bug","date":"2024-10-29T00:00:00.000Z","category":["实战"],"tag":["bug"],"gitInclude":[]},"headers":[{"level":2,"title":"问题描述","slug":"问题描述","link":"#问题描述","children":[]},{"level":2,"title":"解决方案","slug":"解决方案","link":"#解决方案","children":[]},{"level":2,"title":"版本问题","slug":"版本问题","link":"#版本问题","children":[]}],"readingTime":{"minutes":1.57,"words":470},"filePathRelative":"项目实战/谷粒商城/报错记录/人人后台注册至Nacos版本问题.md","localizedDate":"2024年10月29日","excerpt":"\\n<h2>问题描述</h2>\\n<blockquote>\\n<p>spring boot与spring cloud版本不匹配导致nacos注册失败</p>\\n</blockquote>\\n"}')}}]);