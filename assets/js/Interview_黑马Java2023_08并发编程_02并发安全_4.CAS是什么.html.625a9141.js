"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9837],{66262:(i,l)=>{l.A=(i,l)=>{const t=i.__vccOpts||i;for(const[i,a]of l)t[i]=a;return t}},90984:(i,l,t)=>{t.r(l),t.d(l,{comp:()=>r,data:()=>R});var a=t(20641);const e=t.p+"assets/img/174101770082437.414d7426.png",n=t.p+"assets/img/174101770398640.4729a924.png",o=t.p+"assets/img/174101770638543.1fea16f1.png",g=t.p+"assets/img/174101771147149.5d7af4cc.png",s=t.p+"assets/img/174101771366752.f29232f7.png",u={},r=(0,t(66262).A)(u,[["render",function(i,l){return(0,a.uX)(),(0,a.CE)("div",null,l[0]||(l[0]=[(0,a.Fv)('<h1 id="_4-cas-你知道吗" tabindex="-1"><a class="header-anchor" href="#_4-cas-你知道吗"><span>4.CAS 你知道吗？</span></a></h1><blockquote><p>难易程度：☆☆☆</p><p>出现频率：☆☆☆</p></blockquote><div class="hint-container important"><p class="hint-container-title">重要</p><p><strong>参考回答</strong></p><p>CAS的全称是： Compare And Swap(比较再交换);它体现的一种乐观锁的思想，在无锁状态下保证线程操作数据的原子性。</p><ul><li>CAS使用到的地方很多：AQS框架、AtomicXXX类</li><li>在操作共享变量的时候使用的自旋锁，效率上更高一些</li><li>CAS的底层是调用的Unsafe类中的方法，都是操作系统提供的，其他语言实现</li></ul></div><hr><h2 id="_1-概述及基本工作流程" tabindex="-1"><a class="header-anchor" href="#_1-概述及基本工作流程"><span>1.概述及基本工作流程</span></a></h2><p>CAS的全称是： Compare And Swap(比较再交换)，它体现的一种乐观锁的思想，在无锁情况下保证线程操作共享数据的原子性。</p><p>在JUC（ java.util.concurrent ）包下实现的很多类都用到了CAS操作</p><ul><li>AbstractQueuedSynchronizer（AQS框架）</li><li>AtomicXXX类</li></ul><p>例子：</p><p>我们还是基于刚才学习过的JMM内存模型进行说明</p><ul><li>线程1与线程2都从主内存中获取变量int a = 100,同时放到各个线程的工作内存中</li></ul><figure><img src="'+e+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><blockquote><p>一个当前内存值V、旧的预期值A、即将更新的值B，当且仅当旧的预期值A和内存值V相同时，将内存值修改为B并返回true，否则什么都不做，并返回false。如果CAS操作失败，通过自旋的方式等待并再次尝试，直到成功</p></blockquote><ul><li>线程1操作：V：int a = 100，A：int a = 100，B：修改后的值：int a = 101 (a++) <ul><li>线程1拿A的值与主内存V的值进行比较，判断是否相等</li><li>如果相等，则把B的值101更新到主内存中</li></ul></li></ul><figure><img src="'+n+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>线程2操作：V：int a = 100，A：int a = 100，B：修改后的值：int a = 99(a--) <ul><li>线程2拿A的值与主内存V的值进行比较，判断是否相等(目前不相等，因为线程1已更新V的值99)</li><li>不相等，则线程2更新失败</li></ul></li></ul><figure><img src="'+o+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>自旋锁操作 <ul><li>因为没有加锁，所以线程不会陷入阻塞，效率较高</li><li>如果竞争激烈，重试频繁发生，效率会受影响</li></ul></li></ul><figure><img src="data:image/png;base64,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" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>需要不断尝试获取共享内存V中最新的值，然后再在新的值的基础上进行更新操作，如果失败就继续尝试获取新的值，直到更新成功</p><h2 id="_2-cas-底层实现" tabindex="-1"><a class="header-anchor" href="#_2-cas-底层实现"><span>2.CAS 底层实现</span></a></h2><p>CAS 底层依赖于一个 Unsafe 类来直接调用操作系统底层的 CAS 指令</p><figure><img src="'+g+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>都是native修饰的方法，由系统提供的接口执行，并非java代码实现，一般的思路也都是自旋锁实现</p><p>在java中比较常见使用有很多，比如ReentrantLock和Atomic开头的线程安全类，都调用了Unsafe中的方法</p><ul><li>ReentrantLock中的一段CAS代码</li></ul><figure><img src="'+s+'" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_3-乐观锁和悲观锁" tabindex="-1"><a class="header-anchor" href="#_3-乐观锁和悲观锁"><span>3.乐观锁和悲观锁</span></a></h2><ul><li>CAS 是基于乐观锁的思想：最乐观的估计，不怕别的线程来修改共享变量，就算改了也没关系，我吃亏点再重试呗。</li><li>synchronized 是基于悲观锁的思想：最悲观的估计，得防着其它线程来修改共享变量，我上了锁你们都别想改，我改完了解开锁，你们才有机会。</li></ul>',29)]))}]]),R=JSON.parse('{"path":"/Interview/%E9%BB%91%E9%A9%ACJava2023/08%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/02%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/4.CAS%E6%98%AF%E4%BB%80%E4%B9%88.html","title":"4.CAS 你知道吗？","lang":"zh-CN","frontmatter":{"gitInclude":[]},"headers":[{"level":2,"title":"1.概述及基本工作流程","slug":"_1-概述及基本工作流程","link":"#_1-概述及基本工作流程","children":[]},{"level":2,"title":"2.CAS 底层实现","slug":"_2-cas-底层实现","link":"#_2-cas-底层实现","children":[]},{"level":2,"title":"3.乐观锁和悲观锁","slug":"_3-乐观锁和悲观锁","link":"#_3-乐观锁和悲观锁","children":[]}],"readingTime":{"minutes":2.74,"words":821},"filePathRelative":"Interview/黑马Java2023/08并发编程/02并发安全/4.CAS是什么.md","excerpt":"\\n<blockquote>\\n<p>难易程度：☆☆☆</p>\\n<p>出现频率：☆☆☆</p>\\n</blockquote>\\n<div class=\\"hint-container important\\">\\n<p class=\\"hint-container-title\\">重要</p>\\n<p><strong>参考回答</strong></p>\\n<p>CAS的全称是： Compare And Swap(比较再交换);它体现的一种乐观锁的思想，在无锁状态下保证线程操作数据的原子性。</p>\\n<ul>\\n<li>CAS使用到的地方很多：AQS框架、AtomicXXX类</li>\\n<li>在操作共享变量的时候使用的自旋锁，效率上更高一些</li>\\n<li>CAS的底层是调用的Unsafe类中的方法，都是操作系统提供的，其他语言实现</li>\\n</ul>\\n</div>"}')}}]);